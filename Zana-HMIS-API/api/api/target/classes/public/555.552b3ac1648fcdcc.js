"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[555],{555:(B,v,s)=>{s.r(v),s.d(v,{ConsultationPriceComponent:()=>D});var g=s(5861),d=s(6814),h=s(9862),_=s(95),P=s(4716),I=s(4185),E=s(553),n=s(6689),Z=s(6466),f=s(7140),M=s(585),T=s(379);function A(a,r){if(1&a){const o=n.EpF();n.TgZ(0,"span"),n._uU(1,"COVERED "),n.TgZ(2,"button",19),n.NdJ("click",function(){n.CHM(o);const t=n.oxw(2).$implicit,i=n.oxw();return n.KtG(i.changeConsultationCoverage(i.insurancePlanId,null==t||null==t.consultationInsurancePlan||null==t.consultationInsurancePlan.clinic?null:t.consultationInsurancePlan.clinic.id,!1))}),n._uU(3,"Change"),n.qZA()()}}function x(a,r){if(1&a){const o=n.EpF();n.TgZ(0,"span"),n._uU(1,"NOT COVERED "),n.TgZ(2,"button",19),n.NdJ("click",function(){n.CHM(o);const t=n.oxw(2).$implicit,i=n.oxw();return n.KtG(i.changeConsultationCoverage(i.insurancePlanId,null==t||null==t.consultationInsurancePlan||null==t.consultationInsurancePlan.clinic?null:t.consultationInsurancePlan.clinic.id,!0))}),n._uU(3,"Change"),n.qZA()()}}function O(a,r){if(1&a&&(n.TgZ(0,"div"),n.YNc(1,A,4,0,"span",18),n.YNc(2,x,4,0,"span",18),n.qZA()),2&a){const o=n.oxw().$implicit;n.xp6(1),n.Q6J("ngIf",!0===(null==o||null==o.consultationInsurancePlan?null:o.consultationInsurancePlan.covered)),n.xp6(1),n.Q6J("ngIf",!1===(null==o||null==o.consultationInsurancePlan?null:o.consultationInsurancePlan.covered))}}function U(a,r){if(1&a){const o=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td"),n._uU(4),n.qZA(),n.TgZ(5,"td",14),n._uU(6),n.ALo(7,"currency"),n.qZA(),n.TgZ(8,"td")(9,"input",15),n.NdJ("ngModelChange",function(t){const e=n.CHM(o).$implicit;return n.KtG(e.price=t)}),n.qZA()(),n.TgZ(10,"td")(11,"button",16),n.NdJ("click",function(){const i=n.CHM(o).$implicit,e=n.oxw();return n.KtG(e.updateConsultationPriceByInsurance(e.insurancePlanId,null==i||null==i.clinic?null:i.clinic.id,i.price))}),n._UZ(12,"i",17),n._uU(13,"Save"),n.qZA()(),n.TgZ(14,"td"),n.YNc(15,O,3,2,"div",18),n.qZA()()}if(2&a){const o=r.$implicit;n.xp6(2),n.Oqu(o.clinic.id),n.xp6(2),n.Oqu(o.clinic.name),n.xp6(2),n.Oqu(n.Dn7(7,5,o.price,"","")),n.xp6(3),n.Q6J("ngModel",o.price),n.xp6(6),n.Q6J("ngIf",null!=(null==o||null==o.consultationInsurancePlan?null:o.consultationInsurancePlan.covered))}}const C=E.N.apiUrl;let D=(()=>{var a;class r{constructor(l,t,i,e,p){this.auth=l,this.http=t,this.modalService=i,this.spinner=e,this.msgBox=p,this.insurancePlanId=null,this.insurancePlanName="",this.clinics=[],this.consultationPrices=[],this.filterRecords=""}ngOnInit(){this.insurancePlanId=localStorage.getItem("insurance_plan_id"),this.insurancePlanName=localStorage.getItem("insurance_plan_name"),localStorage.removeItem("insurance_plan_id"),localStorage.removeItem("insurance_plan_name"),this.loadConsultationsByInsurance(this.insurancePlanId)}loadConsultationsByInsurance(l){var t=this;return(0,g.Z)(function*(){t.clinics=[];let i={headers:(new h.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(C+"/insurance_plans/get_consultation_prices?insurance_plan_id="+l,i).pipe((0,P.x)(()=>t.spinner.hide())).toPromise().then(e=>{t.consultationPrices=e}).catch(e=>{t.msgBox.showErrorMessage(e,"Could not load consultation")})})()}changeConsultationCoverage(l,t,i){var e=this;return(0,g.Z)(function*(){let p={headers:(new h.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var m={clinic:{id:t},consultationInsurancePlan:{insurancePlan:{id:l},covered:i}};e.spinner.show(),yield e.http.post(C+"/insurance_plans/change_consultation_coverage",m,p).pipe((0,P.x)(()=>e.spinner.hide())).toPromise().then(c=>{e.consultationPrices.forEach(u=>{c.clinic.id===u.clinic.id&&(u.consultationInsurancePlan.covered=c.consultationInsurancePlan.covered)})}).catch(c=>{e.msgBox.showErrorMessage(c,"Could not change coverage")})})()}updateConsultationPriceByInsurance(l,t,i){var e=this;return(0,g.Z)(function*(){let p={headers:(new h.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var m={clinic:{id:t},consultationInsurancePlan:{insurancePlan:{id:l}},price:i};e.spinner.show(),yield e.http.post(C+"/insurance_plans/update_consultation_price_by_insurance",m,p).pipe((0,P.x)(()=>e.spinner.hide())).toPromise().then(c=>{e.consultationPrices.forEach(u=>{c.clinic.id===u.clinic.id&&(u.price=c.price,u.covered=c.covered)}),e.msgBox.showSuccessMessage("Price updated successifully")}).catch(c=>{e.msgBox.showErrorMessage(c,"Could not update price")})})()}}return(a=r).\u0275fac=function(l){return new(l||a)(n.Y36(Z.e),n.Y36(h.eN),n.Y36(f.FF),n.Y36(M.t2),n.Y36(T.l))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-consultation-price"]],standalone:!0,features:[n.jDz],decls:37,vars:6,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"text-primary"],[1,"panel-body"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-bordered","table-small"],[4,"ngFor","ngForOf"],[2,"text-align","right"],["type","text",1,"form-control",2,"text-align","center",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],[1,"glyphicon","glyphicon-floppy-disk"],[4,"ngIf"],[3,"click"]],template:function(l,t){1&l&&(n.TgZ(0,"section",0)(1,"div",1)(2,"h1"),n._uU(3,"Consultation Prices"),n.qZA()()(),n.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h4",7),n._uU(10),n.qZA()(),n.TgZ(11,"div",8)(12,"div",9)(13,"div",3),n._UZ(14,"div",10)(15,"div",10),n.TgZ(16,"div",10)(17,"input",11),n.NdJ("ngModelChange",function(e){return t.filterRecords=e}),n.qZA()()(),n._UZ(18,"br"),n.TgZ(19,"table",12)(20,"thead")(21,"tr")(22,"th"),n._uU(23,"ID"),n.qZA(),n.TgZ(24,"th"),n._uU(25,"Clinic"),n.qZA(),n.TgZ(26,"th"),n._uU(27,"Price"),n.qZA(),n.TgZ(28,"th"),n._uU(29,"Edit Price"),n.qZA(),n.TgZ(30,"th"),n._uU(31,"Action"),n.qZA(),n.TgZ(32,"th"),n._uU(33,"Coverage"),n.qZA()()(),n.TgZ(34,"tbody"),n.YNc(35,U,16,9,"tr",13),n.ALo(36,"searchFilter"),n.qZA()()()()()()()()),2&l&&(n.xp6(10),n.hij("Package: ",t.insurancePlanName,""),n.xp6(7),n.Q6J("ngModel",t.filterRecords),n.xp6(18),n.Q6J("ngForOf",n.xi3(36,3,t.consultationPrices,t.filterRecords)))},dependencies:[d.ez,d.sg,d.O5,d.H9,_.u5,_.Fj,_.JJ,_.On,_.UX,I.G]}),r})()}}]);