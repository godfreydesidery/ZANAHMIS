"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[1131],{1131:(R,p,m)=>{m.r(p),m.d(p,{ItemRegisterComponent:()=>T});var h=m(5861),v=m(6814),a=m(9862),s=m(95),u=m(4716),M=m(553),e=m(6689),Z=m(6466),C=m(585),f=m(379);function I(d,_){if(1&d&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&d){const l=_.$implicit;e.Q6J("ngValue",l),e.xp6(1),e.Oqu(l)}}const g=M.N.apiUrl;let T=(()=>{var d;class _{constructor(n,o,i,t){this.auth=n,this.http=o,this.spinner=i,this.msgBox=t,this.code="",this.barcode="",this.name="",this.shortName="",this.commonName="",this.vat=0,this.uom="",this.packSize=0,this.stock=0,this.minimumInventory=0,this.maximumInventory=0,this.defaultReorderQty=0,this.defaultReorderLevel=0,this.active=!1,this.ingredients="",this.names=[],this.filterRecords=""}ngOnInit(){this.loadItemNames()}saveItem(){var n=this;return(0,h.Z)(function*(){let o={headers:(new a.WM).set("Authorization","Bearer "+n.auth.user.access_token)};var i={id:n.id,code:n.code,barcode:n.barcode,name:n.name,shortName:n.shortName,commonName:n.commonName,vat:n.vat,uom:n.uom,packSize:n.packSize,stock:n.stock,minimumInventory:n.minimumInventory,maximumInventory:n.maximumInventory,defaultReorderQty:n.defaultReorderQty,defaultReorderLevel:n.defaultReorderLevel,active:n.active,ingredients:n.ingredients};null==n.id||""==n.id?(n.spinner.show(),yield n.http.post(g+"/items/save",i,o).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(t=>{n.id=t?.id,n.code=t.code,n.barcode=t.barcode,n.name=t.name,n.shortName=t.shortName,n.commonName=t.commonName,n.vat=t.vat,n.uom=t.uom,n.packSize=t.packSize,n.stock=t.stock,n.minimumInventory=t.minimumInventory,n.maximumInventory=t.maximumInventory,n.defaultReorderQty=t.defaultReorderQty,n.defaultReorderLevel=t.defaultReorderLevel,n.active=t.active,n.ingredients=t.ingredients,n.msgBox.showSuccessMessage("Item created successifully")}).catch(t=>{console.log(t),n.msgBox.showErrorMessage(t,"Could not create item!")})):(n.spinner.show(),yield n.http.post(g+"/items/save",i,o).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(t=>{n.id=t?.id,n.code=t.code,n.barcode=t.barcode,n.name=t.name,n.shortName=t.shortName,n.commonName=t.commonName,n.vat=t.vat,n.uom=t.uom,n.packSize=t.packSize,n.stock=t.stock,n.minimumInventory=t.minimumInventory,n.maximumInventory=t.maximumInventory,n.defaultReorderQty=t.defaultReorderQty,n.defaultReorderLevel=t.defaultReorderLevel,n.active=t.active,n.ingredients=t.ingredients,n.msgBox.showSuccessMessage("Item updated successifully")}).catch(t=>{n.msgBox.showErrorMessage(t,"Could not update item")}))})()}clear(){this.id=null,this.code="",this.barcode="",this.name="",this.shortName="",this.commonName="",this.vat=0,this.uom="",this.packSize=0,this.stock=0,this.minimumInventory=0,this.maximumInventory=0,this.defaultReorderQty=0,this.defaultReorderLevel=0,this.active=!1,this.ingredients=""}loadItemNames(){var n=this;return(0,h.Z)(function*(){let o={headers:(new a.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(g+"/items/get_names",o).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(i=>{console.log(i),n.names=[],i?.forEach(t=>{n.names.push(t)})},i=>{console.log(i),n.msgBox.showErrorMessage(i,"Could not load item names")})})()}searchItem(){var n=this;return(0,h.Z)(function*(){let o={headers:(new a.WM).set("Authorization","Bearer "+n.auth.user.access_token)};var i=n.code,t=n.barcode,c=n.name;""!=i&&(t="",c=""),""!=t&&(c=""),n.spinner.show(),yield n.http.get(g+"/items/search?code="+i+"&barcode="+t+"&name="+c,o).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(r=>{n.id=r?.id,n.code=r.code,n.barcode=r.barcode,n.name=r.name,n.shortName=r.shortName,n.commonName=r.commonName,n.vat=r.vat,n.uom=r.uom,n.packSize=r.packSize,n.stock=r.stock,n.minimumInventory=r.minimumInventory,n.maximumInventory=r.maximumInventory,n.defaultReorderQty=r.defaultReorderQty,n.defaultReorderLevel=r.defaultReorderLevel,n.active=r.active,n.ingredients=r.ingredients},r=>{console.log(r),n.msgBox.showErrorMessage(r,"Could not find item")})})()}grant(n){var o=!1;return n.forEach(i=>{this.auth.checkPrivilege(i)&&(o=!0)}),o}}return(d=_).\u0275fac=function(n){return new(n||d)(e.Y36(Z.e),e.Y36(a.eN),e.Y36(C.t2),e.Y36(f.l))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-item-register"]],standalone:!0,features:[e.jDz],decls:115,vars:16,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"btn"],["type","button",1,"btn","btn-success","m-r-2","m-b-5",3,"click"],[1,"panel-body"],[1,"col-sm-6"],["type","hidden",3,"ngModel","ngModelChange"],[1,"col-sm-4"],[1,"col-sm-8"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],["type","text","list","names",1,"form-control",3,"ngModel","ngModelChange"],["id","names",2,"padding","0px"],[3,"ngValue",4,"ngFor","ngForOf"],["type","checkbox",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-success","m-r-2","m-b-5","pull-right",3,"click"],[3,"ngValue"]],template:function(n,o){1&n&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Item Register"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"button",8),e.NdJ("click",function(){return o.clear()}),e._uU(11,"New"),e.qZA(),e.TgZ(12,"button",8),e.NdJ("click",function(){return o.clear()}),e._uU(13,"Clear"),e.qZA()()(),e.TgZ(14,"div",9)(15,"div",3)(16,"div",10)(17,"div",3)(18,"input",11),e.NdJ("ngModelChange",function(t){return o.id=t}),e.qZA(),e.TgZ(19,"div",12)(20,"h4"),e._uU(21,"Code"),e.qZA()(),e.TgZ(22,"div",13)(23,"div",3)(24,"div",13)(25,"input",14),e.NdJ("ngModelChange",function(t){return o.code=t}),e.qZA()(),e.TgZ(26,"div",12)(27,"button",15),e.NdJ("click",function(){return o.searchItem()}),e._uU(28,"Search"),e.qZA()()()()(),e.TgZ(29,"div",3)(30,"div",12)(31,"h4"),e._uU(32,"Barcode"),e.qZA()(),e.TgZ(33,"div",13)(34,"input",14),e.NdJ("ngModelChange",function(t){return o.barcode=t}),e.qZA()()(),e.TgZ(35,"div",3)(36,"div",12)(37,"h4"),e._uU(38,"Name"),e.qZA()(),e.TgZ(39,"div",13)(40,"input",16),e.NdJ("ngModelChange",function(t){return o.name=t}),e.qZA()(),e.TgZ(41,"datalist",17),e.YNc(42,I,2,2,"option",18),e.qZA()(),e.TgZ(43,"div",3)(44,"div",12)(45,"h4"),e._uU(46,"Short Name"),e.qZA()(),e.TgZ(47,"div",13)(48,"input",14),e.NdJ("ngModelChange",function(t){return o.shortName=t}),e.qZA()()(),e.TgZ(49,"div",3)(50,"div",12)(51,"h4"),e._uU(52,"Common Name"),e.qZA()(),e.TgZ(53,"div",13)(54,"input",14),e.NdJ("ngModelChange",function(t){return o.commonName=t}),e.qZA()()(),e.TgZ(55,"div",3)(56,"div",12)(57,"h4"),e._uU(58,"Vat"),e.qZA()(),e.TgZ(59,"div",13)(60,"input",14),e.NdJ("ngModelChange",function(t){return o.vat=t}),e.qZA()()(),e.TgZ(61,"div",3)(62,"div",12)(63,"h4"),e._uU(64,"UOM"),e.qZA()(),e.TgZ(65,"div",13)(66,"input",14),e.NdJ("ngModelChange",function(t){return o.uom=t}),e.qZA()()()(),e.TgZ(67,"div",10)(68,"div",3)(69,"div",12)(70,"h4"),e._uU(71,"Stock"),e.qZA()(),e.TgZ(72,"div",13)(73,"input",14),e.NdJ("ngModelChange",function(t){return o.stock=t}),e.qZA()()(),e.TgZ(74,"div",3)(75,"div",12)(76,"h4"),e._uU(77,"Pack Size"),e.qZA()(),e.TgZ(78,"div",13)(79,"input",14),e.NdJ("ngModelChange",function(t){return o.packSize=t}),e.qZA()()(),e.TgZ(80,"div",3)(81,"div",12)(82,"h4"),e._uU(83,"Minimum Inventory"),e.qZA()(),e.TgZ(84,"div",13)(85,"input",14),e.NdJ("ngModelChange",function(t){return o.minimumInventory=t}),e.qZA()()(),e.TgZ(86,"div",3)(87,"div",12)(88,"h4"),e._uU(89,"Maximum Inventory"),e.qZA()(),e.TgZ(90,"div",13)(91,"input",14),e.NdJ("ngModelChange",function(t){return o.maximumInventory=t}),e.qZA()()(),e.TgZ(92,"div",3)(93,"div",12)(94,"h4"),e._uU(95,"Default Reorder Qty"),e.qZA()(),e.TgZ(96,"div",13)(97,"input",14),e.NdJ("ngModelChange",function(t){return o.defaultReorderQty=t}),e.qZA()()(),e.TgZ(98,"div",3)(99,"div",12)(100,"h4"),e._uU(101,"Default Reorder Level"),e.qZA()(),e.TgZ(102,"div",13)(103,"input",14),e.NdJ("ngModelChange",function(t){return o.defaultReorderLevel=t}),e.qZA()()(),e.TgZ(104,"div",3)(105,"div",12),e._UZ(106,"h4"),e.qZA(),e.TgZ(107,"div",13)(108,"input",19),e.NdJ("ngModelChange",function(t){return o.active=t}),e.qZA(),e.TgZ(109,"label"),e._uU(110,"Active"),e.qZA()()()(),e.TgZ(111,"div",4),e._UZ(112,"hr"),e.TgZ(113,"button",20),e.NdJ("click",function(){return o.saveItem()}),e._uU(114,"Save"),e.qZA()()()()()()()()),2&n&&(e.xp6(18),e.Q6J("ngModel",o.id),e.xp6(7),e.Q6J("ngModel",o.code),e.xp6(9),e.Q6J("ngModel",o.barcode),e.xp6(6),e.Q6J("ngModel",o.name),e.xp6(2),e.Q6J("ngForOf",o.names),e.xp6(6),e.Q6J("ngModel",o.shortName),e.xp6(6),e.Q6J("ngModel",o.commonName),e.xp6(6),e.Q6J("ngModel",o.vat),e.xp6(6),e.Q6J("ngModel",o.uom),e.xp6(7),e.Q6J("ngModel",o.stock),e.xp6(6),e.Q6J("ngModel",o.packSize),e.xp6(6),e.Q6J("ngModel",o.minimumInventory),e.xp6(6),e.Q6J("ngModel",o.maximumInventory),e.xp6(6),e.Q6J("ngModel",o.defaultReorderQty),e.xp6(6),e.Q6J("ngModel",o.defaultReorderLevel),e.xp6(5),e.Q6J("ngModel",o.active))},dependencies:[v.ez,v.sg,s.u5,s.YN,s.Kr,s.Fj,s.Wl,s.JJ,s.On,s.UX]}),_})()}}]);