"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[7094],{7094:(K,c,r)=>{r.r(c),r.d(c,{ReferralListComponent:()=>U});var f=r(5861),g=r(6814),h=r(9862),u=r(95),p=r(7069),v=r(4716),M=r(4185),P=r(553),t=r(6689),x=r(6466),A=r(1581),D=r(585),Z=r(8237),O=r(379),R=r(2848);function T(l,m){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td")(12,"button",16),t.NdJ("click",function(){const i=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.getReferralSummary(i.id))}),t._uU(13,"Print Referral Summary"),t.qZA()()()}if(2&l){const e=m.$implicit;t.xp6(2),t.lnq("",null==e||null==e.patient?null:e.patient.firstName," ",null==e||null==e.patient?null:e.patient.middleName," ",null==e||null==e.patient?null:e.patient.lastName,""),t.xp6(2),t.Oqu(null==e||null==e.patient?null:e.patient.no),t.xp6(2),t.Oqu(null==e||null==e.patient?null:e.patient.address),t.xp6(2),t.Oqu(null==e||null==e.patient?null:e.patient.phoneNo),t.xp6(2),t.Oqu(null==e?null:e.status)}}var S=r(6236);const E=P.N.apiUrl;let U=(()=>{var l;class m{constructor(o,n,i,s,C,b,z){var _=this;this.auth=o,this.http=n,this.modalService=i,this.spinner=s,this.router=C,this.msgBox=b,this.data=z,this.referralPlans=[],this.filterRecords="",this.print=function(){var L=(0,f.Z)(function*(a){if(null===a)return void _.msgBox.showErrorMessage3("No data to publish");var d;if(null!=a.admission)d=a.admission.patient;else{if(null==a.consultation)return void _.msgBox.showErrorMessage3("Patient information missing");d=a.consultation.patient}_.documentHeader=yield _.data.getDocumentHeader();const N={header:"",footer:function(I,W){return I.toString()+" of "+W},content:[{columns:[_.documentHeader]},"  ",{text:"Referral Note",fontSize:14,bold:!0,alignment:"center"},_.data.getHorizontalLine(),{columns:[{width:200,layout:"noBorders",table:{widths:[200],body:[[{text:"Name: "+d?.firstName.toString()+" "+d?.middleName?.toString()+" "+d?.lastName?.toString(),fontSize:9}],[{text:"File No: "+d?.no.toString(),fontSize:9}],[{text:"Address: "+d?.address.toString(),fontSize:9}],[{text:"Phone No: "+d?.phoneNo.toString(),fontSize:9}]]}},{width:100,layout:"noBorders",table:{widths:[100],body:[[{text:"",fontSize:9}]]}},{width:200,layout:"noBorders",table:{widths:[200],body:[[{text:"",fontSize:9}]]}}]}," "," ",{text:"Refered to:",fontSize:12,bold:!0},{text:a?.externalMedicalProvider.name,fontSize:9,bold:!1}," ",{text:"Referring Diagnosis",fontSize:12,bold:!0},{text:a?.referringDiagnosis,fontSize:9,bold:!1}," ",{text:"Brief History & Patient Diagnosis:",fontSize:12,bold:!0},{text:a?.history,fontSize:9,bold:!1}," ",{text:"Investigation Done:",fontSize:12,bold:!0},{text:a?.investigation,fontSize:9,bold:!1}," ",{text:"Inpatient Management:",fontSize:12,bold:!0},{text:a?.management,fontSize:9,bold:!1}," ",{text:"ICU Admission:",fontSize:12,bold:!0},{text:a?.admission,fontSize:9,bold:!1}," ",{text:"Operation Done:",fontSize:12,bold:!0},{text:a?.operationNote,fontSize:9,bold:!1}," ",{text:"General Recommendation:",fontSize:12,bold:!0},{text:a?.generalRecommendation,fontSize:9,bold:!1}," "]};p.createPdf(N).print()});return function(a){return L.apply(this,arguments)}}(),window.pdfMake.vfs=S.pdfMake.vfs}ngOnInit(){var o=this;return(0,f.Z)(function*(){o.loadReferralList()})()}loadReferralList(){var o=this;return(0,f.Z)(function*(){let n={headers:(new h.WM).set("Authorization","Bearer "+o.auth.user.access_token)};o.spinner.show(),yield o.http.get(E+"/patients/load_referral_list",n).pipe((0,v.x)(()=>o.spinner.hide())).toPromise().then(i=>{o.referralPlans=i,console.log(i)}).catch(i=>{o.msgBox.showErrorMessage(i,""),console.log(i)})})()}getReferralSummary(o){var n=this;return(0,f.Z)(function*(){if(!window.confirm("Confirm get Referral summary. Confirm?"))return;let i={headers:(new h.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(E+"/patients/get_referral_summary?referral_plan_id="+o,i).pipe((0,v.x)(()=>n.spinner.hide())).toPromise().then(s=>{n.referralPlan=s,console.log(s),n.print(n.referralPlan)}).catch(s=>{n.msgBox.showErrorMessage(s,""),console.log(s)})})()}grant(o){var n=!1;return o.forEach(i=>{this.auth.checkPrivilege(i)&&(n=!0)}),n}}return(l=m).\u0275fac=function(o){return new(o||l)(t.Y36(x.e),t.Y36(h.eN),t.Y36(A.FF),t.Y36(D.t2),t.Y36(Z.F0),t.Y36(O.l),t.Y36(R.D))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-referral-list"]],standalone:!0,features:[t.jDz],decls:37,vars:5,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"btn-group"],[1,"panel-body"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table-responsive"],[1,"table","table-bordered","table-hover","text-small"],[1,"success"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"section",0)(1,"div",1)(2,"h1"),t._uU(3,"Referral List"),t.qZA()()(),t.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6),t._UZ(9,"div",7),t.qZA(),t.TgZ(10,"div",8)(11,"div",9)(12,"div",3),t._UZ(13,"div",10)(14,"div",10),t.TgZ(15,"div",10)(16,"input",11),t.NdJ("ngModelChange",function(s){return n.filterRecords=s}),t.qZA()()(),t._UZ(17,"br"),t.TgZ(18,"div",12)(19,"table",13)(20,"thead",14)(21,"tr")(22,"th"),t._uU(23,"Name"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Patient's File No"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Address"),t.qZA(),t.TgZ(28,"th"),t._uU(29,"Phone No"),t.qZA(),t.TgZ(30,"th"),t._uU(31,"Status"),t.qZA(),t.TgZ(32,"th"),t._uU(33,"Action"),t.qZA()()(),t.TgZ(34,"tbody"),t.YNc(35,T,14,7,"tr",15),t.ALo(36,"searchFilter"),t.qZA()()()()()()()()()),2&o&&(t.xp6(16),t.Q6J("ngModel",n.filterRecords),t.xp6(19),t.Q6J("ngForOf",t.xi3(36,2,n.referralPlans,n.filterRecords)))},dependencies:[g.ez,g.sg,u.u5,u.Fj,u.JJ,u.On,u.UX,M.G]}),m})()}}]);