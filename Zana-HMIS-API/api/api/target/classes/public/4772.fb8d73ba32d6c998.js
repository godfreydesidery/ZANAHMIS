"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[4772],{4772:(O,b,i)=>{i.r(b),i.d(b,{LabTestTypePriceComponent:()=>L});var g=i(5861),u=i(6814),d=i(9862),p=i(95),h=i(4716),m=i(4185),v=i(553),e=i(6689),C=i(6466),I=i(1581),E=i(585),Z=i(379);function f(r,c){if(1&r){const s=e.EpF();e.TgZ(0,"span"),e._uU(1,"COVERED "),e.TgZ(2,"button",19),e.NdJ("click",function(){e.CHM(s);const n=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.changeLabTestTypeCoverage(a.insurancePlanId,null==n||null==n.labTestTypeInsurancePlan||null==n.labTestTypeInsurancePlan.labTestType?null:n.labTestTypeInsurancePlan.labTestType.id,!1))}),e._uU(3,"Change"),e.qZA()()}}function M(r,c){if(1&r){const s=e.EpF();e.TgZ(0,"span"),e._uU(1,"NOT COVERED "),e.TgZ(2,"button",19),e.NdJ("click",function(){e.CHM(s);const n=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.changeLabTestTypeCoverage(a.insurancePlanId,null==n||null==n.labTestTypeInsurancePlan||null==n.labTestTypeInsurancePlan.labTestType?null:n.labTestTypeInsurancePlan.labTestType.id,!0))}),e._uU(3,"Change"),e.qZA()()}}function A(r,c){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,f,4,0,"span",18),e.YNc(2,M,4,0,"span",18),e.qZA()),2&r){const s=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!0===(null==s||null==s.labTestTypeInsurancePlan?null:s.labTestTypeInsurancePlan.covered)),e.xp6(1),e.Q6J("ngIf",!1===(null==s||null==s.labTestTypeInsurancePlan?null:s.labTestTypeInsurancePlan.covered))}}function x(r,c){if(1&r){const s=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",14),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"td")(9,"input",15),e.NdJ("ngModelChange",function(n){const t=e.CHM(s).$implicit;return e.KtG(t.price=n)}),e.qZA()(),e.TgZ(10,"td")(11,"button",16),e.NdJ("click",function(){const a=e.CHM(s).$implicit,t=e.oxw();return e.KtG(t.updateLabTestTypePriceByInsurance(t.insurancePlanId,null==a||null==a.labTestType?null:a.labTestType.id,a.price))}),e._UZ(12,"i",17),e._uU(13,"Save"),e.qZA()(),e.TgZ(14,"td"),e.YNc(15,A,3,2,"div",18),e.qZA()()}if(2&r){const s=c.$implicit;e.xp6(2),e.Oqu(s.labTestType.id),e.xp6(2),e.Oqu(s.labTestType.name),e.xp6(2),e.Oqu(e.Dn7(7,5,s.price,"","")),e.xp6(3),e.Q6J("ngModel",s.price),e.xp6(6),e.Q6J("ngIf",null!=(null==s||null==s.labTestTypeInsurancePlan?null:s.labTestTypeInsurancePlan.covered))}}const y=v.N.apiUrl;let L=(()=>{var r;class c{constructor(l,n,a,t,T){this.auth=l,this.http=n,this.modalService=a,this.spinner=t,this.msgBox=T,this.insurancePlanId=null,this.insurancePlanName="",this.labTestTypes=[],this.labTestTypePrices=[],this.filterRecords=""}ngOnInit(){this.insurancePlanId=localStorage.getItem("insurance_plan_id"),this.insurancePlanName=localStorage.getItem("insurance_plan_name"),localStorage.removeItem("insurance_plan_id"),localStorage.removeItem("insurance_plan_name"),this.loadLabTestTypesByInsurance(this.insurancePlanId)}loadLabTestTypesByInsurance(l){var n=this;return(0,g.Z)(function*(){n.labTestTypes=[];let a={headers:(new d.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(y+"/insurance_plans/get_lab_test_type_prices?insurance_plan_id="+l,a).pipe((0,h.x)(()=>n.spinner.hide())).toPromise().then(t=>{n.labTestTypePrices=t}).catch(t=>{n.msgBox.showErrorMessage(t,"Could not load Lab test types")})})()}changeLabTestTypeCoverage(l,n,a){var t=this;return(0,g.Z)(function*(){let T={headers:(new d.WM).set("Authorization","Bearer "+t.auth.user.access_token)};var P={labTestType:{id:n},labTestTypeInsurancePlan:{insurancePlan:{id:l},covered:a}};t.spinner.show(),yield t.http.post(y+"/insurance_plans/change_lab_test_type_coverage",P,T).pipe((0,h.x)(()=>t.spinner.hide())).toPromise().then(o=>{t.labTestTypePrices.forEach(_=>{o.labTestType.id===_.labTestType.id&&(_.labTestTypeInsurancePlan.covered=o.labTestTypeInsurancePlan.covered)})}).catch(o=>{t.msgBox.showErrorMessage(o,"Could not chenge coverage")})})()}updateLabTestTypePriceByInsurance(l,n,a){var t=this;return(0,g.Z)(function*(){let T={headers:(new d.WM).set("Authorization","Bearer "+t.auth.user.access_token)};var P={labTestType:{id:n},labTestTypeInsurancePlan:{insurancePlan:{id:l}},price:a};t.spinner.show(),yield t.http.post(y+"/insurance_plans/update_lab_test_type_price_by_insurance",P,T).pipe((0,h.x)(()=>t.spinner.hide())).toPromise().then(o=>{t.labTestTypePrices.forEach(_=>{o.labTestType.id===_.labTestType.id&&(_.price=o.price,_.covered=o.covered)}),t.msgBox.showSuccessMessage("Price updated successifully")}).catch(o=>{console.log(o),t.msgBox.showErrorMessage(o,"Could not update price")})})()}}return(r=c).\u0275fac=function(l){return new(l||r)(e.Y36(C.e),e.Y36(d.eN),e.Y36(I.FF),e.Y36(E.t2),e.Y36(Z.l))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-lab-test-type-price"]],standalone:!0,features:[e.jDz],decls:37,vars:6,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"text-primary"],[1,"panel-body"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-bordered","table-small"],[4,"ngFor","ngForOf"],[2,"text-align","right"],["type","text",1,"form-control",2,"text-align","center",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],[1,"glyphicon","glyphicon-floppy-disk"],[4,"ngIf"],[3,"click"]],template:function(l,n){1&l&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Lab Test Type Prices"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h4",7),e._uU(10),e.qZA()(),e.TgZ(11,"div",8)(12,"div",9)(13,"div",3),e._UZ(14,"div",10)(15,"div",10),e.TgZ(16,"div",10)(17,"input",11),e.NdJ("ngModelChange",function(t){return n.filterRecords=t}),e.qZA()()(),e._UZ(18,"br"),e.TgZ(19,"table",12)(20,"thead")(21,"tr")(22,"td"),e._uU(23,"ID"),e.qZA(),e.TgZ(24,"td"),e._uU(25,"Test"),e.qZA(),e.TgZ(26,"td"),e._uU(27,"Price"),e.qZA(),e.TgZ(28,"td"),e._uU(29,"Edit Price"),e.qZA(),e.TgZ(30,"td"),e._uU(31,"Action"),e.qZA(),e.TgZ(32,"td"),e._uU(33,"Coverage"),e.qZA()()(),e.TgZ(34,"tbody"),e.YNc(35,x,16,9,"tr",13),e.ALo(36,"searchFilter"),e.qZA()()()()()()()()),2&l&&(e.xp6(10),e.hij("Package: ",n.insurancePlanName,""),e.xp6(7),e.Q6J("ngModel",n.filterRecords),e.xp6(18),e.Q6J("ngForOf",e.xi3(36,3,n.labTestTypePrices,n.filterRecords)))},dependencies:[u.ez,u.sg,u.O5,u.H9,p.u5,p.Fj,p.JJ,p.On,p.UX,m.G]}),c})()}}]);