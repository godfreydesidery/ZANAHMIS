"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[8546],{8546:(q,E,r)=>{r.r(E),r.d(E,{DoctorToRadiologyReportComponent:()=>L});var p=r(5861),M=r(553),C=r(775),h=r(6814),f=r(9862),D=r(4716),v=r(7069),m=r(206),_=r(95),t=r(6689),y=r(6466),Z=r(7140),x=r(585),P=r(379),N=r(2848);function O(a,c){if(1&a){const o=t.EpF();t.TgZ(0,"option",23),t.NdJ("click",function(){const i=t.CHM(o).$implicit,e=t.oxw(2);return t.KtG(e.getClinician(i.id))}),t._uU(1),t.qZA()}if(2&a){const o=c.$implicit;t.xp6(1),t.lnq("",null==o?null:o.firstName," ",null==o?null:o.middleName," ",null==o?null:o.lastName," ")}}function U(a,c){if(1&a&&(t.TgZ(0,"div",3)(1,"div",4)(2,"select",21),t.YNc(3,O,2,3,"option",22),t.qZA()()()),2&a){const o=t.oxw();t.xp6(3),t.Q6J("ngForOf",o.clinicians)}}function I(a,c){if(1&a){const o=t.EpF();t.TgZ(0,"div",3)(1,"div",24)(2,"h4"),t._uU(3,"From"),t.qZA()(),t.TgZ(4,"div",25)(5,"input",26),t.NdJ("ngModelChange",function(n){t.CHM(o);const i=t.oxw();return t.KtG(i.startDate=n)}),t.qZA()(),t.TgZ(6,"div",24)(7,"h4"),t._uU(8,"To"),t.qZA()(),t.TgZ(9,"div",25)(10,"input",26),t.NdJ("ngModelChange",function(n){t.CHM(o);const i=t.oxw();return t.KtG(i.endDate=n)}),t.qZA()(),t.TgZ(11,"div",25)(12,"button",27),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.loadRadiologyReport(n.startDate,n.endDate))}),t._uU(13,"Run Report"),t.qZA()(),t.TgZ(14,"div",24)(15,"button",27),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.clear())}),t._uU(16,"Clear"),t.qZA()()()}if(2&a){const o=t.oxw();t.xp6(5),t.Q6J("ngModel",o.startDate),t.xp6(5),t.Q6J("ngModel",o.endDate)}}function S(a,c){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(null==o||null==o.insurancePlan?null:o.insurancePlan.name)}}function B(a,c){1&a&&(t.TgZ(0,"span"),t._uU(1,"Cash"),t.qZA())}function b(a,c){if(1&a&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t.YNc(10,S,2,1,"span",28),t.YNc(11,B,2,0,"span",28),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.ALo(14,"dateOnly"),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA()()),2&a){const o=c.$implicit;t.xp6(2),t.lnq("",null==o||null==o.patient?null:o.patient.firstName," ",null==o||null==o.patient?null:o.patient.middleName," ",null==o||null==o.patient?null:o.patient.lastName,""),t.xp6(2),t.Oqu(null==o||null==o.patient?null:o.patient.phoneNo),t.xp6(2),t.Oqu(null==o||null==o.patient?null:o.patient.no),t.xp6(2),t.Oqu(null==o||null==o.radiologyType?null:o.radiologyType.name),t.xp6(2),t.Q6J("ngIf","COVERED"===(null==o||null==o.patientBill?null:o.patientBill.status)),t.xp6(1),t.Q6J("ngIf","VERIFIED"===(null==o||null==o.patientBill?null:o.patientBill.status)||"PAID"===(null==o||null==o.patientBill?null:o.patientBill.status)||"UNPAID"===(null==o||null==o.patientBill?null:o.patientBill.status)),t.xp6(2),t.Oqu(t.lcZ(14,10,o.createdAt)),t.xp6(3),t.Oqu(null==o?null:o.status)}}var k=r(6236);const z=r(217),T=M.N.apiUrl;let L=(()=>{var a;class c{constructor(l,n,i,e,u,g){var d=this;this.auth=l,this.http=n,this.modalService=i,this.spinner=e,this.msgBox=u,this.data=g,this.report=[],this.filterRecords="",this.radiologies=[],this.clinicianLocked=!1,this.clinicianId=null,this.clinicianCode="",this.clinicianName="",this.clinicians=[],this.print=(0,p.Z)(function*(){if(0===d.radiologies.length)return void d.msgBox.showErrorMessage3("No data to print");d.documentHeader=yield d.data.getDocumentHeader();var A=[[{text:"Patient Name",fontSize:9,fillColor:"#bdc6c7"},{text:"Phone",fontSize:9,fillColor:"#bdc6c7"},{text:"Reg#",fontSize:9,fillColor:"#bdc6c7"},{text:"Radiology",fontSize:9,fillColor:"#bdc6c7"},{text:"Mode",fontSize:9,fillColor:"#bdc6c7"},{text:"Date",fontSize:9,fillColor:"#bdc6c7"},{text:"Status",fontSize:9,fillColor:"#bdc6c7"}]];d.radiologies.forEach(s=>{var R=[{text:(s?.patient?.firstName+" "+s.patient?.middleName+" "+s.patient?.lastName).toString(),fontSize:9,fillColor:"#ffffff"},{text:s?.patient?.phoneNo.toString(),fontSize:9,fillColor:"#ffffff"},{text:s?.patient?.no.toString(),fontSize:9,fillColor:"#ffffff"},{text:s?.radiologyType?.name.toString(),fontSize:9,fillColor:"#ffffff"},{text:s?.patient?.paymentType.toString(),fontSize:9,fillColor:"#ffffff"},{text:(new m.c).transform(s?.createdAt).toString(),fontSize:9,fillColor:"#ffffff"},{text:s.status.toString(),fontSize:9,fillColor:"#ffffff"}];A.push(R)});const W={header:"",footer:function(s,R){return s.toString()+" of "+R},content:[{columns:[d.documentHeader]},"  ",{text:"Radiologies Report",fontSize:14,bold:!0,alignment:"center"},d.data.getHorizontalLine()," ","Doctor: "+d.clinicianName," ",{layout:"noBorders",table:{widths:[80,80],body:[[{text:"From: "+d.startDate.toString(),fontSize:9},{text:"To: "+d.endDate.toString(),fontSize:9}]]}},"  ",{table:{headerRows:1,widths:[110,80,90,50,50,50,50],body:A}}]};v.createPdf(W).print()}),window.pdfMake.vfs=k.pdfMake.vfs}ngOnInit(){return(0,p.Z)(function*(){})()}loadRadiologyReport(l,n){var i=this;return(0,p.Z)(function*(){let e={headers:(new f.WM).set("Authorization","Bearer "+i.auth.user.access_token)};if(void 0!==l&&void 0!==n)if(l>n)i.msgBox.showErrorMessage3("Could not run. Start date must be earlier or equal to end date");else{null===i.clinicianId&&i.msgBox.showErrorMessage3("Could not run. Please select Doctor");var u={from:l,to:n,clinician:{id:i.clinicianId}};i.spinner.show(),yield i.http.post(T+"/reports/doctor_to_radiology_report",u,e).pipe((0,D.x)(()=>i.spinner.hide())).toPromise().then(g=>{i.radiologies=g,console.log(i.radiologies)}).catch(g=>{i.msgBox.showErrorMessage(g,"")})}else i.msgBox.showErrorMessage3("Could not run. Please select date range")})()}clear(){this.radiologies=[],this.clinicianId=null,this.clinicianName="",this.clinicianCode="",this.clinicians=[],this.clinicianLocked=!1}loadCliniciansLike(l){var n=this;return(0,p.Z)(function*(){if(n.clinicians=[],l.length<2)return;let i={headers:(new f.WM).set("Authorization","Bearer "+n.auth.user.access_token)};yield n.http.get(T+"/clinicians/load_clinicians_like?name_like="+l,i).toPromise().then(e=>{console.log(e),n.clinicians=e}).catch(e=>{n.msgBox.showErrorMessage(e,"")})})()}getClinician(l){var n=this;return(0,p.Z)(function*(){let i={headers:(new f.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.clinicians=[],n.spinner.show(),yield n.http.get(T+"/clinicians/get?id="+l,i).pipe((0,D.x)(()=>n.spinner.hide())).toPromise().then(e=>{n.clinicianId=e?.id,n.clinicianCode=e.code,n.clinicianName=e.firstName+" "+e.middleName+" "+e.lastName,n.clinicianLocked=!0}).catch(e=>{n.msgBox.showErrorMessage(e,""),console.log(e)})})()}exportToSpreadsheet(){var l=this;return(0,p.Z)(function*(){let n=new C.Workbook,i=n.addWorksheet("Radiology Report");i.columns=[{header:"Patient Name",key:"PATIENT_NAME"},{header:"Patient Phone",key:"PATIENT_PHONE"},{header:"Registration#",key:"REGISTRATION_NO"},{header:"Radiology",key:"PROCEDURE_TYPE"},{header:"Payment Mode",key:"PAYMENT_MODE"},{header:"Radiology Date",key:"CONSULTATION_DATE"},{header:"Status",key:"STATUS"}],l.spinner.show(),l.radiologies.forEach(e=>{i.addRow({PATIENT_NAME:(e?.patient?.firstName+" "+e.patient?.middleName+" "+e.patient?.lastName).toString(),PATIENT_PHONE:e?.patient?.phoneNo,REGISTRATION_NO:e?.patient?.no,PROCEDURE_TYPE:e?.radiologyType?.name,PAYMENT_MODE:e?.patient?.paymentType,CONSULTATION_DATE:(new m.c).transform(e?.createdAt),STATUS:e?.status},"n")}),l.spinner.hide(),n.xlsx.writeBuffer().then(e=>{let u=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});z.saveAs(u,"Radiologies Report "+l.startDate.toString()+" to "+l.endDate.toString()+".xlsx")})})()}grant(l){var n=!1;return l.forEach(i=>{this.auth.checkPrivilege(i)&&(n=!0)}),n}}return(a=c).\u0275fac=function(l){return new(l||a)(t.Y36(y.e),t.Y36(f.eN),t.Y36(Z.FF),t.Y36(x.t2),t.Y36(P.l),t.Y36(N.D))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-doctor-to-radiology-report"]],standalone:!0,features:[t.jDz],decls:49,vars:5,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],["type","button",1,"btn","btn-success","btn-outline",3,"click"],[1,"fa","fa-print"],[1,"panel-body"],[1,"col-sm-3"],[1,"input-group"],["type","text","name","q","placeholder","Search Doctor...",1,"form-control",3,"ngModel","readonly","ngModelChange"],[1,"input-group-btn"],[1,"btn",3,"click"],[1,"fa","fa-times-rectangle"],["class","row",4,"ngIf"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"table","table-responsive","table-hover","table-striped","table-small"],[2,"font-weight","bold"],[4,"ngFor","ngForOf"],["multiple","multiple",1,"form-control"],["style","height: 1cm; cursor: pointer; font-size: large;",3,"click",4,"ngFor","ngForOf"],[2,"height","1cm","cursor","pointer","font-size","large",3,"click"],[1,"col-sm-1"],[1,"col-sm-2"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-primary","btn-outline",3,"click"],[4,"ngIf"]],template:function(l,n){1&l&&(t.TgZ(0,"section",0)(1,"div",1)(2,"h1"),t._uU(3,"Doctor to Radiology Report"),t.qZA()()(),t.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"button",7),t.NdJ("click",function(){return n.print()}),t._UZ(10,"i",8),t._uU(11," Print"),t.qZA()(),t.TgZ(12,"div",9)(13,"div",3)(14,"div",4)(15,"div",3)(16,"div",10)(17,"h4"),t._uU(18,"Doctor Name"),t.qZA(),t.TgZ(19,"div",11)(20,"input",12),t.NdJ("ngModelChange",function(e){return n.clinicianName=e})("ngModelChange",function(e){return n.loadCliniciansLike(e)}),t.qZA(),t.TgZ(21,"span",13)(22,"button",14),t.NdJ("click",function(){return n.clear()}),t._UZ(23,"i",15),t.qZA()()(),t.YNc(24,U,4,1,"div",16),t.qZA()(),t._UZ(25,"hr"),t.YNc(26,I,17,2,"div",16),t.qZA()(),t.TgZ(27,"div",3)(28,"div",17),t._UZ(29,"hr"),t.TgZ(30,"table",18)(31,"thead")(32,"tr",19)(33,"td"),t._uU(34,"Patient Name"),t.qZA(),t.TgZ(35,"td"),t._uU(36,"Patient Phone"),t.qZA(),t.TgZ(37,"td"),t._uU(38,"Registration#"),t.qZA(),t.TgZ(39,"td"),t._uU(40,"Radiology"),t.qZA(),t.TgZ(41,"td"),t._uU(42,"Payment Mode"),t.qZA(),t.TgZ(43,"td"),t._uU(44,"Radiology Date"),t.qZA(),t.TgZ(45,"td"),t._uU(46,"Status"),t.qZA()()(),t.TgZ(47,"tbody"),t.YNc(48,b,17,12,"tr",20),t.qZA()()()()()()()()()),2&l&&(t.xp6(20),t.Q6J("ngModel",n.clinicianName)("readonly",n.clinicianLocked),t.xp6(4),t.Q6J("ngIf",n.clinicians.length>0),t.xp6(2),t.Q6J("ngIf",null!=n.clinicianId),t.xp6(22),t.Q6J("ngForOf",n.radiologies))},dependencies:[h.ez,h.sg,h.O5,_.u5,_.YN,_.Kr,_.Fj,_.JJ,_.On,_.UX,m.c]}),c})()}}]);