"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[7781],{7781:(Q,g,c)=>{c.r(g),c.d(g,{StoreToPharmacyTOComponent:()=>w});var d=c(5861),_=c(9862),m=c(4716),y=c(553),T=c(6814),u=c(95),t=c(6689),Z=c(6466),O=c(7140),f=c(585),P=c(8237),b=c(379);function v(l,s){if(1&l){const o=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.verifyOrder())}),t._UZ(1,"span",30),t._uU(2,"Verify Order"),t.qZA()}}function A(l,s){if(1&l){const o=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.approveOrder())}),t._UZ(1,"span",31),t._uU(2,"Approve Order"),t.qZA()}}function x(l,s){if(1&l){const o=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.issueGoods())}),t._UZ(1,"span",32),t._uU(2,"Issue Goods"),t.qZA()}}function U(l,s){1&l&&t._UZ(0,"td")}function C(l,s){if(1&l){const o=t.EpF();t.TgZ(0,"button",41),t.NdJ("click",function(){t.CHM(o);const n=t.oxw(2).$implicit,r=t.oxw(2);return t.KtG(r.loadItemNames(null==n||null==n.medicine?null:n.medicine.id,n.id))}),t._uU(1,"Add Batch"),t.qZA()}}function S(l,s){if(1&l&&(t.TgZ(0,"td"),t.YNc(1,C,2,0,"button",40),t.qZA()),2&l){const o=t.oxw(3);t.xp6(1),t.Q6J("ngIf","PENDING"===(null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.status))}}function M(l,s){1&l&&t._UZ(0,"span",44)}function q(l,s){if(1&l){const o=t.EpF();t.TgZ(0,"span",45),t.NdJ("click",function(){t.CHM(o);const n=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.deleteBatch(n.id))}),t.qZA()}}function I(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td")(2,"small"),t._uU(3),t.qZA()(),t.TgZ(4,"td")(5,"small"),t._uU(6),t.qZA()(),t.TgZ(7,"td")(8,"small"),t._uU(9),t.ALo(10,"date"),t.qZA()(),t.TgZ(11,"td"),t.YNc(12,M,1,0,"span",42),t.YNc(13,q,1,0,"span",43),t.qZA()()),2&l){const o=s.$implicit,e=t.oxw(3);t.xp6(3),t.Oqu(o.no),t.xp6(3),t.Oqu(o.storeSKUQty),t.xp6(3),t.Oqu(t.lcZ(10,5,o.expiryDate)),t.xp6(3),t.Q6J("ngIf","PENDING"===(null==e.storeToPharmacyTO?null:e.storeToPharmacyTO.status)),t.xp6(1),t.Q6J("ngIf","PENDING"===(null==e.storeToPharmacyTO?null:e.storeToPharmacyTO.status))}}function E(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td")(2,"small"),t._uU(3),t.qZA()(),t.TgZ(4,"td")(5,"small"),t._uU(6),t.qZA()(),t.TgZ(7,"td")(8,"small"),t._uU(9),t.ALo(10,"date"),t.qZA()()()),2&l){const o=s.$implicit;t.xp6(3),t.Oqu(o.no),t.xp6(3),t.Oqu(o.pharmacySKUQty),t.xp6(3),t.Oqu(t.lcZ(10,3,o.expiryDate))}}function N(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td")(2,"table",38)(3,"tr")(4,"td")(5,"small"),t._uU(6,"Code"),t.qZA()(),t.TgZ(7,"td")(8,"small"),t._uU(9),t.qZA()()(),t.TgZ(10,"tr")(11,"td")(12,"small"),t._uU(13,"Name"),t.qZA()(),t.TgZ(14,"td")(15,"small"),t._uU(16),t.qZA()()(),t.TgZ(17,"tr")(18,"td")(19,"small"),t._uU(20,"Qty/UOM"),t.qZA()(),t.TgZ(21,"td")(22,"small")(23,"b"),t._uU(24),t.qZA(),t.TgZ(25,"i"),t._uU(26),t.qZA()()()()()(),t.YNc(27,S,2,1,"td",36),t.TgZ(28,"td")(29,"table",38)(30,"tr")(31,"td"),t._UZ(32,"small"),t._uU(33),t.qZA()(),t.TgZ(34,"tr")(35,"td"),t._UZ(36,"small"),t._uU(37),t.qZA()(),t.TgZ(38,"tr")(39,"td")(40,"small")(41,"b"),t._uU(42),t.qZA(),t.TgZ(43,"i"),t._uU(44),t.qZA()()()()(),t.TgZ(45,"table",39)(46,"thead")(47,"tr")(48,"td")(49,"small"),t._uU(50,"Batch#"),t.qZA()(),t.TgZ(51,"td")(52,"small"),t._uU(53,"Qty"),t.qZA()(),t.TgZ(54,"td")(55,"small"),t._uU(56,"Expiry Date"),t.qZA()(),t.TgZ(57,"td")(58,"small"),t._uU(59,"Action"),t.qZA()()()(),t.TgZ(60,"tbody"),t.YNc(61,I,14,7,"tr",37),t.qZA()()(),t.TgZ(62,"td")(63,"table",38)(64,"tr")(65,"td")(66,"small"),t._uU(67),t.qZA()()(),t.TgZ(68,"tr")(69,"td")(70,"small"),t._uU(71),t.qZA()()(),t.TgZ(72,"tr")(73,"td")(74,"small")(75,"b"),t._uU(76),t.qZA(),t.TgZ(77,"i"),t._uU(78),t.qZA()()()()(),t.TgZ(79,"table",39)(80,"thead")(81,"tr")(82,"td")(83,"small"),t._uU(84,"Batch#"),t.qZA()(),t.TgZ(85,"td")(86,"small"),t._uU(87,"Qty"),t.qZA()(),t.TgZ(88,"td")(89,"small"),t._uU(90,"Expiry Date"),t.qZA()()()(),t.TgZ(91,"tbody"),t.YNc(92,E,11,5,"tr",37),t.qZA()()()()),2&l){const o=s.$implicit,e=t.oxw(2);t.xp6(9),t.Oqu(null==o||null==o.medicine?null:o.medicine.code),t.xp6(7),t.Oqu(null==o||null==o.medicine?null:o.medicine.name),t.xp6(8),t.Oqu(o.orderedPharmacySKUQty),t.xp6(2),t.Oqu(null==o||null==o.medicine?null:o.medicine.uom),t.xp6(1),t.Q6J("ngIf","PENDING"===(null==e.storeToPharmacyTO?null:e.storeToPharmacyTO.status)),t.xp6(6),t.hij(" ",null==o||null==o.item?null:o.item.code," ."),t.xp6(4),t.hij(" ",null==o||null==o.item?null:o.item.name," ."),t.xp6(5),t.Oqu(o.transferedStoreSKUQty),t.xp6(2),t.hij("",null==o||null==o.item?null:o.item.uom," ."),t.xp6(17),t.Q6J("ngForOf",null==o?null:o.storeToPharmacyBatches),t.xp6(6),t.Oqu(null==o||null==o.medicine?null:o.medicine.code),t.xp6(4),t.Oqu(null==o||null==o.medicine?null:o.medicine.name),t.xp6(5),t.Oqu(o.transferedPharmacySKUQty),t.xp6(2),t.hij("",null==o||null==o.medicine?null:o.medicine.uom," "),t.xp6(14),t.Q6J("ngForOf",null==o?null:o.storeToPharmacyBatches)}}function D(l,s){if(1&l&&(t.TgZ(0,"div",4)(1,"h4",33),t._uU(2,"Order"),t.qZA(),t.TgZ(3,"h5"),t._uU(4),t.qZA(),t.TgZ(5,"h5"),t._uU(6),t.qZA(),t.TgZ(7,"h5"),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"h5"),t._uU(11),t.qZA(),t.TgZ(12,"h5"),t._uU(13),t.qZA(),t.TgZ(14,"h5"),t._uU(15),t.qZA(),t.TgZ(16,"h5"),t._uU(17),t.qZA(),t.TgZ(18,"h5"),t._uU(19),t.qZA(),t.TgZ(20,"table",34)(21,"thead")(22,"tr",35)(23,"td")(24,"small"),t._uU(25,"Requested from Pharmacy - Pharmacy SKUs"),t.qZA()(),t.YNc(26,U,1,0,"td",36),t.TgZ(27,"td")(28,"small"),t._uU(29,"Transfer to Pharmacy - Store SKUs"),t.qZA()(),t.TgZ(30,"td")(31,"small"),t._uU(32,"Receive by Pharmacy - Pharmacy SKUs"),t.qZA()()()(),t.TgZ(33,"tbody"),t.YNc(34,N,93,15,"tr",37),t.qZA()()()),2&l){const o=t.oxw();t.xp6(4),t.hij("Pharmacy: ",null==o.storeToPharmacyTO||null==o.storeToPharmacyTO.pharmacy?null:o.storeToPharmacyTO.pharmacy.name,""),t.xp6(2),t.hij("Order#: ",null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.no,""),t.xp6(2),t.hij("Order Date: ",t.lcZ(9,10,null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.orderDate),""),t.xp6(3),t.hij("Status: ",null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.status,""),t.xp6(2),t.hij("Status Description: ",null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.statusDescription,""),t.xp6(2),t.hij("Created: ",null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.created,""),t.xp6(2),t.hij("Verified: ",null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.verified,""),t.xp6(2),t.hij("Approved: ",null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.approved,""),t.xp6(7),t.Q6J("ngIf","PENDING"===(null==o.storeToPharmacyTO?null:o.storeToPharmacyTO.status)),t.xp6(8),t.Q6J("ngForOf",o.storeToPharmacyTO.storeToPharmacyTODetails)}}function B(l,s){if(1&l&&(t.TgZ(0,"option",46),t._uU(1),t.qZA()),2&l){const o=s.$implicit;t.Q6J("ngValue",o),t.xp6(1),t.Oqu(o)}}const h=y.N.apiUrl;let w=(()=>{var l;class s{constructor(e,n,r,a,i,p){this.auth=e,this.http=n,this.modalService=r,this.spinner=a,this.router=i,this.msgBox=p,this.loadedItemNames=[],this.batchNo="",this.batchStoreSKUQty=0,this.batchStoreItemCode="",this.batchStoreItemName="",this.filterRecords=""}ngOnInit(){var e=this;return(0,d.Z)(function*(){e.id=localStorage.getItem("store-to-pharmacy-t-o-id"),localStorage.removeItem("store-to-pharmacy-t-o-id"),e.loadCurrentTransferOrder(e.id)})()}loadCurrentTransferOrder(e){var n=this;return(0,d.Z)(function*(){if(null===e)return;let r={headers:(new _.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(h+"/store_to_pharmacy_t_os/get?id="+e,r).pipe((0,m.x)(()=>n.spinner.hide())).toPromise().then(a=>{n.storeToPharmacyTO=a,console.log(a)},a=>{console.log(a),n.msgBox.showErrorMessage(a,"")})})()}verifyOrder(){var e=this;return(0,d.Z)(function*(){if(!window.confirm("Confirm verify order. Confirm?"))return;let n={headers:(new _.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var r={id:e.id};e.spinner.show(),yield e.http.post(h+"/store_to_pharmacy_t_os/verify",r,n).pipe((0,m.x)(()=>e.spinner.hide())).toPromise().then(a=>{e.loadCurrentTransferOrder(e.id),e.msgBox.showSuccessMessage("Order verified successifully"),console.log(a)},a=>{console.log(a),e.msgBox.showErrorMessage(a,"")})})()}approveOrder(){var e=this;return(0,d.Z)(function*(){if(!window.confirm("Confirm approve order. Confirm?"))return;let n={headers:(new _.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var r={id:e.id};e.spinner.show(),yield e.http.post(h+"/store_to_pharmacy_t_os/approve",r,n).pipe((0,m.x)(()=>e.spinner.hide())).toPromise().then(a=>{e.loadCurrentTransferOrder(e.id),e.msgBox.showSuccessMessage("Order approved successifully"),console.log(a)},a=>{console.log(a),e.msgBox.showErrorMessage(a,"")})})()}issueGoods(){var e=this;return(0,d.Z)(function*(){if(!window.confirm("Confirm issue goods. Confirm?"))return;let n={headers:(new _.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var r={id:e.id};e.spinner.show(),yield e.http.post(h+"/store_to_pharmacy_t_os/issue",r,n).pipe((0,m.x)(()=>e.spinner.hide())).toPromise().then(a=>{e.loadCurrentTransferOrder(e.id),e.msgBox.showSuccessMessage("Goods issued successifully"),console.log(a)},a=>{console.log(a),e.msgBox.showErrorMessage(a,"")})})()}loadItemNames(e,n){var r=this;return(0,d.Z)(function*(){r.loadedItemNames=[];let a={headers:(new _.WM).set("Authorization","Bearer "+r.auth.user.access_token)};r.spinner.show(),yield r.http.get(h+"/store_to_pharmacy_t_os/load_item_names_by_medicine?medicine_id="+e,a).pipe((0,m.x)(()=>r.spinner.hide())).toPromise().then(i=>{r.loadedItemNames=i,r.batchNo="",r.batchStoreItemName="",r.batchStoreItemId=null,r.batchStoreItemCode="",r.batchStoreSKUQty=0,r.batchStoreToPharmacyTODetailId=n,r.batchExpiryDate=void 0,console.log(i)},i=>{console.log(i),r.msgBox.showErrorMessage(i,"")})})()}addBatch(){var e=this;return(0,d.Z)(function*(){let n={headers:(new _.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var r={id:e.batchId,no:e.batchNo,storeSKUQty:e.batchStoreSKUQty,expiryDate:e.batchExpiryDate,storeToPharmacyTODetail:{id:e.batchStoreToPharmacyTODetailId},item:{name:e.batchStoreItemName}};e.spinner.show(),yield e.http.post(h+"/store_to_pharmacy_t_os/add_batch",r,n).pipe((0,m.x)(()=>e.spinner.hide())).toPromise().then(a=>{e.loadCurrentTransferOrder(e.id),console.log(a)},a=>{console.log(a),e.msgBox.showErrorMessage(a,"")})})()}deleteBatch(e){var n=this;return(0,d.Z)(function*(){let r={headers:(new _.WM).set("Authorization","Bearer "+n.auth.user.access_token)};var a={id:e};n.spinner.show(),yield n.http.post(h+"/store_to_pharmacy_t_os/delete_batch",a,r).pipe((0,m.x)(()=>n.spinner.hide())).toPromise().then(i=>{n.loadCurrentTransferOrder(n.id),console.log(i)},i=>{console.log(i),n.msgBox.showErrorMessage(i,"")})})()}searchItem(){var e=this;return(0,d.Z)(function*(){let n={headers:(new _.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var r=e.batchStoreItemCode,a="",i=e.batchStoreItemName;""!=r&&(a="",i=""),""!=a&&(i=""),e.spinner.show(),yield e.http.get(h+"/items/search?code="+r+"&barcode="+a+"&name="+i,n).pipe((0,m.x)(()=>e.spinner.hide())).toPromise().then(p=>{e.batchStoreItemId=p?.id,e.batchStoreItemCode=p.code,e.batchStoreItemName=p.name},p=>{console.log(p),e.msgBox.showErrorMessage(p,"")})})()}grant(e){var n=!1;return e.forEach(r=>{this.auth.checkPrivilege(r)&&(n=!0)}),n}}return(l=s).\u0275fac=function(e){return new(e||l)(t.Y36(Z.e),t.Y36(_.eN),t.Y36(O.FF),t.Y36(f.t2),t.Y36(P.F0),t.Y36(b.l))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-store-to-pharmacy-t-o"]],standalone:!0,features:[t.jDz],decls:65,vars:10,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],["class","btn btn-primary btn-outline",3,"click",4,"ngIf"],[1,"panel-body"],["class","col-sm-12",4,"ngIf"],["id","add-sku-modal","tabindex","-2","role","dialog",1,"modal","fade","modal-success"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-title"],[1,"modal-body"],[1,"col-sm-4"],[1,"col-sm-8"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[3,"click"],["type","text","list","loadedItemNames",1,"form-control",3,"ngModel","ngModelChange"],["id","loadedItemNames",2,"padding","0px"],[3,"ngValue",4,"ngFor","ngForOf"],["type","number",1,"form-control",3,"ngModel","ngModelChange"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-success","pull-right",3,"click"],[1,"btn","btn-primary","btn-outline",3,"click"],[1,"glyphicon","glyphicon-check"],[1,"glyphicon","glyphicon-ok"],[1,"glyphicon","glyphicon-shopping-cart"],[1,"text-primary"],[1,"table","table-responsive","table-striped","table-bordered","table-small"],[2,"font-weight","bold"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"table","table-small"],[1,"table","table-responsive","table-small"],["data-toggle","modal","data-target","#add-sku-modal",3,"click",4,"ngIf"],["data-toggle","modal","data-target","#add-sku-modal",3,"click"],["class","glyphicon glyphicon-pencil",4,"ngIf"],["class","glyphicon glyphicon-trash text-danger",3,"click",4,"ngIf"],[1,"glyphicon","glyphicon-pencil"],[1,"glyphicon","glyphicon-trash","text-danger",3,"click"],[3,"ngValue"]],template:function(e,n){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"h1"),t._uU(3,"Store To Pharmacy Transfer Order"),t.qZA()()(),t.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6),t.YNc(9,v,3,0,"button",7),t.YNc(10,A,3,0,"button",7),t.YNc(11,x,3,0,"button",7),t.qZA(),t.TgZ(12,"div",8)(13,"div",3),t.YNc(14,D,35,12,"div",9),t.qZA()()()()()(),t.TgZ(15,"div",10)(16,"div",11)(17,"div",12)(18,"div",13)(19,"button",14)(20,"span",15),t._uU(21,"\xd7"),t.qZA()(),t.TgZ(22,"h3",16),t._uU(23,"Add SKUs"),t.qZA()(),t.TgZ(24,"div",17)(25,"div",3)(26,"div",18)(27,"h4"),t._uU(28,"Code"),t.qZA()(),t.TgZ(29,"div",19)(30,"div",3)(31,"div",19)(32,"input",20),t.NdJ("ngModelChange",function(a){return n.batchStoreItemCode=a}),t.qZA()(),t.TgZ(33,"div",18)(34,"button",21),t.NdJ("click",function(){return n.searchItem()}),t._uU(35,"Search"),t.qZA()()()()(),t.TgZ(36,"div",3)(37,"div",18)(38,"h4"),t._uU(39,"Name"),t.qZA()(),t.TgZ(40,"div",19)(41,"input",22),t.NdJ("ngModelChange",function(a){return n.batchStoreItemName=a}),t.qZA(),t.TgZ(42,"datalist",23),t.YNc(43,B,2,2,"option",24),t.qZA()()(),t.TgZ(44,"div",3)(45,"div",18)(46,"h4"),t._uU(47,"Batch#"),t.qZA()(),t.TgZ(48,"div",19)(49,"input",20),t.NdJ("ngModelChange",function(a){return n.batchNo=a}),t.qZA()()(),t.TgZ(50,"div",3)(51,"div",18)(52,"h4"),t._uU(53,"Qty"),t.qZA()(),t.TgZ(54,"div",19)(55,"input",25),t.NdJ("ngModelChange",function(a){return n.batchStoreSKUQty=a}),t.qZA()()(),t.TgZ(56,"div",3)(57,"div",18)(58,"h4"),t._uU(59,"Expiry Date"),t.qZA()(),t.TgZ(60,"div",19)(61,"input",26),t.NdJ("ngModelChange",function(a){return n.batchExpiryDate=a}),t.qZA()()(),t.TgZ(62,"div",27)(63,"button",28),t.NdJ("click",function(){return n.addBatch()}),t._uU(64,"Save"),t.qZA()()()()()()),2&e&&(t.xp6(9),t.Q6J("ngIf","PENDING"===(null==n.storeToPharmacyTO?null:n.storeToPharmacyTO.status)),t.xp6(1),t.Q6J("ngIf","VERIFIED"===(null==n.storeToPharmacyTO?null:n.storeToPharmacyTO.status)),t.xp6(1),t.Q6J("ngIf","APPROVED"===(null==n.storeToPharmacyTO?null:n.storeToPharmacyTO.status)),t.xp6(3),t.Q6J("ngIf",null!=n.storeToPharmacyTO),t.xp6(18),t.Q6J("ngModel",n.batchStoreItemCode),t.xp6(9),t.Q6J("ngModel",n.batchStoreItemName),t.xp6(2),t.Q6J("ngForOf",n.loadedItemNames),t.xp6(6),t.Q6J("ngModel",n.batchNo),t.xp6(6),t.Q6J("ngModel",n.batchStoreSKUQty),t.xp6(6),t.Q6J("ngModel",n.batchExpiryDate))},dependencies:[T.ez,T.sg,T.O5,T.uU,u.u5,u.YN,u.Kr,u.Fj,u.wV,u.JJ,u.On,u.UX]}),s})()}}]);