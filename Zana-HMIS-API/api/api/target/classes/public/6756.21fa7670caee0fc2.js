"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[6756],{7465:(O,g,s)=>{s.r(g),s.d(g,{DeceasedNoteComponent:()=>T});var d=s(5861),h=s(6814),r=s(95),f=s(4512),m=s(9862),c=s(4716),D=s(553),e=s(6689),Z=s(6466),v=s(585),M=s(379);function A(l,_){if(1&l&&(e.TgZ(0,"h3",16),e._uU(1,"Name: "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,", File No: "),e.TgZ(5,"b"),e._uU(6),e.qZA(),e._uU(7,", "),e.TgZ(8,"b"),e._uU(9),e.ALo(10,"date"),e.ALo(11,"age"),e.qZA(),e._uU(12),e.qZA()),2&l){const t=e.oxw();e.xp6(3),e.lnq("",null==t.admission||null==t.admission.patient?null:t.admission.patient.firstName," ",null==t.admission||null==t.admission.patient?null:t.admission.patient.middleName," ",null==t.admission||null==t.admission.patient?null:t.admission.patient.lastName,""),e.xp6(3),e.Oqu(null==t.admission||null==t.admission.patient?null:t.admission.patient.no),e.xp6(3),e.AsE("Date of Birth: ",e.lcZ(10,9,t.admission.patient.dateOfBirth)," Age: ",e.lcZ(11,11,t.admission.patient.dateOfBirth),""),e.xp6(3),e.lnq(", ",null==t.admission||null==t.admission.patient?null:t.admission.patient.gender,", ",t.admission.paymentType," ",null==t.admission||null==t.admission.insurancePlan?null:t.admission.insurancePlan.name,"")}}function C(l,_){if(1&l&&(e.TgZ(0,"h3",16),e._uU(1,"Name: "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,", File No: "),e.TgZ(5,"b"),e._uU(6),e.qZA(),e._uU(7,", "),e.TgZ(8,"b"),e._uU(9),e.ALo(10,"date"),e.ALo(11,"age"),e.qZA(),e._uU(12),e.qZA()),2&l){const t=e.oxw();e.xp6(3),e.lnq("",null==t.consultation||null==t.consultation.patient?null:t.consultation.patient.firstName," ",null==t.consultation||null==t.consultation.patient?null:t.consultation.patient.middleName," ",null==t.consultation||null==t.consultation.patient?null:t.consultation.patient.lastName,""),e.xp6(3),e.Oqu(null==t.consultation||null==t.consultation.patient?null:t.consultation.patient.no),e.xp6(3),e.AsE("Date of Birth: ",e.lcZ(10,9,t.consultation.patient.dateOfBirth)," Age: ",e.lcZ(11,11,t.consultation.patient.dateOfBirth),""),e.xp6(3),e.lnq(", ",null==t.consultation||null==t.consultation.patient?null:t.consultation.patient.gender,", ",t.consultation.paymentType," ",null==t.consultation||null==t.consultation.insurancePlan?null:t.consultation.insurancePlan.name,"")}}const p=D.N.apiUrl;let T=(()=>{var l;class _{constructor(n,i,a,o){this.auth=n,this.http=i,this.spinner=a,this.msgBox=o,this.id=null,this.patientSummary="",this.causeOfDeath="",this.admissionId=null,this.consultationId=null}ngOnInit(){var n=this;return(0,d.Z)(function*(){n.admissionId=localStorage.getItem("admission-id"),n.consultationId=localStorage.getItem("consultation-id"),localStorage.removeItem("admission-id"),localStorage.removeItem("consultation-id"),null!=n.admissionId?yield n.loadAdmission(n.admissionId):null!=n.consultationId&&(yield n.loadConsultation(n.consultationId)),yield n.loadDeceasedNote(n.admission.id,n.consultation.id)})()}loadAdmission(n){var i=this;return(0,d.Z)(function*(){let a={headers:(new m.WM).set("Authorization","Bearer "+i.auth.user.access_token)};i.spinner.show(),yield i.http.get(p+"/patients/load_admission?id="+n,a).pipe((0,c.x)(()=>i.spinner.hide())).toPromise().then(o=>{i.admission=o,console.log(o)}).catch(o=>{i.msgBox.showErrorMessage(o,"Could not load admission"),console.log(o)})})()}loadConsultation(n){var i=this;return(0,d.Z)(function*(){let a={headers:(new m.WM).set("Authorization","Bearer "+i.auth.user.access_token)};i.spinner.show(),yield i.http.get(p+"/patients/load_consultation?id="+n,a).pipe((0,c.x)(()=>i.spinner.hide())).toPromise().then(o=>{i.consultation=o,console.log(o)}).catch(o=>{i.msgBox.showErrorMessage(o,"Could not load consultation"),console.log(o)})})()}loadDeceasedNote(n,i){var a=this;return(0,d.Z)(function*(){let o={headers:(new m.WM).set("Authorization","Bearer "+a.auth.user.access_token)};a.spinner.show(),yield a.http.get(p+"/patients/load_deceased_note?admission_id="+n+"&consultation_id="+i,o).pipe((0,c.x)(()=>a.spinner.hide())).toPromise().then(u=>{a.deceasedNote=u,a.id=u.id,a.patientSummary=u.patientSummary,a.causeOfDeath=u.causeOfDeath,a.date=u.date,a.time=u.time,console.log(u)}).catch(u=>{console.log(u)})})()}saveDeceasedNote(){var n=this;return(0,d.Z)(function*(){let i={headers:(new m.WM).set("Authorization","Bearer "+n.auth.user.access_token)};if(""!==n.patientSummary&&""!==n.causeOfDeath&&null!==n.date){if(null===n.id&&!window.confirm("Confirm submitting discharge plan. Confirm?"))return n.id=null,n.patientSummary="",void(n.causeOfDeath="");var a={patientSummary:n.patientSummary,causeOfDeath:n.causeOfDeath,date:n.date,time:n.time,admission:{id:n.admissionId},consultation:{id:n.consultationId}};n.spinner.show(),yield n.http.post(p+"/patients/save_deceased_note",a,i).pipe((0,c.x)(()=>n.spinner.hide())).toPromise().then(o=>{n.deceasedNote=o,n.id=o.id,n.patientSummary=o.patientSummary,n.causeOfDeath=o.causeOfDeath,n.date=o.date,n.time=o.time,n.msgBox.showSuccessMessage("Saved successifully")}).catch(o=>{n.msgBox.showErrorMessage(o,"Could not save"),console.log(o)})}else n.msgBox.showErrorMessage3("The fields marked with * are required fields")})()}}return(l=_).\u0275fac=function(n){return new(n||l)(e.Y36(Z.e),e.Y36(m.eN),e.Y36(v.t2),e.Y36(M.l))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-deceased-note"]],standalone:!0,features:[e.jDz],decls:40,vars:6,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"btn-group"],[1,"panel-body"],["role","alert",1,"col-sm-12","alert","alert-primary"],["class","text-primary",4,"ngIf"],[1,"col-sm-6"],[1,"form-control",3,"ngModel","ngModelChange"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],["type","time",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-primary","pull-right",3,"click"],[1,"text-primary"]],template:function(n,i){1&n&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Deceased Note"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"div",7),e.qZA(),e.TgZ(10,"div",8)(11,"div",3)(12,"div",9),e.YNc(13,A,13,13,"h3",10),e.YNc(14,C,13,13,"h3",10),e.qZA(),e.TgZ(15,"div",4)(16,"div",3)(17,"div",11)(18,"div")(19,"h4"),e._uU(20,"Patient Summary*"),e.qZA()(),e.TgZ(21,"textarea",12),e.NdJ("ngModelChange",function(o){return i.patientSummary=o}),e.qZA()(),e.TgZ(22,"div",11)(23,"div")(24,"h4"),e._uU(25,"Cause of Death*"),e.qZA()(),e.TgZ(26,"textarea",12),e.NdJ("ngModelChange",function(o){return i.causeOfDeath=o}),e.qZA()(),e.TgZ(27,"div",11)(28,"div")(29,"h4"),e._uU(30,"Date*"),e.qZA()(),e.TgZ(31,"input",13),e.NdJ("ngModelChange",function(o){return i.date=o}),e.qZA()(),e.TgZ(32,"div",11)(33,"div")(34,"h4"),e._uU(35,"Time*"),e.qZA()(),e.TgZ(36,"input",14),e.NdJ("ngModelChange",function(o){return i.time=o}),e.qZA()(),e._UZ(37,"br"),e.TgZ(38,"button",15),e.NdJ("click",function(){return i.saveDeceasedNote()}),e._uU(39,"Save"),e.qZA()()()()()()()()()),2&n&&(e.xp6(13),e.Q6J("ngIf",null!=i.admission),e.xp6(1),e.Q6J("ngIf",null!=i.consultation),e.xp6(7),e.Q6J("ngModel",i.patientSummary),e.xp6(5),e.Q6J("ngModel",i.causeOfDeath),e.xp6(5),e.Q6J("ngModel",i.date),e.xp6(5),e.Q6J("ngModel",i.time))},dependencies:[h.ez,h.O5,h.uU,r.u5,r.Fj,r.JJ,r.On,r.UX,f.C]}),_})()}}]);