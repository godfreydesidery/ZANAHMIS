"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[3028],{3028:(D,T,l)=>{l.r(T),l.d(T,{LabTestComponent:()=>w});var c=l(5861),h=l(6814),p=l(9862),u=l(95),d=l(4716),v=l(4512),Z=l(553),t=l(6689),C=l(6466),b=l(7140),M=l(585),x=l(8237),f=l(379);function E(a,_){1&a&&(t.TgZ(0,"span"),t._uU(1,"NONE"),t.qZA())}function A(a,_){if(1&a){const s=t.EpF();t.TgZ(0,"div")(1,"h5"),t._uU(2,"Reason for rejection"),t.qZA(),t.TgZ(3,"input",19),t.NdJ("ngModelChange",function(e){t.CHM(s);const o=t.oxw().$implicit;return t.KtG(o.rejectComment=e)}),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"button",20),t.NdJ("click",function(){t.CHM(s);const e=t.oxw().$implicit,o=t.oxw();return t.KtG(o.saveReasonForRejection(e.id,e.rejectComment))}),t._uU(6,"Save Reason for Rejection"),t.qZA()()}if(2&a){const s=t.oxw().$implicit;t.xp6(3),t.Q6J("ngModel",s.rejectComment)}}function L(a,_){if(1&a){const s=t.EpF();t.TgZ(0,"textarea",31),t.NdJ("ngModelChange",function(e){t.CHM(s);const o=t.oxw(2).$implicit;return t.KtG(o.result=e)}),t.qZA()}if(2&a){const s=t.oxw(2).$implicit;t.Q6J("ngModel",s.result)}}function U(a,_){if(1&a){const s=t.EpF();t.TgZ(0,"textarea",31),t.NdJ("ngModelChange",function(e){t.CHM(s);const o=t.oxw(2).$implicit;return t.KtG(o.result=e)}),t.qZA()}if(2&a){const s=t.oxw(2).$implicit;t.Q6J("ngModel",s.result)}}function y(a,_){if(1&a){const s=t.EpF();t.TgZ(0,"textarea",32),t.NdJ("ngModelChange",function(e){t.CHM(s);const o=t.oxw(2).$implicit;return t.KtG(o.result=e)}),t.qZA()}if(2&a){const s=t.oxw(2).$implicit;t.Q6J("ngModel",s.result)}}function P(a,_){if(1&a&&(t.TgZ(0,"option"),t._uU(1),t.qZA()),2&a){const s=_.$implicit;t.xp6(1),t.Oqu(s.name)}}function O(a,_){if(1&a){const s=t.EpF();t.TgZ(0,"div",21)(1,"div",4)(2,"span"),t._uU(3,"Results"),t.qZA(),t.YNc(4,L,1,1,"textarea",22),t.YNc(5,U,1,1,"textarea",22),t.YNc(6,y,1,1,"textarea",23),t.qZA(),t.TgZ(7,"div",24)(8,"span"),t._uU(9,"Range"),t.qZA(),t.TgZ(10,"select",25),t.NdJ("ngModelChange",function(e){t.CHM(s);const o=t.oxw().$implicit;return t.KtG(o.range=e)}),t._UZ(11,"option"),t.YNc(12,P,2,1,"option",26),t.qZA()(),t.TgZ(13,"div",24)(14,"span"),t._uU(15,"Level"),t.qZA(),t.TgZ(16,"select",25),t.NdJ("ngModelChange",function(e){t.CHM(s);const o=t.oxw().$implicit;return t.KtG(o.level=e)}),t._UZ(17,"option"),t.TgZ(18,"option"),t._uU(19,"Low"),t.qZA(),t.TgZ(20,"option"),t._uU(21,"Medium"),t.qZA(),t.TgZ(22,"option"),t._uU(23,"High"),t.qZA()()(),t.TgZ(24,"div",24)(25,"span"),t._uU(26,"Unit"),t.qZA(),t.TgZ(27,"input",27),t.NdJ("ngModelChange",function(e){t.CHM(s);const o=t.oxw().$implicit;return t.KtG(o.unit=e)}),t.qZA()(),t.TgZ(28,"div",14)(29,"span"),t._uU(30,"Attachment"),t.qZA(),t._UZ(31,"input",28),t.qZA(),t.TgZ(32,"div",14),t._UZ(33,"br"),t.TgZ(34,"button",29),t.NdJ("click",function(){t.CHM(s);const e=t.oxw().$implicit,o=t.oxw();return t.KtG(o.verifyLabTest(e))}),t._uU(35,"Verify Results"),t.qZA()(),t.TgZ(36,"div",4),t._UZ(37,"br"),t.TgZ(38,"span",30),t._uU(39),t.qZA()()()}if(2&a){const s=t.oxw().$implicit;t.xp6(4),t.Q6J("ngIf","ACCEPTED"===(null==s?null:s.status)),t.xp6(1),t.Q6J("ngIf","VERIFIED"===(null==s?null:s.status)),t.xp6(1),t.Q6J("ngIf","COLLECTED"===(null==s?null:s.status)),t.xp6(4),t.Q6J("ngModel",s.range),t.xp6(2),t.Q6J("ngForOf",s.labTestType.labTestTypeRanges),t.xp6(4),t.Q6J("ngModel",s.level),t.xp6(11),t.Q6J("ngModel",s.unit),t.xp6(12),t.hij("Verified At | By: ",s.verified,"")}}function B(a,_){if(1&a){const s=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"div",4)(3,"h4")(4,"b"),t._uU(5),t.qZA()(),t.TgZ(6,"span"),t._uU(7,"Status: "),t.qZA(),t.TgZ(8,"span")(9,"small"),t._uU(10),t.qZA()(),t._UZ(11,"br")(12,"br"),t.TgZ(13,"span"),t._uU(14),t.YNc(15,E,2,0,"span",16),t.qZA(),t._UZ(16,"br")(17,"br"),t.TgZ(18,"small"),t._uU(19),t.qZA(),t._UZ(20,"br"),t.TgZ(21,"button",17),t.NdJ("click",function(){const o=t.CHM(s).$implicit,i=t.oxw();return t.KtG(i.acceptLabTest(o))}),t._uU(22,"Accept"),t.qZA(),t.TgZ(23,"button",17),t.NdJ("click",function(){const o=t.CHM(s).$implicit,i=t.oxw();return t.KtG(i.rejectLabTest(o))}),t._uU(24,"Reject"),t.qZA(),t.TgZ(25,"button",17),t.NdJ("click",function(){const o=t.CHM(s).$implicit,i=t.oxw();return t.KtG(i.collectLabTest(o))}),t._uU(26,"Collect"),t.qZA(),t.YNc(27,A,7,1,"div",16),t._UZ(28,"hr"),t.qZA(),t.TgZ(29,"div",4),t.YNc(30,O,40,8,"div",18),t.qZA()()()}if(2&a){const s=_.$implicit;t.xp6(5),t.Oqu(s.labTestType.name),t.xp6(5),t.Oqu(s.status),t.xp6(4),t.hij("Diagnosis: ",null==s||null==s.diagnosisType?null:s.diagnosisType.name," "),t.xp6(1),t.Q6J("ngIf",null===(null==s||null==s.diagnosisType?null:s.diagnosisType.name)),t.xp6(4),t.hij("Ordered At | By: ",null==s?null:s.created,""),t.xp6(8),t.Q6J("ngIf","REJECTED"===(null==s?null:s.status)),t.xp6(3),t.Q6J("ngIf","ACCEPTED"===(null==s?null:s.status)||"COLLECTED"===(null==s?null:s.status)||"VERIFIED"===(null==s?null:s.status))}}const g=Z.N.apiUrl;let w=(()=>{var a;class _{constructor(n,e,o,i,r,m){this.auth=n,this.http=e,this.modalService=o,this.spinner=i,this.router=r,this.msgBox=m,this.labTests=[],this.rs=[1,2,3.4,5,6],this.filterRecords=""}ngOnInit(){var n=this;return(0,c.Z)(function*(){n.id=localStorage.getItem("lab-test-patient-id"),localStorage.removeItem("lab-test-patient-id"),yield n.loadPatient(n.id),yield n.loadLabTestsByPatient(n.id)})()}loadPatient(n){var e=this;return(0,c.Z)(function*(){let o={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};e.spinner.show(),yield e.http.get(g+"/patients/get?id="+n,o).pipe((0,d.x)(()=>e.spinner.hide())).toPromise().then(i=>{e.id=i?.id,e.patient=i,console.log(i)}).catch(i=>{e.msgBox.showErrorMessage(i,"Could not load patient"),console.log(i)})})()}loadLabTestsByPatient(n){var e=this;return(0,c.Z)(function*(){let o={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};e.spinner.show(),yield e.http.get(g+"/patients/get_lab_tests_by_patient_id?id="+n,o).pipe((0,d.x)(()=>e.spinner.hide())).toPromise().then(i=>{e.labTests=i,console.log(e.labTests)}).catch(i=>{e.labTests=[],e.msgBox.showErrorMessage(i,"Could not load lab tests")})})()}acceptLabTest(n){var e=this;return(0,c.Z)(function*(){let o={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var i={id:n.id,result:n.result,range:n.range,level:n.level,unit:n.unit};e.spinner.show(),yield e.http.post(g+"/patients/accept_lab_test",i,o).pipe((0,d.x)(()=>e.spinner.hide())).toPromise().then(r=>{e.msgBox.showSuccessMessage("Status changed : ACCEPTED")}).catch(r=>{e.msgBox.showErrorMessage(r,"")}),e.loadLabTestsByPatient(e.id)})()}rejectLabTest(n){var e=this;return(0,c.Z)(function*(){let o={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var i={id:n.id,result:n.result,range:n.range,level:n.level,unit:n.unit};e.spinner.show(),yield e.http.post(g+"/patients/reject_lab_test",i,o).pipe((0,d.x)(()=>e.spinner.hide())).toPromise().then(r=>{e.msgBox.showSuccessMessage("Status changed : REJECTED")}).catch(r=>{e.msgBox.showErrorMessage(r,"")}),e.loadLabTestsByPatient(e.id)})()}holdLabTest(n){var e=this;return(0,c.Z)(function*(){let o={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var i={id:n.id,result:n.result,range:n.range,level:n.level,unit:n.unit};e.spinner.show(),yield e.http.post(g+"/patients/hold_lab_test",i,o).pipe((0,d.x)(()=>e.spinner.hide())).toPromise().then(r=>{e.msgBox.showSuccessMessage("Status changed : PENDING")}).catch(r=>{e.msgBox.showErrorMessage(r,"")}),e.loadLabTestsByPatient(e.id)})()}collectLabTest(n){var e=this;return(0,c.Z)(function*(){let o={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var i={id:n.id,result:n.result,range:n.range,level:n.level,unit:n.unit};e.spinner.show(),yield e.http.post(g+"/patients/collect_lab_test",i,o).pipe((0,d.x)(()=>e.spinner.hide())).toPromise().then(r=>{e.msgBox.showSuccessMessage("Status changed : COLLECTED")}).catch(r=>{e.msgBox.showErrorMessage(r,"")}),e.loadLabTestsByPatient(e.id)})()}verifyLabTest(n){var e=this;return(0,c.Z)(function*(){let o={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};var i={id:n.id,result:n.result,range:n.range,level:n.level,unit:n.unit};e.spinner.show(),yield e.http.post(g+"/patients/verify_lab_test",i,o).pipe((0,d.x)(()=>e.spinner.hide())).toPromise().then(r=>{e.msgBox.showSuccessMessage("Status changed : VERIFIED, Saved successifully")}).catch(r=>{e.msgBox.showErrorMessage(r,"")}),e.loadLabTestsByPatient(e.id)})()}saveReasonForRejection(n,e){var o=this;return(0,c.Z)(function*(){let i={headers:(new p.WM).set("Authorization","Bearer "+o.auth.user.access_token)};var r={id:n,rejectComment:e};o.spinner.show(),yield o.http.post(g+"/patients/lab_tests/save_reason_for_rejection",r,i).pipe((0,d.x)(()=>o.spinner.hide())).toPromise().then(m=>{o.msgBox.showSuccessMessage("Success")}).catch(m=>{o.msgBox.showErrorMessage(m,"")})})()}grant(n){var e=!1;return n.forEach(o=>{this.auth.checkPrivilege(o)&&(e=!0)}),e}}return(a=_).\u0275fac=function(n){return new(n||a)(t.Y36(C.e),t.Y36(p.eN),t.Y36(b.FF),t.Y36(M.t2),t.Y36(x.F0),t.Y36(f.l))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-lab-test"]],standalone:!0,features:[t.jDz],decls:36,vars:13,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],["routerLink","/lab-outpatient-list",1,"btn","btn-success",2,"margin-right","1mm"],["routerLink","/lab-inpatient-list",1,"btn","btn-success",2,"margin-right","1mm"],["routerLink","/lab-outsider-list",1,"btn","btn-success",2,"margin-right","1mm"],[1,"panel-body"],["role","alert",1,"col-sm-12","alert","alert-primary"],[1,"text-primary"],["class","col-sm-6",4,"ngFor","ngForOf"],[1,"col-sm-6"],[1,"row",2,"margin","1mm","background-color","rgb(246, 246, 248)"],[4,"ngIf"],[1,"btn","btn-default","btn-rounded",3,"click"],["class","row","style","padding-left: 3mm; padding-right: 3mm;",4,"ngIf"],["type","text","placeholder","Reason for rejection",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-info",3,"click"],[1,"row",2,"padding-left","3mm","padding-right","3mm"],["class","form-control","placeholder","Input Results","style","height: 5cm;","readonly","",3,"ngModel","ngModelChange",4,"ngIf"],["class","form-control","placeholder","Input Results","style","height: 5cm;",3,"ngModel","ngModelChange",4,"ngIf"],[1,"col-sm-4"],[1,"form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["type","text","placeholder","Unit",1,"form-control",3,"ngModel","ngModelChange"],["type","file",1,"form-control"],[1,"btn","btn-primary",3,"click"],[1,"label","label-info","m-r-15"],["placeholder","Input Results","readonly","",1,"form-control",2,"height","5cm",3,"ngModel","ngModelChange"],["placeholder","Input Results",1,"form-control",2,"height","5cm",3,"ngModel","ngModelChange"]],template:function(n,e){1&n&&(t.TgZ(0,"section",0)(1,"div",1)(2,"h1"),t._uU(3,"Lab Test"),t.qZA()()(),t.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"a",7),t._uU(10,"Outpatient List"),t.qZA(),t.TgZ(11,"a",8),t._uU(12,"Inpatient List"),t.qZA(),t.TgZ(13,"a",9),t._uU(14,"Outsider List"),t.qZA()(),t.TgZ(15,"div",10)(16,"div",3)(17,"div",11)(18,"h3",12),t._uU(19,"Name: "),t.TgZ(20,"b"),t._uU(21),t.qZA(),t._uU(22,", File No: "),t.TgZ(23,"b"),t._uU(24),t.qZA(),t._uU(25,", Date of birth: "),t.TgZ(26,"b"),t._uU(27),t.ALo(28,"date"),t.qZA(),t._uU(29,", Age: "),t.TgZ(30,"b"),t._uU(31),t.ALo(32,"age"),t.qZA(),t._uU(33),t.qZA()(),t._UZ(34,"hr"),t.qZA(),t.YNc(35,B,31,7,"div",13),t.qZA()()()()()),2&n&&(t.xp6(21),t.lnq("",e.patient.firstName," ",e.patient.middleName," ",e.patient.lastName,""),t.xp6(3),t.Oqu(e.patient.no),t.xp6(3),t.Oqu(t.lcZ(28,9,e.patient.dateOfBirth)),t.xp6(4),t.Oqu(t.lcZ(32,11,e.patient.dateOfBirth)),t.xp6(2),t.AsE(", ",e.patient.gender,", ",e.patient.paymentType,""),t.xp6(2),t.Q6J("ngForOf",e.labTests))},dependencies:[h.ez,h.sg,h.O5,h.uU,u.u5,u.YN,u.Kr,u.Fj,u.EJ,u.JJ,u.On,u.UX,v.C]}),_})()}}]);