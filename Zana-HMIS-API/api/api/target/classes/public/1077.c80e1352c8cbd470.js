"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[1077],{1077:(R,g,i)=>{i.r(g),i.d(g,{PharmacyMedicineStockStatusComponent:()=>k});var m=i(5861),M=i(6814),p=i(9862),r=i(95),f=i(4716),Z=i(4185),T=i(553),y=i(7069),e=i(6689),v=i(6466),E=i(1581),P=i(585),A=i(8237),U=i(379),O=i(2848);function D(s,_){if(1&s){const c=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"button",32),e.NdJ("click",function(){const o=e.CHM(c).$implicit,a=e.oxw();return e.KtG(a.setValues(o.id,o.medicine.code,o.medicine.name,o.stock))}),e._UZ(13,"i",33),e._uU(14," Change Stock"),e.qZA()()()}if(2&s){const c=_.$implicit;e.xp6(2),e.Oqu(null==c?null:c.sn),e.xp6(2),e.Oqu(null==c||null==c.medicine?null:c.medicine.code),e.xp6(2),e.Oqu(null==c||null==c.medicine?null:c.medicine.name),e.xp6(2),e.Oqu(null==c||null==c.medicine?null:c.medicine.category),e.xp6(2),e.Oqu(null==c?null:c.stock)}}var b=i(6236);const C=T.N.apiUrl;let k=(()=>{var s;class _{constructor(t,n,o,a,h,N,x){var d=this;this.auth=t,this.http=n,this.modalService=o,this.spinner=a,this.router=h,this.msgBox=N,this.data=x,this.id=null,this.pharmacyMedicineCode="",this.pharmacyMedicineName="",this.pharmacyMedicineStock=0,this.pharmacyName=localStorage.getItem("selected-pharmacy-name"),this.pharmacyMedicines=[],this.pharmacyMedicinesToShow=[],this.filterRecords="",this.category="ALL",this.print=(0,m.Z)(function*(){if(0===d.pharmacyMedicinesToShow.length)return void d.msgBox.showErrorMessage3("No data to print");d.documentHeader=yield d.data.getDocumentHeader();var S=[[{text:"SN",fontSize:9,fillColor:"#bdc6c7"},{text:"Code",fontSize:9,fillColor:"#bdc6c7"},{text:"Name",fontSize:9,fillColor:"#bdc6c7"},{text:"Category",fontSize:9,fillColor:"#bdc6c7"},{text:"Qty",fontSize:9,fillColor:"#bdc6c7"}]];d.pharmacyMedicinesToShow.forEach(l=>{var u=[{text:l?.sn.toString(),fontSize:7,fillColor:"#ffffff"},{text:l?.medicine?.code,fontSize:7,fillColor:"#ffffff"},{text:l?.medicine?.name,fontSize:7,fillColor:"#ffffff"},{text:l?.medicine?.category,fontSize:7,fillColor:"#ffffff"},{text:l?.stock.toString(),fontSize:7,fillColor:"#ffffff"}];S.push(u)});const L={header:"",footer:function(l,u){return l.toString()+" of "+u},content:[{columns:[d.documentHeader]},"  ",{text:"Pharmacy Stock Status Report",fontSize:14,bold:!0,alignment:"center"},d.data.getHorizontalLine()," ","Pharmacy Name: "+d.pharmacyName," ","Category: "+d.category,"  ",{table:{headerRows:1,widths:[40,80,200,80,70],body:S}}]};y.createPdf(L).print()}),window.pdfMake.vfs=b.pdfMake.vfs}ngOnInit(){var t=this;return(0,m.Z)(function*(){yield t.loadPharmacyMedicines()})()}loadPharmacyMedicines(){var t=this;return(0,m.Z)(function*(){let n={headers:(new p.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(C+"/pharmacies/get_pharmacy_medicine_list?pharmacy_name="+t.pharmacyName,n).pipe((0,f.x)(()=>t.spinner.hide())).toPromise().then(o=>{console.log(o),t.pharmacyMedicines=[],t.pharmacyMedicinesToShow=[],o?.forEach(h=>{t.pharmacyMedicines.push(h),t.pharmacyMedicinesToShow.push(h)});var a=1;t.pharmacyMedicinesToShow.forEach(h=>{h.sn=a,a+=1})}).catch(o=>{t.msgBox.showErrorMessage(o,""),console.log(o)})})()}filterByCategory(t){this.pharmacyMedicinesToShow=[],"ALL"===this.category?this.pharmacyMedicinesToShow=this.pharmacyMedicines:this.pharmacyMedicines.forEach(n=>{n.medicine.category===t&&this.pharmacyMedicinesToShow.push(n)})}setValues(t,n,o,a){this.id=t,this.pharmacyMedicineCode=n,this.pharmacyMedicineName=o,this.pharmacyMedicineStock=a}updateStock(){var t=this;return(0,m.Z)(function*(){let n={headers:(new p.WM).set("Authorization","Bearer "+t.auth.user.access_token)};var o={id:t.id,stock:t.pharmacyMedicineStock};t.spinner.show(),yield t.http.post(C+"/pharmacies/update_stock",o,n).pipe((0,f.x)(()=>t.spinner.hide())).toPromise().then(a=>{t.msgBox.showSuccessMessage("Updated successifully")}).catch(a=>{t.msgBox.showErrorMessage(a,""),console.log(a)}),yield t.loadPharmacyMedicines(),t.filterByCategory(t.category)})()}}return(s=_).\u0275fac=function(t){return new(t||s)(e.Y36(v.e),e.Y36(p.eN),e.Y36(E.FF),e.Y36(P.t2),e.Y36(A.F0),e.Y36(U.l),e.Y36(O.D))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-pharmacy-medicine-stock-status"]],standalone:!0,features:[e.jDz],decls:89,vars:11,consts:[[1,"content-header"],[1,"header-title"],[1,"text-primary"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],["type","button",1,"btn","btn-success","btn-outline",3,"click"],[1,"fa","fa-print"],[1,"panel-body"],[1,"col-sm-4"],[1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-responsive","table-striped","table-bordered"],[2,"font-style","bold"],[4,"ngFor","ngForOf"],["id","edit-qty-modal","tabindex","-1","role","dialog",1,"modal","fade","modal-success"],["role","document",1,"modal-dialog","modal-md"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-title"],[1,"modal-body"],["type","hidden",3,"ngModel","ngModelChange"],[1,"col-sm-8"],["type","text","readonly","",1,"form-control",3,"ngModel","ngModelChange"],["type","text",1,"form-control",2,"text-align","center",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-danger","pull-left"],["type","button","data-dismiss","modal",1,"btn","btn-success","pull-right",3,"click"],["type","button","data-toggle","modal","data-target","#edit-qty-modal",1,"btn","btn-success","btn-outline",3,"click"],[1,"glyphicon","glyphicon-pencil"]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Pharmacy - Stock Status ("),e.TgZ(4,"span",2),e._uU(5),e.qZA(),e._uU(6,")"),e.qZA()()(),e.TgZ(7,"section",3)(8,"div",4)(9,"div",5)(10,"div",6)(11,"div",7)(12,"button",8),e.NdJ("click",function(){return n.print()}),e._UZ(13,"i",9),e._uU(14," Print"),e.qZA()(),e.TgZ(15,"div",10)(16,"div",4)(17,"div",11)(18,"table")(19,"thead")(20,"tr")(21,"td"),e._uU(22,"Select Category"),e.qZA(),e.TgZ(23,"td")(24,"select",12),e.NdJ("ngModelChange",function(a){return n.category=a})("ngModelChange",function(a){return n.filterByCategory(a)}),e.TgZ(25,"option"),e._uU(26,"ALL"),e.qZA(),e.TgZ(27,"option"),e._uU(28,"MEDICINE"),e.qZA(),e.TgZ(29,"option"),e._uU(30,"PRODUCT"),e.qZA(),e.TgZ(31,"option"),e._uU(32,"EQUIPMENT"),e.qZA()()()()()()(),e._UZ(33,"div",11),e.TgZ(34,"div",11)(35,"input",13),e.NdJ("ngModelChange",function(a){return n.filterRecords=a}),e.qZA()()(),e._UZ(36,"br"),e.TgZ(37,"table",14)(38,"thead")(39,"tr",15)(40,"td"),e._uU(41,"SN"),e.qZA(),e.TgZ(42,"td"),e._uU(43,"Code"),e.qZA(),e.TgZ(44,"td"),e._uU(45,"Name"),e.qZA(),e.TgZ(46,"td"),e._uU(47,"Category"),e.qZA(),e.TgZ(48,"td"),e._uU(49,"Qty"),e.qZA(),e.TgZ(50,"td"),e._uU(51,"Action"),e.qZA()()(),e.TgZ(52,"tbody"),e.YNc(53,D,15,5,"tr",16),e.ALo(54,"searchFilter"),e.qZA()()()()()()(),e.TgZ(55,"div",17)(56,"div",18)(57,"div",19)(58,"div",20)(59,"button",21)(60,"span",22),e._uU(61,"\xd7"),e.qZA()(),e.TgZ(62,"h2",23),e._uU(63,"Update Stock"),e.qZA()(),e.TgZ(64,"div",24)(65,"div",4)(66,"input",25),e.NdJ("ngModelChange",function(a){return n.id=a}),e.qZA(),e.TgZ(67,"div",11)(68,"h4"),e._uU(69,"Code"),e.qZA()(),e.TgZ(70,"div",26)(71,"input",27),e.NdJ("ngModelChange",function(a){return n.pharmacyMedicineCode=a}),e.qZA()()(),e.TgZ(72,"div",4)(73,"div",11)(74,"h4"),e._uU(75,"Name"),e.qZA()(),e.TgZ(76,"div",26)(77,"input",27),e.NdJ("ngModelChange",function(a){return n.pharmacyMedicineName=a}),e.qZA()()(),e.TgZ(78,"div",4)(79,"div",11)(80,"h4"),e._uU(81,"Stock"),e.qZA()(),e.TgZ(82,"div",26)(83,"input",28),e.NdJ("ngModelChange",function(a){return n.pharmacyMedicineStock=a}),e.qZA()()()(),e.TgZ(84,"div",29)(85,"button",30),e._uU(86,"Close"),e.qZA(),e.TgZ(87,"button",31),e.NdJ("click",function(){return n.updateStock()}),e._uU(88,"Update"),e.qZA()()()()()),2&t&&(e.xp6(5),e.Oqu(n.pharmacyName),e.xp6(19),e.Q6J("ngModel",n.category),e.xp6(11),e.Q6J("ngModel",n.filterRecords),e.xp6(18),e.Q6J("ngForOf",e.xi3(54,8,n.pharmacyMedicinesToShow,n.filterRecords)),e.xp6(13),e.Q6J("ngModel",n.id),e.xp6(5),e.Q6J("ngModel",n.pharmacyMedicineCode),e.xp6(6),e.Q6J("ngModel",n.pharmacyMedicineName),e.xp6(6),e.Q6J("ngModel",n.pharmacyMedicineStock))},dependencies:[M.ez,M.sg,r.u5,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.On,r.UX,Z.G]}),_})()}}]);