"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[3495],{3495:(N,g,c)=>{c.r(g),c.d(g,{SelectStoreComponent:()=>x});var _=c(5861),d=c(6814),m=c(9862),i=c(95),p=c(4716),h=c(553),e=c(6689),u=c(6466),f=c(585),v=c(379);function I(n,a){1&n&&e._UZ(0,"div",12)}function C(n,a){if(1&n&&(e.TgZ(0,"div")(1,"div",4)(2,"h4"),e._uU(3),e.qZA(),e._UZ(4,"br")(5,"br"),e.TgZ(6,"h5"),e._uU(7,"To switch store, please log in afresh"),e.qZA()()()),2&n){const s=e.oxw();e.xp6(3),e.hij("Selected Store: ",s.selectedStoreName,"")}}function E(n,a){if(1&n&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&n){const s=a.$implicit;e.xp6(1),e.Oqu(s.name)}}function Z(n,a){if(1&n){const s=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.selectStore(t.storeName))}),e._uU(1,"Select"),e.qZA()}}function T(n,a){if(1&n){const s=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.clear())}),e._uU(1,"Cancel"),e.qZA()}}function M(n,a){if(1&n){const s=e.EpF();e.TgZ(0,"div")(1,"div",4)(2,"h2",13),e._uU(3,"Please Select Store"),e.qZA(),e.TgZ(4,"select",14),e.NdJ("ngModelChange",function(t){e.CHM(s);const l=e.oxw();return e.KtG(l.storeName=t)}),e._UZ(5,"option"),e.YNc(6,E,2,1,"option",15),e.qZA(),e._UZ(7,"hr"),e.qZA(),e.TgZ(8,"div",16),e.YNc(9,Z,2,0,"button",17),e.qZA(),e.TgZ(10,"div",16),e.YNc(11,T,2,0,"button",18),e.qZA()()}if(2&n){const s=e.oxw();e.xp6(4),e.Q6J("ngModel",s.storeName),e.xp6(2),e.Q6J("ngForOf",s.stores),e.xp6(3),e.Q6J("ngIf",""!=s.storeName),e.xp6(2),e.Q6J("ngIf",""!=s.storeName)}}const S=h.N.apiUrl;let x=(()=>{var n;class a{constructor(o,t,l,r){this.auth=o,this.http=t,this.spinner=l,this.msgBox=r,this.stores=[],this.storeName="",this.selectedStoreCode="",this.selectedStoreName="",this.filterRecords=""}ngOnInit(){var o=this;return(0,_.Z)(function*(){null!=localStorage.getItem("selected-store-id")&&(o.selectedStoreId=localStorage.getItem("selected-store-id")),null!=localStorage.getItem("selected-store-code")&&(o.selectedStoreCode=localStorage.getItem("selected-store-code").toString()),null!=localStorage.getItem("selected-store-name")&&(o.selectedStoreName=localStorage.getItem("selected-store-name").toString()),o.loadStores()})()}loadStores(){var o=this;return(0,_.Z)(function*(){o.stores=[];let t={headers:(new m.WM).set("Authorization","Bearer "+o.auth.user.access_token)};o.spinner.show(),yield o.http.get(S+"/stores",t).pipe((0,p.x)(()=>o.spinner.hide())).toPromise().then(l=>{l?.forEach(r=>{o.stores.push(r)})}).catch(l=>{o.msgBox.showErrorMessage(l,"Could not load stores")})})()}clear(){this.storeName=""}selectStore(o){var t=this;return(0,_.Z)(function*(){let l={headers:(new m.WM).set("Authorization","Bearer "+t.auth.user.access_token)};localStorage.removeItem("selected-store-id"),localStorage.removeItem("selected-store-code"),localStorage.removeItem("selected-store-name"),t.spinner.show(),yield t.http.get(S+"/stores/get_by_name?name="+o,l).pipe((0,p.x)(()=>t.spinner.hide())).toPromise().then(r=>{localStorage.setItem("selected-store-id",r?.id),localStorage.setItem("selected-store-code",r.code),localStorage.setItem("selected-store-name",r.name),t.selectedStoreId=r?.id,t.selectedStoreCode=r.code,t.selectedStoreName=r.name}).catch(r=>{localStorage.setItem("selected-store-id",t.selectedStoreId),localStorage.setItem("selected-store-code",t.selectedStoreCode),localStorage.setItem("selected-store-name",t.selectedStoreName),t.msgBox.showErrorMessage(r,""),console.log(r)})})()}grant(o){var t=!1;return o.forEach(l=>{this.auth.checkPrivilege(l)&&(t=!0)}),t}}return(n=a).\u0275fac=function(o){return new(o||n)(e.Y36(u.e),e.Y36(m.eN),e.Y36(f.t2),e.Y36(v.l))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-select-store"]],standalone:!0,features:[e.jDz],decls:18,vars:4,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],["class","panel-heading",4,"ngIf"],[1,"panel-body"],[1,"row",2,"margin-top","5%"],[1,"col-sm-3"],[1,"col-sm-6","jumbotron"],[4,"ngIf"],[1,"panel-heading"],[1,"text-primary"],[1,"form-control",2,"font-size","x-large","height","2cm",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"col-xs-6"],["class","btn btn-primary form-control",3,"click",4,"ngIf"],["class","btn btn-default form-control",3,"click",4,"ngIf"],[1,"btn","btn-primary","form-control",3,"click"],[1,"btn","btn-default","form-control",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5),e.YNc(8,I,1,0,"div",6),e.TgZ(9,"div",7)(10,"section",2)(11,"div",8),e._UZ(12,"div",9),e.TgZ(13,"div",10)(14,"div",3),e.YNc(15,C,8,1,"div",11),e.YNc(16,M,12,4,"div",11),e.qZA()(),e._UZ(17,"div",9),e.qZA()()()()()()()),2&o&&(e.xp6(3),e.hij("Store - ",t.selectedStoreName,""),e.xp6(5),e.Q6J("ngIf",""!=t.selectedStoreName),e.xp6(7),e.Q6J("ngIf",""!=t.selectedStoreName),e.xp6(1),e.Q6J("ngIf",""===t.selectedStoreName))},dependencies:[d.ez,d.sg,d.O5,i.u5,i.YN,i.Kr,i.EJ,i.JJ,i.On,i.UX]}),a})()}}]);