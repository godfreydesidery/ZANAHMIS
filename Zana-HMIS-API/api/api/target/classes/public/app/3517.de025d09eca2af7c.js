"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[3517],{3517:(R,h,s)=>{s.r(h),s.d(h,{ReferralPlanComponent:()=>N});var d=s(5861),p=s(6814),u=s(9862),m=s(95),_=s(4716),f=s(4512),v=s(553),e=s(6689),M=s(6466),P=s(585),Z=s(379);function x(l,c){if(1&l&&(e.TgZ(0,"div",14)(1,"h3",15),e._uU(2,"Name: "),e.TgZ(3,"b"),e._uU(4),e.qZA(),e._uU(5,", File No: "),e.TgZ(6,"b"),e._uU(7),e.qZA(),e._uU(8,", "),e.TgZ(9,"b"),e._uU(10),e.ALo(11,"date"),e.ALo(12,"age"),e.qZA(),e._uU(13),e.qZA()()),2&l){const o=e.oxw();e.xp6(4),e.lnq("",null==o.admission||null==o.admission.patient?null:o.admission.patient.firstName," ",null==o.admission||null==o.admission.patient?null:o.admission.patient.middleName," ",null==o.admission||null==o.admission.patient?null:o.admission.patient.lastName,""),e.xp6(3),e.Oqu(null==o.admission||null==o.admission.patient?null:o.admission.patient.no),e.xp6(3),e.AsE("Date of Birth: ",e.lcZ(11,9,o.admission.patient.dateOfBirth)," Age: ",e.lcZ(12,11,o.admission.patient.dateOfBirth),""),e.xp6(3),e.lnq(", ",null==o.admission||null==o.admission.patient?null:o.admission.patient.gender,", ",o.admission.paymentType," ",null==o.admission||null==o.admission.insurancePlan?null:o.admission.insurancePlan.name,"")}}function A(l,c){if(1&l&&(e.TgZ(0,"div",14)(1,"h3",15),e._uU(2,"Name: "),e.TgZ(3,"b"),e._uU(4),e.qZA(),e._uU(5,", File No: "),e.TgZ(6,"b"),e._uU(7),e.qZA(),e._uU(8,", "),e.TgZ(9,"b"),e._uU(10),e.ALo(11,"date"),e.ALo(12,"age"),e.qZA(),e._uU(13),e.qZA()()),2&l){const o=e.oxw();e.xp6(4),e.lnq("",null==o.consultation||null==o.consultation.patient?null:o.consultation.patient.firstName," ",null==o.consultation||null==o.consultation.patient?null:o.consultation.patient.middleName," ",null==o.consultation||null==o.consultation.patient?null:o.consultation.patient.lastName,""),e.xp6(3),e.Oqu(null==o.consultation||null==o.consultation.patient?null:o.consultation.patient.no),e.xp6(3),e.AsE("Date of Birth: ",e.lcZ(11,9,o.consultation.patient.dateOfBirth)," Age: ",e.lcZ(12,11,o.consultation.patient.dateOfBirth),""),e.xp6(3),e.lnq(", ",null==o.consultation||null==o.consultation.patient?null:o.consultation.patient.gender,", ",o.consultation.paymentType," ",null==o.consultation||null==o.consultation.insurancePlan?null:o.consultation.insurancePlan.name,"")}}function C(l,c){if(1&l){const o=e.EpF();e.TgZ(0,"option",18),e.NdJ("click",function(){const a=e.CHM(o).$implicit,i=e.oxw(2);return e.KtG(i.getProvider(a.id))}),e._uU(1),e.qZA()}if(2&l){const o=c.$implicit;e.xp6(1),e.Oqu(o.name)}}function T(l,c){if(1&l&&(e.TgZ(0,"div",3)(1,"div",4)(2,"select",16),e.YNc(3,C,2,1,"option",17),e.qZA()()()),2&l){const o=e.oxw();e.xp6(3),e.Q6J("ngForOf",o.externalMedicalProviders)}}const g=v.N.apiUrl;let N=(()=>{var l;class c{constructor(n,t,a,i){this.auth=n,this.http=t,this.spinner=a,this.msgBox=i,this.id=null,this.referringDiagnosis="",this.history="",this.investigation="",this.management="",this.operationNote="",this.icuAdmissionNote="",this.generalRecommendation="",this.admissionId=null,this.consultationId=null,this.externalMedicalProviderId=null,this.externalMedicalProviderName="",this.externalMedicalProviders=[]}ngOnInit(){var n=this;return(0,d.Z)(function*(){n.admissionId=localStorage.getItem("admission-id"),n.consultationId=localStorage.getItem("consultation-id"),localStorage.removeItem("admission-id"),localStorage.removeItem("consultation-id"),null!=n.admissionId?(n.consultationId=null,yield n.loadAdmission(n.admissionId),yield n.loadReferralPlan(n.admissionId,0)):(n.admissionId=null,yield n.loadConsultation(n.consultationId),yield n.loadReferralPlan(0,n.consultationId))})()}getProvider(n){var t=this;return(0,d.Z)(function*(){t.externalMedicalProviderName="",t.externalMedicalProviderId=null;let a={headers:(new u.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(g+"/external_medical_providers/get?id="+n,a).pipe((0,_.x)(()=>t.spinner.hide())).toPromise().then(i=>{t.externalMedicalProvider=i,t.externalMedicalProviderId=i.id,t.externalMedicalProviderName=i.name,console.log(i),t.externalMedicalProviders=[]}).catch(i=>{t.msgBox.showErrorMessage(i,""),console.log(i)})})()}loadAdmission(n){var t=this;return(0,d.Z)(function*(){let a={headers:(new u.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(g+"/patients/load_admission?id="+n,a).pipe((0,_.x)(()=>t.spinner.hide())).toPromise().then(i=>{t.admission=i,console.log(i)}).catch(i=>{t.msgBox.showErrorMessage(i,"Could not load admission"),console.log(i)})})()}loadConsultation(n){var t=this;return(0,d.Z)(function*(){let a={headers:(new u.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(g+"/patients/load_consultation?id="+n,a).pipe((0,_.x)(()=>t.spinner.hide())).toPromise().then(i=>{t.consultation=i,console.log(i)}).catch(i=>{t.msgBox.showErrorMessage(i,"Could not load consultation"),console.log(i)})})()}loadReferralPlan(n,t){var a=this;return(0,d.Z)(function*(){let i={headers:(new u.WM).set("Authorization","Bearer "+a.auth.user.access_token)};a.spinner.show(),yield a.http.get(g+"/patients/load_referral_plan?admission_id="+n+"&consultation_id="+t,i).pipe((0,_.x)(()=>a.spinner.hide())).toPromise().then(r=>{a.referralPlan=r,a.id=r.id,a.referringDiagnosis=r.referringDiagnosis,a.history=r.history,a.investigation=r.investigation,a.management=r.management,a.operationNote=r.operationNote,a.icuAdmissionNote=r.icuAdmissionNote,a.generalRecommendation=r.generalRecommendation,a.externalMedicalProvider=r.externalMedicalProvider,a.externalMedicalProviderId=r.externalMedicalProvider.id,a.externalMedicalProviderName=r.externalMedicalProvider.name,console.log(r)}).catch(r=>{console.log(r)})})()}saveReferralPlan(){var n=this;return(0,d.Z)(function*(){let t={headers:(new u.WM).set("Authorization","Bearer "+n.auth.user.access_token)};if(""!==n.history&&""!==n.investigation&&""!==n.management){if(null===n.id&&!window.confirm("Confirm submitting discharge plan. Confirm?"))return n.id=null,n.referringDiagnosis="",n.history="",n.investigation="",n.management="",n.operationNote="",n.icuAdmissionNote="",void(n.generalRecommendation="");var a={referringDiagnosis:n.referringDiagnosis,history:n.history,investigation:n.investigation,management:n.management,operationNote:n.operationNote,icuAdmissionNote:n.icuAdmissionNote,generalRecommendation:n.generalRecommendation,admission:{id:n.admissionId},consultation:{id:n.consultationId},externalMedicalProvider:{id:n.externalMedicalProviderId}};n.spinner.show(),yield n.http.post(g+"/patients/save_referral_plan",a,t).pipe((0,_.x)(()=>n.spinner.hide())).toPromise().then(i=>{n.referralPlan=i,n.id=i.id,n.referringDiagnosis=i.referringDiagnosis,n.history=i.history,n.investigation=i.investigation,n.management=i.management,n.operationNote=i.operationNote,n.icuAdmissionNote=i.icuAdmissionNote,n.generalRecommendation=i.generalRecommendation,n.externalMedicalProvider=i.externalMedicalProvider,console.log(i),n.msgBox.showSuccessMessage("Saved successifully")}).catch(i=>{n.msgBox.showErrorMessage(i,""),console.log(i)})}else n.msgBox.showErrorMessage3("The fields marked with * are required fields")})()}loadProvidersLike(n){var t=this;return(0,d.Z)(function*(){if(t.externalMedicalProviders=[],n.length<3)return;let a={headers:(new u.WM).set("Authorization","Bearer "+t.auth.user.access_token)};yield t.http.get(g+"/external_medical_providers/load_external_medical_providers_like?name_like="+n,a).toPromise().then(i=>{console.log(i),t.externalMedicalProviders=i}).catch(i=>{t.msgBox.showErrorMessage(i,"")})})()}}return(l=c).\u0275fac=function(n){return new(n||l)(e.Y36(M.e),e.Y36(u.eN),e.Y36(P.t2),e.Y36(Z.l))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-referral-plan"]],standalone:!0,features:[e.jDz],decls:57,vars:11,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"btn-group"],[1,"panel-body"],["class","col-sm-12 alert alert-primary","role","alert",4,"ngIf"],[1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Search...",1,"form-control",3,"ngModel","ngModelChange"],["class","row",4,"ngIf"],[1,"btn","btn-primary","pull-right",3,"click"],["role","alert",1,"col-sm-12","alert","alert-primary"],[1,"text-primary"],["multiple","multiple",1,"form-control"],["style","height: 1cm; cursor: pointer; font-size: large;",3,"click",4,"ngFor","ngForOf"],[2,"height","1cm","cursor","pointer","font-size","large",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Referral Plan"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"div",7),e.qZA(),e.TgZ(10,"div",8)(11,"div",3),e.YNc(12,x,14,13,"div",9),e.YNc(13,A,14,13,"div",9),e.TgZ(14,"div",4)(15,"div")(16,"h4"),e._uU(17,"Referring Diagnosis*"),e.qZA()(),e.TgZ(18,"textarea",10),e.NdJ("ngModelChange",function(i){return t.referringDiagnosis=i}),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"div")(21,"h4"),e._uU(22,"Select Medical Provider/Hospital*"),e.qZA()(),e.TgZ(23,"input",11),e.NdJ("ngModelChange",function(i){return t.externalMedicalProviderName=i})("ngModelChange",function(i){return t.loadProvidersLike(i)}),e.qZA(),e.YNc(24,T,4,1,"div",12),e.TgZ(25,"div")(26,"h4"),e._uU(27,"Brief History and Patient's Examination*"),e.qZA()(),e.TgZ(28,"textarea",10),e.NdJ("ngModelChange",function(i){return t.history=i}),e.qZA(),e._UZ(29,"br"),e.TgZ(30,"div")(31,"h4"),e._uU(32,"Investigation Done*"),e.qZA()(),e.TgZ(33,"textarea",10),e.NdJ("ngModelChange",function(i){return t.investigation=i}),e.qZA(),e._UZ(34,"br"),e.TgZ(35,"div")(36,"h4"),e._uU(37,"Inpatient Management*"),e.qZA()(),e.TgZ(38,"textarea",10),e.NdJ("ngModelChange",function(i){return t.management=i}),e.qZA(),e._UZ(39,"br"),e.TgZ(40,"div")(41,"h4"),e._uU(42,"Operation Done Note(If not, leave it empty)"),e.qZA()(),e.TgZ(43,"textarea",10),e.NdJ("ngModelChange",function(i){return t.operationNote=i}),e.qZA(),e._UZ(44,"br"),e.TgZ(45,"div")(46,"h4"),e._uU(47,"ICU Admission Note(If not, leave it empty)"),e.qZA()(),e.TgZ(48,"textarea",10),e.NdJ("ngModelChange",function(i){return t.icuAdmissionNote=i}),e.qZA(),e._UZ(49,"br"),e.TgZ(50,"div")(51,"h4"),e._uU(52,"General Recommendation and condition at discharge"),e.qZA()(),e.TgZ(53,"textarea",10),e.NdJ("ngModelChange",function(i){return t.generalRecommendation=i}),e.qZA(),e._UZ(54,"br"),e.TgZ(55,"button",13),e.NdJ("click",function(){return t.saveReferralPlan()}),e._uU(56,"Save"),e.qZA()()()()()()()()),2&n&&(e.xp6(12),e.Q6J("ngIf",null!=t.admission),e.xp6(1),e.Q6J("ngIf",null!=t.consultation),e.xp6(5),e.Q6J("ngModel",t.referringDiagnosis),e.xp6(5),e.Q6J("ngModel",t.externalMedicalProviderName),e.xp6(1),e.Q6J("ngIf",t.externalMedicalProviders.length>0),e.xp6(4),e.Q6J("ngModel",t.history),e.xp6(5),e.Q6J("ngModel",t.investigation),e.xp6(5),e.Q6J("ngModel",t.management),e.xp6(5),e.Q6J("ngModel",t.operationNote),e.xp6(5),e.Q6J("ngModel",t.icuAdmissionNote),e.xp6(5),e.Q6J("ngModel",t.generalRecommendation))},dependencies:[p.ez,p.sg,p.O5,p.uU,m.u5,m.YN,m.Kr,m.Fj,m.JJ,m.On,m.UX,f.C]}),c})()}}]);