"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[3514],{3514:(O,v,o)=>{o.r(v),o.d(v,{RegistrationPriceComponent:()=>A});var h=o(5861),g=o(6814),p=o(9862),l=o(95),P=o(4716),C=o(553),n=o(6689),E=o(6466),I=o(7140),M=o(585),f=o(379);function T(a,_){if(1&a){const t=n.EpF();n.TgZ(0,"span"),n._uU(1,"COVERED "),n.TgZ(2,"button",17),n.NdJ("click",function(){n.CHM(t);const e=n.oxw(3);return n.KtG(e.changeRegistrationCoverage(e.insurancePlanId,!1))}),n._uU(3,"Change"),n.qZA()()}}function Z(a,_){if(1&a){const t=n.EpF();n.TgZ(0,"span"),n._uU(1,"NOT COVERED "),n.TgZ(2,"button",17),n.NdJ("click",function(){n.CHM(t);const e=n.oxw(3);return n.KtG(e.changeRegistrationCoverage(e.insurancePlanId,!0))}),n._uU(3,"Change"),n.qZA()()}}function R(a,_){if(1&a&&(n.TgZ(0,"div"),n.YNc(1,T,4,0,"span",16),n.YNc(2,Z,4,0,"span",16),n.qZA()),2&a){const t=n.oxw().$implicit;n.xp6(1),n.Q6J("ngIf",!0===(null==t||null==t.registrationInsurancePlan?null:t.registrationInsurancePlan.covered)),n.xp6(1),n.Q6J("ngIf",!1===(null==t||null==t.registrationInsurancePlan?null:t.registrationInsurancePlan.covered))}}function x(a,_){if(1&a){const t=n.EpF();n.TgZ(0,"tr")(1,"td",12),n._uU(2),n.ALo(3,"currency"),n.qZA(),n.TgZ(4,"td")(5,"input",13),n.NdJ("ngModelChange",function(e){const s=n.CHM(t).$implicit;return n.KtG(s.price=e)}),n.qZA()(),n.TgZ(6,"td")(7,"button",14),n.NdJ("click",function(){const r=n.CHM(t).$implicit,s=n.oxw();return n.KtG(s.updateRegistrationPriceByInsurance(s.insurancePlanId,r.price))}),n._UZ(8,"i",15),n._uU(9,"Save"),n.qZA()(),n.TgZ(10,"td"),n.YNc(11,R,3,2,"div",16),n.qZA()()}if(2&a){const t=_.$implicit;n.xp6(2),n.Oqu(n.Dn7(3,3,t.price,"","")),n.xp6(3),n.Q6J("ngModel",t.price),n.xp6(6),n.Q6J("ngIf",null!=(null==t||null==t.registrationInsurancePlan?null:t.registrationInsurancePlan.covered))}}const m=C.N.apiUrl;let A=(()=>{var a;class _{constructor(i,e,r,s,u){this.auth=i,this.http=e,this.modalService=r,this.spinner=s,this.msgBox=u,this.insurancePlanId=null,this.insurancePlanName="",this.clinics=[],this.registrationPrices=[]}ngOnInit(){this.insurancePlanId=localStorage.getItem("insurance_plan_id"),this.insurancePlanName=localStorage.getItem("insurance_plan_name"),localStorage.removeItem("insurance_plan_id"),localStorage.removeItem("insurance_plan_name"),this.loadRegistrationsByInsurance(this.insurancePlanId)}loadRegistrationsByInsurance(i){var e=this;return(0,h.Z)(function*(){e.clinics=[];let r={headers:(new p.WM).set("Authorization","Bearer "+e.auth.user.access_token)};e.spinner.show(),yield e.http.get(m+"/insurance_plans/get_registration_prices?insurance_plan_id="+i,r).pipe((0,P.x)(()=>e.spinner.hide())).toPromise().then(s=>{e.registrationPrices=s}).catch(s=>{e.msgBox.showErrorMessage(s,"Could not load registration plans")})})()}changeRegistrationCoverage(i,e){var r=this;return(0,h.Z)(function*(){let s={headers:(new p.WM).set("Authorization","Bearer "+r.auth.user.access_token)};var u={registrationInsurancePlan:{insurancePlan:{id:i},covered:e}};r.spinner.show(),yield r.http.post(m+"/insurance_plans/change_registration_coverage",u,s).pipe((0,P.x)(()=>r.spinner.hide())).toPromise().then(c=>{r.registrationPrices.forEach(d=>{d.registrationInsurancePlan.covered=c.registrationInsurancePlan.covered})}).catch(c=>{r.msgBox.showErrorMessage(c,"Could not change coverage")})})()}updateRegistrationPriceByInsurance(i,e){var r=this;return(0,h.Z)(function*(){let s={headers:(new p.WM).set("Authorization","Bearer "+r.auth.user.access_token)};var u={registrationInsurancePlan:{insurancePlan:{id:i}},price:e};r.spinner.show(),yield r.http.post(m+"/insurance_plans/update_registration_price_by_insurance",u,s).pipe((0,P.x)(()=>r.spinner.hide())).toPromise().then(c=>{r.registrationPrices.forEach(d=>{d.price=c.price,d.covered=c.covered}),r.msgBox.showSuccessMessage("Price updated successifully")}).catch(c=>{r.msgBox.showErrorMessage(c,"Could not update price")})})()}}return(a=_).\u0275fac=function(i){return new(i||a)(n.Y36(E.e),n.Y36(p.eN),n.Y36(I.FF),n.Y36(M.t2),n.Y36(f.l))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-registration-price"]],standalone:!0,features:[n.jDz],decls:26,vars:2,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"text-primary"],[1,"panel-body"],[1,"col-sm-12",2,"overflow","scroll"],[1,"table","table-bordered","table-small"],[4,"ngFor","ngForOf"],[2,"text-align","right"],["type","text",1,"form-control",2,"text-align","center",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],[1,"glyphicon","glyphicon-floppy-disk"],[4,"ngIf"],[3,"click"]],template:function(i,e){1&i&&(n.TgZ(0,"section",0)(1,"div",1)(2,"h1"),n._uU(3,"Registration Prices"),n.qZA()()(),n.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h4",7),n._uU(10),n.qZA()(),n.TgZ(11,"div",8)(12,"div",9)(13,"table",10)(14,"thead")(15,"tr")(16,"td"),n._uU(17,"Price"),n.qZA(),n.TgZ(18,"td"),n._uU(19,"Edit Price"),n.qZA(),n.TgZ(20,"td"),n._uU(21,"Action"),n.qZA(),n.TgZ(22,"td"),n._uU(23,"Coverage"),n.qZA()()(),n.TgZ(24,"tbody"),n.YNc(25,x,12,7,"tr",11),n.qZA()()()()()()()()),2&i&&(n.xp6(10),n.hij("Package: ",e.insurancePlanName,""),n.xp6(15),n.Q6J("ngForOf",e.registrationPrices))},dependencies:[g.ez,g.sg,g.O5,g.H9,l.u5,l.Fj,l.JJ,l.On,l.UX]}),_})()}}]);