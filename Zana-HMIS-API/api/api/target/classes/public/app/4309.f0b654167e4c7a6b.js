"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[4309],{4309:(A,p,r)=>{r.r(p),r.d(p,{ConsumableComponent:()=>Z});var m=r(5861),h=r(6814),d=r(9862),a=r(95),u=r(4716),g=r(4185),C=r(553),e=r(6689),M=r(6466),f=r(585),b=r(379);function v(i,c){if(1&i){const l=e.EpF();e.TgZ(0,"option",21),e.NdJ("click",function(){const s=e.CHM(l).$implicit,o=e.oxw(2);return e.KtG(o.getMedicine(s.id))}),e._uU(1),e.qZA()}if(2&i){const l=c.$implicit;e.xp6(1),e.Oqu(l.name)}}function E(i,c){if(1&i&&(e.TgZ(0,"div",3)(1,"div",4)(2,"select",19),e.YNc(3,v,2,1,"option",20),e.qZA()()()),2&i){const l=e.oxw();e.xp6(3),e.Q6J("ngForOf",l.medicines)}}function T(i,c){if(1&i){const l=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"a",13),e.NdJ("click",function(){const s=e.CHM(l).$implicit,o=e.oxw();return e.KtG(o.deleteConsumable(s.id))}),e._UZ(5,"i",22),e._uU(6,"Delete"),e.qZA()()()}if(2&i){const l=c.$implicit;e.xp6(2),e.Oqu(null==l||null==l.medicine?null:l.medicine.name)}}const _=C.N.apiUrl;let Z=(()=>{var i;class c{constructor(t,n,s,o){this.auth=t,this.http=n,this.spinner=s,this.msgBox=o,this.id=null,this.filterRecords="",this.consumables=[],this.medicineId=null,this.medicineCode="",this.medicineName="",this.medicines=[]}ngOnInit(){this.loadConsumables()}addConsumable(){var t=this;return(0,m.Z)(function*(){let n={headers:(new d.WM).set("Authorization","Bearer "+t.auth.user.access_token)};var s={medicine:{id:t.medicineId}};t.spinner.show(),yield t.http.post(_+"/consumables/add",s,n).pipe((0,u.x)(()=>t.spinner.hide())).toPromise().then(o=>{t.id=o?.id,t.medicineId=o?.medicine?.id,t.msgBox.showSuccessMessage("Consumable created successifully"),t.loadConsumables()}).catch(o=>{t.msgBox.showErrorMessage(o,"Could not create consumable")}),t.clear()})()}loadConsumables(){var t=this;return(0,m.Z)(function*(){t.consumables=[];let n={headers:(new d.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(_+"/consumables",n).pipe((0,u.x)(()=>t.spinner.hide())).toPromise().then(s=>{s?.forEach(o=>{t.consumables.push(o)})}).catch(s=>{t.msgBox.showErrorMessage(s,"Could not load consumables")})})()}clear(){this.id=null,this.medicineId=null,this.medicineName="",this.medicineCode=""}deleteConsumable(t){var n=this;return(0,m.Z)(function*(){let s={headers:(new d.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.post(_+"/consumables/delete?id="+t,null,s).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(o=>{n.msgBox.showSuccessMessage("Deleted"),n.loadConsumables()}).catch(o=>{n.msgBox.showErrorMessage(o,"")})})()}grant(t){var n=!1;return t.forEach(s=>{this.auth.checkPrivilege(s)&&(n=!0)}),n}loadMedicinesLike(t){var n=this;return(0,m.Z)(function*(){if(n.medicines=[],t.length<2)return;let s={headers:(new d.WM).set("Authorization","Bearer "+n.auth.user.access_token)};yield n.http.get(_+"/medicines/load_medicines_like?name_like="+t,s).toPromise().then(o=>{console.log(o),n.medicines=o}).catch(o=>{n.msgBox.showErrorMessage(o,"")})})()}getMedicine(t){var n=this;return(0,m.Z)(function*(){let s={headers:(new d.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.medicines=[],n.spinner.show(),yield n.http.get(_+"/medicines/get?id="+t,s).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(o=>{n.medicineId=o?.id,n.medicineCode=o.code,n.medicineName=o.name}).catch(o=>{n.msgBox.showErrorMessage(o,""),console.log(o)})})()}}return(i=c).\u0275fac=function(t){return new(t||i)(e.Y36(M.e),e.Y36(d.eN),e.Y36(f.t2),e.Y36(b.l))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-consumable"]],standalone:!0,features:[e.jDz],decls:32,vars:7,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"panel-body"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"col-sm-3"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["class","row",4,"ngIf"],[1,"col-sm-1"],[3,"click"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-bordered","table-small"],[2,"font-weight","bold"],[4,"ngFor","ngForOf"],["multiple","multiple",1,"form-control"],["style","height: 1cm; cursor: pointer; font-size: large;",3,"click",4,"ngFor","ngForOf"],[2,"height","1cm","cursor","pointer","font-size","large",3,"click"],[1,"glyphicon","glyphicon-pencil"]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Consumable"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5),e._UZ(8,"div",6),e.TgZ(9,"div",7)(10,"div",8)(11,"div",3)(12,"div",9)(13,"input",10),e.NdJ("ngModelChange",function(o){return n.medicineName=o})("ngModelChange",function(o){return n.loadMedicinesLike(o)}),e.qZA(),e.YNc(14,E,4,1,"div",11),e.qZA(),e.TgZ(15,"div",12)(16,"button",13),e.NdJ("click",function(){return n.addConsumable()}),e._uU(17,"Add"),e.qZA()(),e._UZ(18,"div",14),e.TgZ(19,"div",14)(20,"input",15),e.NdJ("ngModelChange",function(o){return n.filterRecords=o}),e.qZA()()(),e._UZ(21,"br"),e.TgZ(22,"table",16)(23,"thead")(24,"tr",17)(25,"td"),e._uU(26,"Consumable Procedure Type"),e.qZA(),e.TgZ(27,"td"),e._uU(28,"Action"),e.qZA()()(),e.TgZ(29,"tbody"),e.YNc(30,T,7,1,"tr",18),e.ALo(31,"searchFilter"),e.qZA()()()()()()()()),2&t&&(e.xp6(13),e.Q6J("ngModel",n.medicineName),e.xp6(1),e.Q6J("ngIf",n.medicines.length>0),e.xp6(6),e.Q6J("ngModel",n.filterRecords),e.xp6(10),e.Q6J("ngForOf",e.xi3(31,4,n.consumables,n.filterRecords)))},dependencies:[h.ez,h.sg,h.O5,a.u5,a.YN,a.Kr,a.Fj,a.JJ,a.On,a.UX,g.G]}),c})()}}]);