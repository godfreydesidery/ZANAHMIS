"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[4640],{4640:(D,h,l)=>{l.r(h),l.d(h,{UserProfileComponent:()=>O});var _=l(5861),m=l(6814),c=l(9862),d=l(95),f=l(8237),u=l(4716),U=l(4185),Z=l(553),e=l(6689),C=l(6466),M=l(585),v=l(379);function T(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.clearFields())})("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.unlockInputs())}),e._UZ(1,"i",40),e._uU(2,"New"),e.qZA()}}function b(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.unlockInputs())}),e._UZ(1,"i",42),e._uU(2,"Edit"),e.qZA()}}function N(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.deleteUser())}),e._UZ(1,"i",44),e._uU(2,"Delete"),e.qZA()}if(2&r){const s=e.oxw();e.Q6J("disabled",!1===s.enableSave)}}function A(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.saveUser())}),e._UZ(1,"i",46),e._uU(2,"Save"),e.qZA()}if(2&r){const s=e.oxw();e.Q6J("disabled",!1===s.enableSave)}}function P(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.getUser(t.username))}),e._UZ(1,"i",48),e._uU(2,"Search by Username"),e.qZA()}}function k(r,a){if(1&r&&(e.TgZ(0,"option",49),e._uU(1),e.qZA()),2&r){const s=a.$implicit;e.Q6J("ngValue",s),e.xp6(1),e.Oqu(s.username)}}function w(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"span")(1,"input",52),e.NdJ("ngModelChange",function(t){e.CHM(s);const o=e.oxw().$implicit;return e.KtG(o.granted=t)}),e.qZA(),e.TgZ(2,"label",53),e._uU(3),e.qZA()()}if(2&r){const s=e.oxw().$implicit;e.xp6(1),e.Q6J("ngModel",s.granted),e.xp6(1),e.s9C("for",s.name),e.xp6(1),e.Oqu(s.name)}}function y(r,a){if(1&r&&(e.TgZ(0,"div",50),e.YNc(1,w,4,3,"span",51),e.qZA()),2&r){const s=a.$implicit;e.xp6(1),e.Q6J("ngIf","SYSTEM"===s.owner)}}function E(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"span")(1,"input",52),e.NdJ("ngModelChange",function(t){e.CHM(s);const o=e.oxw().$implicit;return e.KtG(o.granted=t)}),e.qZA(),e.TgZ(2,"label",53),e._uU(3),e.qZA()()}if(2&r){const s=e.oxw().$implicit;e.xp6(1),e.Q6J("ngModel",s.granted),e.xp6(1),e.s9C("for",s.name),e.xp6(1),e.Oqu(s.name)}}function x(r,a){if(1&r&&(e.TgZ(0,"div",50),e.YNc(1,E,4,3,"span",51),e.qZA()),2&r){const s=a.$implicit;e.xp6(1),e.Q6J("ngIf","ORGANIZATION"===s.owner)}}function L(r,a){if(1&r){const s=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10,"["),e.TgZ(11,"a",54),e.NdJ("click",function(){const o=e.CHM(s).$implicit,i=e.oxw();return e.KtG(i.getUser(o.username))}),e._uU(12,"Select"),e.qZA(),e._uU(13,"]"),e.qZA()()}if(2&r){const s=a.$implicit;e.xp6(2),e.Oqu(s.code),e.xp6(2),e.AsE("",s.lastName,", ",s.firstName,""),e.xp6(2),e.Oqu(s.nickname),e.xp6(2),e.Oqu(s.active)}}const g=function(){return["ADMIN-ACCESS"]},q=function(){return["USER-D"]},J=function(){return["USER-ALL"]},p=Z.N.apiUrl;let O=(()=>{var r;class a{constructor(n,t,o,i){this.auth=n,this.http=t,this.spinner=o,this.msgBox=i,this.usernameLocked=!0,this.passwordLocked=!0,this.passwordConfLocked=!0,this.codeLocked=!0,this.firstNameLocked=!0,this.middleNameLocked=!0,this.lastNameLocked=!0,this.aliasLocked=!0,this.enableSearch=!1,this.enableDelete=!1,this.enableSave=!1,this.filterRecords="",this.searchKey="",this.id=null,this.username="",this.password="",this.confirmPassword="",this.code="",this.firstName="",this.middleName="",this.lastName="",this.nickname="",this.active=!0,this.roles=[],this.users=[]}getUserData(){var n=[];return this.roles.forEach(t=>{1==t.granted&&n.push(t)}),{id:this.id,username:this.username,password:this.password,code:this.code,firstName:this.firstName,middleName:this.middleName,lastName:this.lastName,nickname:this.nickname,active:this.active,roles:n}}ngOnInit(){this.getUsers(),this.getRoles()}saveUser(){var n=this;return(0,_.Z)(function*(){if(0==n.validateInputs())return;let t={headers:(new c.WM).set("Authorization","Bearer "+n.auth.user.access_token)};null==n.id?(n.spinner.show(),yield n.http.post(p+"/users/create",n.getUserData(),t).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(o=>{n.showUser(o),alert("User created successifully"),n.getUsers()}).catch(o=>{console.log(o),n.msgBox.showErrorMessage(o,"Could not create user")})):(n.spinner.show(),yield n.http.put(p+"/users/update",n.getUserData(),t).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(o=>{console.log(o),alert("User updated successifully"),n.getUsers()}).catch(o=>{console.log(o),n.msgBox.showErrorMessage(o,"Could not update user")}))})()}getRoles(){var n=this;return(0,_.Z)(function*(){let t={headers:(new c.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(p+"/roles",t).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(o=>{o?.forEach(i=>{n.roles.push(i)})}).catch(o=>{console.log(o)})})()}getUsers(){var n=this;return(0,_.Z)(function*(){n.users=[];let t={headers:(new c.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(p+"/users",t).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(o=>{o?.forEach(i=>{n.users.push(i)})}).catch(o=>{n.msgBox.showErrorMessage(o,"Could not load users")})})()}getUser(n){var t=this;return(0,_.Z)(function*(){t.searchKey=n,t.clearFields(),t.username=t.searchKey;let o={headers:(new c.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(p+"/users/get_user?username="+t.searchKey,o).pipe((0,u.x)(()=>t.spinner.hide())).toPromise().then(i=>{t.showUser(i),t.lockInputs()}).catch(i=>{console.log(i),t.msgBox.showErrorMessage(i,"User not found")})})()}deleteUser(){var n=this;return(0,_.Z)(function*(){if(null==n.id)return void alert("No user selected, please select a user to delete");if(!confirm("Confirm delete the selected user. This action can not be undone"))return;let t={headers:(new c.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.delete(p+"/users/delete?id="+n.id,t).pipe((0,u.x)(()=>n.spinner.hide())).toPromise().then(()=>(n.clearFields(),alert("User deleted succesifully"),!0)).catch(o=>(console.log(o),n.msgBox.showErrorMessage(o,"Could not delete user"),!1))})()}showUser(n){this.id=n.id,this.username=n.username,this.code=n.code,this.firstName=n.firstName,this.middleName=n.middleName,this.lastName=n.lastName,this.nickname=n.nickname,this.active=n.active,this.showUserRoles(this.roles,n.roles)}showUserRoles(n,t){this.clearRoles(),t.forEach(o=>{n.forEach(i=>{i.name===o.name&&(i.granted=!0)})}),this.roles=n}clearRoles(){this.roles.forEach(n=>{n.granted=!1})}validateInputs(){if(""==this.username)return alert("Empty username not allowed, please fill in the username field"),!1;if(null==this.id){if(""==this.password)return alert("Empty password not allowed for new user"),!1;if(this.password!=this.confirmPassword)return alert("Password and Password confirmation do not match"),!1}else if(this.password!=this.confirmPassword&&(""!=this.password||""!=this.confirmPassword))return alert("Password and Password confirmation do not match"),!1;return""!=this.firstName&&""!=this.lastName||(alert("First name, last name and nickname are required fields"),!1)}clearFields(){this.id=null,this.username="",this.password="",this.confirmPassword="",this.code="",this.firstName="",this.middleName="",this.lastName="",this.nickname="",this.active=!1,this.clearRoles(),this.enableSave=!0}unlockInputs(){this.usernameLocked=!1,this.passwordLocked=!1,this.passwordConfLocked=!1,this.codeLocked=!1,this.firstNameLocked=!1,this.middleNameLocked=!1,this.lastNameLocked=!1,this.aliasLocked=!1}lockInputs(){this.usernameLocked=!0,this.passwordLocked=!0,this.passwordConfLocked=!0,this.codeLocked=!0,this.firstNameLocked=!0,this.middleNameLocked=!0,this.lastNameLocked=!0,this.aliasLocked=!0}grant(n){var t=!1;return n.forEach(o=>{this.auth.checkPrivilege(o)&&(t=!0)}),t}}return(r=a).\u0275fac=function(n){return new(n||r)(e.Y36(C.e),e.Y36(c.eN),e.Y36(M.t2),e.Y36(v.l))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-profile"]],standalone:!0,features:[e.jDz],decls:118,vars:35,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],["routerLink","/home"],["data-mdb-toggle","tooltip","title","Go to Home dashboard",1,"btn","btn-primary","btn-outline"],[1,"glyphicon","glyphicon-home"],["class","btn btn-primary btn-outline","data-mdb-toggle","tooltip","title","Create a new User",3,"click",4,"ngIf"],["class","btn btn-primary btn-outline","data-mdb-toggle","tooltip","title","Edit an existing User",3,"click",4,"ngIf"],["class","btn btn-primary btn-outline","data-mdb-toggle","tooltip","title","Delete an existing User",3,"disabled","click",4,"ngIf"],["class","btn btn-primary btn-outline","data-mdb-toggle","tooltip","title","Save or Update an existing User",3,"disabled","click",4,"ngIf"],[1,"panel-body"],[1,"col-sm-6"],["type","hidden","name","id",3,"ngModel","ngModelChange"],[1,"col-sm-4"],["class","btn btn-success form-control",3,"click",4,"ngIf"],["type","text","name","code","readonly","","autocomplete","off",1,"form-control","input-sm","special",3,"ngModel","ngModelChange"],["type","text","name","username","list","users","minlength","6","maxlength","50","autocomplete","off",1,"form-control","input-sm","special",3,"ngModel","readonly","ngModelChange"],["id","users",2,"padding","0px"],[3,"ngValue",4,"ngFor","ngForOf"],["type","password","name","password","autocomplete","new-password",1,"form-control","input-sm","special",3,"ngModel","readonly","ngModelChange"],["type","password","name","confirmPassword","autocomplete","off",1,"form-control","input-sm","special",3,"ngModel","readonly","ngModelChange"],["type","text","name","firstName","autocomplete","off",1,"form-control","input-sm","special",3,"ngModel","readonly","ngModelChange"],["type","text","name","middleName","autocomplete","off",1,"form-control","input-sm","special",3,"ngModel","readonly","ngModelChange"],["type","text","name","lastName","autocomplete","off",1,"form-control","input-sm","special",3,"ngModel","readonly","ngModelChange"],["type","text","name","nickname","autocomplete","off",1,"form-control","input-sm","special",3,"ngModel","readonly","ngModelChange"],["type","checkbox","id","active","name","active",3,"ngModel","ngModelChange"],["for","active"],[1,"table","table-striped"],[2,"font-weight","bold"],[2,"margin","2mm"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-sm-12","table-responsive",2,"overflow","scroll"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-bordered","table-striped","table-sm"],[4,"ngFor","ngForOf"],["data-mdb-toggle","tooltip","title","Create a new User",1,"btn","btn-primary","btn-outline",3,"click"],[1,"glyphicon","glyphicon-file"],["data-mdb-toggle","tooltip","title","Edit an existing User",1,"btn","btn-primary","btn-outline",3,"click"],[1,"glyphicon","glyphicon-pencil"],["data-mdb-toggle","tooltip","title","Delete an existing User",1,"btn","btn-primary","btn-outline",3,"disabled","click"],[1,"glyphicon","glyphicon-trash"],["data-mdb-toggle","tooltip","title","Save or Update an existing User",1,"btn","btn-primary","btn-outline",3,"disabled","click"],[1,"glyphicon","glyphicon-floppy-disk"],[1,"btn","btn-success","form-control",3,"click"],[1,"glyphicon","glyphicon-search"],[3,"ngValue"],[1,"col-12"],[4,"ngIf"],["type","checkbox","id","role.name","name","role.name",3,"ngModel","ngModelChange"],[3,"for"],[2,"cursor","pointer",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"User Profile"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"a",7)(10,"button",8),e._UZ(11,"i",9),e._uU(12,"Home"),e.qZA()(),e.YNc(13,T,3,0,"button",10),e.YNc(14,b,3,0,"button",11),e.YNc(15,N,3,1,"button",12),e.YNc(16,A,3,1,"button",13),e.qZA(),e.TgZ(17,"div",14)(18,"div",3)(19,"div",15)(20,"input",16),e.NdJ("ngModelChange",function(i){return t.id=i}),e.qZA(),e.TgZ(21,"div",3),e._UZ(22,"div",17)(23,"div",17),e.TgZ(24,"div",17),e.YNc(25,P,3,0,"button",18),e.qZA()(),e.TgZ(26,"div",3)(27,"div",4)(28,"h4"),e._uU(29,"Code"),e.qZA(),e.TgZ(30,"input",19),e.NdJ("ngModelChange",function(i){return t.code=i}),e.qZA()()(),e.TgZ(31,"div",3)(32,"div",4)(33,"h4"),e._uU(34,"Username*"),e.qZA(),e.TgZ(35,"input",20),e.NdJ("ngModelChange",function(i){return t.username=i}),e.qZA(),e.TgZ(36,"datalist",21),e.YNc(37,k,2,2,"option",22),e.qZA()()(),e.TgZ(38,"div",3)(39,"div",4)(40,"h4"),e._uU(41,"Password* (6 or more characters)"),e.qZA(),e.TgZ(42,"input",23),e.NdJ("ngModelChange",function(i){return t.password=i}),e.qZA()()(),e.TgZ(43,"div",3)(44,"div",4)(45,"h4"),e._uU(46,"Confirm Password*"),e.qZA(),e.TgZ(47,"input",24),e.NdJ("ngModelChange",function(i){return t.confirmPassword=i}),e.qZA()()()(),e.TgZ(48,"div",15)(49,"div",3)(50,"div",4)(51,"h4"),e._uU(52,"First Name*"),e.qZA(),e.TgZ(53,"input",25),e.NdJ("ngModelChange",function(i){return t.firstName=i}),e.qZA()()(),e.TgZ(54,"div",3)(55,"div",4)(56,"h4"),e._uU(57,"Middle Name"),e.qZA(),e.TgZ(58,"input",26),e.NdJ("ngModelChange",function(i){return t.middleName=i}),e.qZA()()(),e.TgZ(59,"div",3)(60,"div",4)(61,"h4"),e._uU(62,"Last Name*"),e.qZA(),e.TgZ(63,"input",27),e.NdJ("ngModelChange",function(i){return t.lastName=i}),e.qZA()()(),e.TgZ(64,"div",3)(65,"div",4)(66,"h4"),e._uU(67,"Nickname*"),e.qZA(),e.TgZ(68,"input",28),e.NdJ("ngModelChange",function(i){return t.nickname=i}),e.qZA()()(),e.TgZ(69,"div",3)(70,"div",4)(71,"input",29),e.NdJ("ngModelChange",function(i){return t.active=i}),e.qZA(),e.TgZ(72,"label",30),e._uU(73," Active"),e.qZA(),e._UZ(74,"br"),e.qZA()()()(),e.TgZ(75,"div",3),e._UZ(76,"hr"),e.TgZ(77,"div",4)(78,"table",31)(79,"thead")(80,"tr")(81,"td",32),e._uU(82,"Default Roles"),e.qZA(),e.TgZ(83,"td",32),e._uU(84,"Organization Roles"),e.qZA()()(),e.TgZ(85,"tbody")(86,"tr")(87,"td",33)(88,"div",3),e.YNc(89,y,2,1,"div",34),e.qZA()(),e.TgZ(90,"td",33)(91,"div",3),e.YNc(92,x,2,1,"div",34),e.qZA()()()()()()(),e.TgZ(93,"div",3)(94,"div",35),e._UZ(95,"br"),e.TgZ(96,"div",3),e._UZ(97,"div",17)(98,"div",17),e.TgZ(99,"div",17)(100,"input",36),e.NdJ("ngModelChange",function(i){return t.filterRecords=i}),e.qZA()()(),e._UZ(101,"br"),e.TgZ(102,"table",37)(103,"thead")(104,"tr")(105,"td"),e._uU(106,"Code"),e.qZA(),e.TgZ(107,"td"),e._uU(108,"Name"),e.qZA(),e.TgZ(109,"td"),e._uU(110,"Nickname"),e.qZA(),e.TgZ(111,"td"),e._uU(112,"Active"),e.qZA(),e.TgZ(113,"td"),e._uU(114,"Select"),e.qZA()()(),e.TgZ(115,"tbody"),e.YNc(116,L,14,5,"tr",38),e.ALo(117,"searchFilter"),e.qZA()()()()()()()()()),2&n&&(e.xp6(13),e.Q6J("ngIf",t.grant(e.DdM(30,g))),e.xp6(1),e.Q6J("ngIf",t.grant(e.DdM(31,g))),e.xp6(1),e.Q6J("ngIf",t.grant(e.DdM(32,q))),e.xp6(1),e.Q6J("ngIf",t.grant(e.DdM(33,g))),e.xp6(4),e.Q6J("ngModel",t.id),e.xp6(5),e.Q6J("ngIf",t.grant(e.DdM(34,J))),e.xp6(5),e.Q6J("ngModel",t.code),e.xp6(5),e.Q6J("ngModel",t.username)("readonly",t.usernameLocked),e.xp6(2),e.Q6J("ngForOf",t.users),e.xp6(5),e.Q6J("ngModel",t.password)("readonly",t.passwordLocked),e.xp6(5),e.Q6J("ngModel",t.confirmPassword)("readonly",t.passwordConfLocked),e.xp6(6),e.Q6J("ngModel",t.firstName)("readonly",t.firstNameLocked),e.xp6(5),e.Q6J("ngModel",t.middleName)("readonly",t.middleNameLocked),e.xp6(5),e.Q6J("ngModel",t.lastName)("readonly",t.lastNameLocked),e.xp6(5),e.Q6J("ngModel",t.nickname)("readonly",t.aliasLocked),e.xp6(3),e.Q6J("ngModel",t.active),e.xp6(18),e.Q6J("ngForOf",t.roles),e.xp6(3),e.Q6J("ngForOf",t.roles),e.xp6(8),e.Q6J("ngModel",t.filterRecords),e.xp6(16),e.Q6J("ngForOf",e.xi3(117,27,t.users,t.filterRecords)))},dependencies:[m.ez,m.sg,m.O5,d.u5,d.YN,d.Kr,d.Fj,d.Wl,d.JJ,d.wO,d.nD,d.On,d.UX,U.G,f.rH]}),a})()}}]);