"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[9531],{9531:(O,u,c)=>{c.r(u),c.d(u,{ClinicianComponent:()=>q});var g=c(5861),h=c(6814),_=c(9862),r=c(95),p=c(4716),C=c(4185),Z=c(553),e=c(6689),f=c(6466),v=c(585),T=c(379);function M(l,d){if(1&l){const a=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"button",31),e.NdJ("click",function(){const s=e.CHM(a).$implicit,t=e.oxw();return e.KtG(t.getClinician(s.id))}),e._uU(13,"Edit"),e.qZA()()()}if(2&l){const a=d.$implicit;e.xp6(2),e.Oqu(a.code),e.xp6(2),e.Oqu(a.firstName),e.xp6(2),e.Oqu(a.middleName),e.xp6(2),e.Oqu(a.lastName),e.xp6(2),e.Oqu(a.type)}}function A(l,d){1&l&&(e.TgZ(0,"h1",32),e._uU(1,"Add Doctor"),e.qZA())}function N(l,d){1&l&&(e.TgZ(0,"h1",32),e._uU(1,"Edit Doctor"),e.qZA())}function U(l,d){if(1&l){const a=e.EpF();e.TgZ(0,"div",4)(1,"input",33),e.NdJ("ngModelChange",function(n){const t=e.CHM(a).$implicit;return e.KtG(t.assigned=n)}),e.qZA(),e.TgZ(2,"label",34),e._uU(3),e.qZA()()}if(2&l){const a=d.$implicit;e.xp6(1),e.Q6J("ngModel",a.assigned),e.xp6(1),e.s9C("for",a.name),e.xp6(1),e.Oqu(a.name)}}function E(l,d){1&l&&(e.TgZ(0,"span"),e._uU(1,"Update"),e.qZA())}function y(l,d){1&l&&(e.TgZ(0,"span"),e._uU(1,"Add"),e.qZA())}const m=Z.N.apiUrl;let q=(()=>{var l;class d{constructor(i,n,s,t){this.auth=i,this.http=n,this.spinner=s,this.msgBox=t,this.code="",this.firstName="",this.middleName="",this.lastName="",this.type="",this.active=!0,this.clinicians=[],this.clinicianClinics=[],this.userCode="",this.filterRecords="",this.clinics=[]}ngOnInit(){this.loadActiveClinicians(),this.loadClinics()}saveClinician(){var i=this;return(0,g.Z)(function*(){let n={headers:(new _.WM).set("Authorization","Bearer "+i.auth.user.access_token)};var s=[];i.clinics.forEach(o=>{1==o.assigned&&s.push(o)});var t={id:i.id,code:i.code,firstName:i.firstName,middleName:i.middleName,lastName:i.lastName,type:i.type,clinics:s,active:!0};null==i.id||""==i.id?(i.spinner.show(),yield i.http.post(m+"/clinicians/save",t,n).pipe((0,p.x)(()=>i.spinner.hide())).toPromise().then(o=>{i.id=o?.id,i.code=o.code,i.firstName=o.firstName,i.middleName=o.middleName,i.lastName=o.lastName,i.type=o.type,i.active=o.active,i.msgBox.showSuccessMessage("Clinician created successifully"),i.loadActiveClinicians(),i.clear()}).catch(o=>{i.msgBox.showErrorMessage(o,"")})):(i.spinner.show(),yield i.http.post(m+"/clinicians/save",t,n).pipe((0,p.x)(()=>i.spinner.hide())).toPromise().then(o=>{i.id=o?.id,i.code=o.code,i.firstName=o.firstName,i.middleName=o.middleName,i.lastName=o.lastName,i.type=o.type,i.active=o.active,i.msgBox.showSuccessMessage("Clinician updated successifully"),i.loadActiveClinicians()}).catch(o=>{i.msgBox.showErrorMessage(o,"")}))})()}loadActiveClinicians(){var i=this;return(0,g.Z)(function*(){i.clinicians=[];let n={headers:(new _.WM).set("Authorization","Bearer "+i.auth.user.access_token)};i.spinner.show(),yield i.http.get(m+"/clinicians/get_all_active",n).pipe((0,p.x)(()=>i.spinner.hide())).toPromise().then(s=>{s?.forEach(t=>{i.clinicians.push(t)})}).catch(s=>{i.msgBox.showErrorMessage(s,"Could not load clinicians")})})()}clear(){this.id=null,this.code="",this.firstName="",this.middleName="",this.lastName="",this.type="",this.active=!1}getClinician(i){var n=this;return(0,g.Z)(function*(){if(""==i)return;let s={headers:(new _.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(m+"/clinicians/get?id="+i,s).pipe((0,p.x)(()=>n.spinner.hide())).toPromise().then(t=>{console.log(t),n.id=t?.id,n.code=t.code,n.firstName=t.firstName,n.middleName=t.middleName,n.lastName=t.lastName,n.type=t.type,n.active=t.active,n.showUserRoles(n.clinics,t.clinics)}).catch(t=>{console.log(t),n.msgBox.showErrorMessage(t,"Could not find Doctor")})})()}showClinicianClinics(i,n){this.clearClinics(),n.forEach(s=>{i.forEach(t=>{t.name===s.name&&(t.assigned=!0)})}),this.clinics=i}showUserRoles(i,n){this.clearClinics(),n.forEach(s=>{i.forEach(t=>{t.name===s.name&&(t.assigned=!0)})}),this.clinics=i}clearClinics(){this.clinics.forEach(i=>{i.assigned=!1})}loadClinics(){var i=this;return(0,g.Z)(function*(){let n={headers:(new _.WM).set("Authorization","Bearer "+i.auth.user.access_token)};i.spinner.show(),yield i.http.get(m+"/clinics",n).pipe((0,p.x)(()=>i.spinner.hide())).toPromise().then(s=>{s?.forEach(t=>{console.log(t),i.clinics.push(t)})}).catch(s=>{console.log(s)})})()}clearUser(){this.userCode=""}assignUserProfile(){var i=this;return(0,g.Z)(function*(){let n={headers:(new _.WM).set("Authorization","Bearer "+i.auth.user.access_token)};null!=i.id&&(i.spinner.show(),yield i.http.post(m+"/clinicians/assign_user_profile?id="+i.id+"&code="+i.userCode,null,n).pipe((0,p.x)(()=>i.spinner.hide())).toPromise().then(s=>{i.id=s?.id,i.code=s.code,i.firstName=s.firstName,i.middleName=s.middleName,i.lastName=s.lastName,i.type=s.type,i.clinics=s.clinics,i.active=s.active,i.msgBox.showSuccessMessage("Saved successifully"),i.loadActiveClinicians(),i.clear()}).catch(s=>{i.msgBox.showErrorMessage(s,"")}))})()}grant(i){var n=!1;return i.forEach(s=>{this.auth.checkPrivilege(s)&&(n=!0)}),n}}return(l=d).\u0275fac=function(i){return new(i||l)(e.Y36(f.e),e.Y36(_.eN),e.Y36(v.t2),e.Y36(T.l))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-clinician"]],standalone:!0,features:[e.jDz],decls:100,vars:17,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"btn"],[1,"panel-body"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-bordered","table-small"],[4,"ngFor","ngForOf"],["id","add-edit-modal","tabindex","-1","role","dialog",1,"modal","fade","modal-success"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["class","modal-title",4,"ngIf"],[1,"modal-body"],["type","hidden",3,"ngModel","ngModelChange"],[1,"col-xs-12"],["type","text","readonly","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-control",3,"ngModel","ngModelChange"],["class","col-sm-12",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-danger"],["type","button","data-dismiss","modal",1,"btn","btn-success",3,"click"],[4,"ngIf"],["data-toggle","modal","data-target","#add-edit-modal",1,"btn","btn-primary",2,"margin","1px",3,"click"],[1,"modal-title"],["type","checkbox","id","clinic.name","name","clinic.name",3,"ngModel","ngModelChange"],[3,"for"]],template:function(i,n){1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Doctor Register"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"div",7),e.qZA(),e.TgZ(10,"div",8)(11,"div",9)(12,"div",3),e._UZ(13,"div",10)(14,"div",10),e.TgZ(15,"div",10)(16,"input",11),e.NdJ("ngModelChange",function(t){return n.filterRecords=t}),e.qZA()()(),e._UZ(17,"br"),e.TgZ(18,"table",12)(19,"thead")(20,"tr")(21,"td"),e._uU(22,"Code"),e.qZA(),e.TgZ(23,"td"),e._uU(24,"First Name"),e.qZA(),e.TgZ(25,"td"),e._uU(26,"Middle Name"),e.qZA(),e.TgZ(27,"td"),e._uU(28,"Last Name"),e.qZA(),e.TgZ(29,"td"),e._uU(30,"Type"),e.qZA(),e.TgZ(31,"td"),e._uU(32,"Action"),e.qZA()()(),e.TgZ(33,"tbody"),e.YNc(34,M,14,5,"tr",13),e.ALo(35,"searchFilter"),e.qZA()()()()()()()(),e.TgZ(36,"div",14)(37,"div",15)(38,"div",16)(39,"div",17)(40,"button",18)(41,"span",19),e._uU(42,"\xd7"),e.qZA()(),e.YNc(43,A,2,0,"h1",20),e.YNc(44,N,2,0,"h1",20),e.qZA(),e.TgZ(45,"div",21)(46,"div",3)(47,"input",22),e.NdJ("ngModelChange",function(t){return n.id=t}),e.qZA(),e.TgZ(48,"div",23)(49,"label"),e._uU(50,"Code*"),e.qZA(),e.TgZ(51,"input",24),e.NdJ("ngModelChange",function(t){return n.code=t}),e.qZA()()(),e.TgZ(52,"div",3)(53,"div",23)(54,"label"),e._uU(55,"First Name*"),e.qZA(),e.TgZ(56,"input",24),e.NdJ("ngModelChange",function(t){return n.firstName=t}),e.qZA()()(),e.TgZ(57,"div",3)(58,"div",23)(59,"label"),e._uU(60,"Middle Name"),e.qZA(),e.TgZ(61,"input",24),e.NdJ("ngModelChange",function(t){return n.middleName=t}),e.qZA()()(),e.TgZ(62,"div",3)(63,"div",23)(64,"label"),e._uU(65,"Last Name*"),e.qZA(),e.TgZ(66,"input",24),e.NdJ("ngModelChange",function(t){return n.lastName=t}),e.qZA()()(),e.TgZ(67,"div",3)(68,"div",23)(69,"label"),e._uU(70,"Type"),e.qZA(),e.TgZ(71,"select",25),e.NdJ("ngModelChange",function(t){return n.type=t}),e.TgZ(72,"option"),e._uU(73),e.qZA(),e.TgZ(74,"option"),e._uU(75,"General Practitioner"),e.qZA(),e.TgZ(76,"option"),e._uU(77,"Dentist"),e.qZA(),e.TgZ(78,"option"),e._uU(79,"Optician"),e.qZA(),e.TgZ(80,"option"),e._uU(81,"Gnaecologist"),e.qZA(),e.TgZ(82,"option"),e._uU(83,"Padiatrician"),e.qZA(),e.TgZ(84,"option"),e._uU(85,"Other"),e.qZA()()()(),e._UZ(86,"hr"),e.TgZ(87,"div",3)(88,"div",4)(89,"label"),e._uU(90,"Check Clinics"),e.qZA()(),e.TgZ(91,"div",4)(92,"div",3),e.YNc(93,U,4,3,"div",26),e.qZA()()()(),e.TgZ(94,"div",27)(95,"button",28),e._uU(96,"Close"),e.qZA(),e.TgZ(97,"button",29),e.NdJ("click",function(){return n.saveClinician()}),e.YNc(98,E,2,0,"span",30),e.YNc(99,y,2,0,"span",30),e.qZA()()()()()),2&i&&(e.xp6(16),e.Q6J("ngModel",n.filterRecords),e.xp6(18),e.Q6J("ngForOf",e.xi3(35,14,n.clinicians,n.filterRecords)),e.xp6(9),e.Q6J("ngIf",null===n.id),e.xp6(1),e.Q6J("ngIf",null!=n.id),e.xp6(3),e.Q6J("ngModel",n.id),e.xp6(4),e.Q6J("ngModel",n.code),e.xp6(5),e.Q6J("ngModel",n.firstName),e.xp6(5),e.Q6J("ngModel",n.middleName),e.xp6(5),e.Q6J("ngModel",n.lastName),e.xp6(5),e.Q6J("ngModel",n.type),e.xp6(2),e.Oqu(n.type),e.xp6(20),e.Q6J("ngForOf",n.clinics),e.xp6(5),e.Q6J("ngIf",null!=n.id),e.xp6(1),e.Q6J("ngIf",null===n.id))},dependencies:[h.ez,h.sg,h.O5,r.u5,r.YN,r.Kr,r.Fj,r.Wl,r.EJ,r.JJ,r.On,r.UX,C.G]}),d})()}}]);