"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[1143],{1143:(D,m,i)=>{i.r(m),i.d(m,{ProcedureTypePriceComponent:()=>U});var P=i(5861),_=i(6814),T=i(9862),l=i(95),g=i(4716),v=i(4185),C=i(553),e=i(6689),I=i(6466),E=i(1581),Z=i(585),f=i(379);function M(p,s){if(1&p){const o=e.EpF();e.TgZ(0,"span"),e._uU(1,"COVERED "),e.TgZ(2,"button",19),e.NdJ("click",function(){e.CHM(o);const r=e.oxw(2).$implicit,t=e.oxw();return e.KtG(t.changeProcedureTypeCoverage(t.insurancePlanId,null==r||null==r.procedureTypeInsurancePlan||null==r.procedureTypeInsurancePlan.procedureType?null:r.procedureTypeInsurancePlan.procedureType.id,!1))}),e._uU(3,"Change"),e.qZA()()}}function A(p,s){if(1&p){const o=e.EpF();e.TgZ(0,"span"),e._uU(1,"NOT COVERED "),e.TgZ(2,"button",19),e.NdJ("click",function(){e.CHM(o);const r=e.oxw(2).$implicit,t=e.oxw();return e.KtG(t.changeProcedureTypeCoverage(t.insurancePlanId,null==r||null==r.procedureTypeInsurancePlan||null==r.procedureTypeInsurancePlan.procedureType?null:r.procedureTypeInsurancePlan.procedureType.id,!0))}),e._uU(3,"Change"),e.qZA()()}}function x(p,s){if(1&p&&(e.TgZ(0,"div"),e.YNc(1,M,4,0,"span",18),e.YNc(2,A,4,0,"span",18),e.qZA()),2&p){const o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!0===(null==o||null==o.procedureTypeInsurancePlan?null:o.procedureTypeInsurancePlan.covered)),e.xp6(1),e.Q6J("ngIf",!1===(null==o||null==o.procedureTypeInsurancePlan?null:o.procedureTypeInsurancePlan.covered))}}function O(p,s){if(1&p){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",14),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"td")(9,"input",15),e.NdJ("ngModelChange",function(r){const n=e.CHM(o).$implicit;return e.KtG(n.price=r)}),e.qZA()(),e.TgZ(10,"td")(11,"button",16),e.NdJ("click",function(){const t=e.CHM(o).$implicit,n=e.oxw();return e.KtG(n.updateProcedureTypePriceByInsurance(n.insurancePlanId,null==t||null==t.procedureType?null:t.procedureType.id,t.price))}),e._UZ(12,"i",17),e._uU(13,"Save"),e.qZA()(),e.TgZ(14,"td"),e.YNc(15,x,3,2,"div",18),e.qZA()()}if(2&p){const o=s.$implicit;e.xp6(2),e.Oqu(o.procedureType.id),e.xp6(2),e.Oqu(o.procedureType.name),e.xp6(2),e.Oqu(e.Dn7(7,5,o.price,"","")),e.xp6(3),e.Q6J("ngModel",o.price),e.xp6(6),e.Q6J("ngIf",null!=(null==o||null==o.procedureTypeInsurancePlan?null:o.procedureTypeInsurancePlan.covered))}}const h=C.N.apiUrl;let U=(()=>{var p;class s{constructor(c,r,t,n,d){this.auth=c,this.http=r,this.modalService=t,this.spinner=n,this.msgBox=d,this.insurancePlanId=null,this.insurancePlanName="",this.procedureTypes=[],this.procedureTypePrices=[],this.filterRecords=""}ngOnInit(){this.insurancePlanId=localStorage.getItem("insurance_plan_id"),this.insurancePlanName=localStorage.getItem("insurance_plan_name"),localStorage.removeItem("insurance_plan_id"),localStorage.removeItem("insurance_plan_name"),this.loadProcedureTypesByInsurance(this.insurancePlanId)}loadProcedureTypesByInsurance(c){var r=this;return(0,P.Z)(function*(){r.procedureTypes=[];let t={headers:(new T.WM).set("Authorization","Bearer "+r.auth.user.access_token)};r.spinner.show(),yield r.http.get(h+"/insurance_plans/get_procedure_type_prices?insurance_plan_id="+c,t).pipe((0,g.x)(()=>r.spinner.hide())).toPromise().then(n=>{r.procedureTypePrices=n}).catch(n=>{r.msgBox.showErrorMessage(n,"Could not load procedure types")})})()}changeProcedureTypeCoverage(c,r,t){var n=this;return(0,P.Z)(function*(){let d={headers:(new T.WM).set("Authorization","Bearer "+n.auth.user.access_token)};var y={procedureType:{id:r},procedureTypeInsurancePlan:{insurancePlan:{id:c},covered:t}};n.spinner.show(),yield n.http.post(h+"/insurance_plans/change_procedure_type_coverage",y,d).pipe((0,g.x)(()=>n.spinner.hide())).toPromise().then(a=>{n.procedureTypePrices.forEach(u=>{a.procedureType.id===u.procedureType.id&&(u.procedureTypeInsurancePlan.covered=a.procedureTypeInsurancePlan.covered)})}).catch(a=>{n.msgBox.showErrorMessage(a,"Could not change coverage")})})()}updateProcedureTypePriceByInsurance(c,r,t){var n=this;return(0,P.Z)(function*(){let d={headers:(new T.WM).set("Authorization","Bearer "+n.auth.user.access_token)};var y={procedureType:{id:r},procedureTypeInsurancePlan:{insurancePlan:{id:c}},price:t};n.spinner.show(),yield n.http.post(h+"/insurance_plans/update_procedure_type_price_by_insurance",y,d).pipe((0,g.x)(()=>n.spinner.hide())).toPromise().then(a=>{n.procedureTypePrices.forEach(u=>{a.procedureType.id===u.procedureType.id&&(u.price=a.price,u.covered=a.covered)}),n.msgBox.showSuccessMessage("Price updated successifully")}).catch(a=>{n.msgBox.showErrorMessage(a,"Could not update price")})})()}}return(p=s).\u0275fac=function(c){return new(c||p)(e.Y36(I.e),e.Y36(T.eN),e.Y36(E.FF),e.Y36(Z.t2),e.Y36(f.l))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-procedure-type-price"]],standalone:!0,features:[e.jDz],decls:37,vars:6,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"text-primary"],[1,"panel-body"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-bordered","table-small"],[4,"ngFor","ngForOf"],[2,"text-align","right"],["type","text",1,"form-control",2,"text-align","center",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],[1,"glyphicon","glyphicon-floppy-disk"],[4,"ngIf"],[3,"click"]],template:function(c,r){1&c&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Procedure Type Prices"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h4",7),e._uU(10),e.qZA()(),e.TgZ(11,"div",8)(12,"div",9)(13,"div",3),e._UZ(14,"div",10)(15,"div",10),e.TgZ(16,"div",10)(17,"input",11),e.NdJ("ngModelChange",function(n){return r.filterRecords=n}),e.qZA()()(),e._UZ(18,"br"),e.TgZ(19,"table",12)(20,"thead")(21,"tr")(22,"td"),e._uU(23,"ID"),e.qZA(),e.TgZ(24,"td"),e._uU(25,"Procedure"),e.qZA(),e.TgZ(26,"td"),e._uU(27,"Price"),e.qZA(),e.TgZ(28,"td"),e._uU(29,"Edit Price"),e.qZA(),e.TgZ(30,"td"),e._uU(31,"Action"),e.qZA(),e.TgZ(32,"td"),e._uU(33,"Coverage"),e.qZA()()(),e.TgZ(34,"tbody"),e.YNc(35,O,16,9,"tr",13),e.ALo(36,"searchFilter"),e.qZA()()()()()()()()),2&c&&(e.xp6(10),e.hij("Package: ",r.insurancePlanName,""),e.xp6(7),e.Q6J("ngModel",r.filterRecords),e.xp6(18),e.Q6J("ngForOf",e.xi3(36,3,r.procedureTypePrices,r.filterRecords)))},dependencies:[_.ez,_.sg,_.O5,_.H9,l.u5,l.Fj,l.JJ,l.On,l.UX,v.G]}),s})()}}]);