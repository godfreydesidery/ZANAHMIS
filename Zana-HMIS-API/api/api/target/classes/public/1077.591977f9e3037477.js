"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[1077],{1077:(R,u,i)=>{i.r(u),i.d(u,{PharmacyMedicineStockStatusComponent:()=>b});var h=i(5861),g=i(6814),_=i(9862),r=i(95),M=i(4716),S=i(4185),T=i(553),y=i(7069),e=i(6689),Z=i(6466),v=i(7140),P=i(585),E=i(8237),A=i(379),U=i(2848);function O(s,m){if(1&s){const c=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"button",32),e.NdJ("click",function(){const o=e.CHM(c).$implicit,a=e.oxw();return e.KtG(a.setValues(o.id,o.medicine.code,o.medicine.name,o.stock))}),e._UZ(11,"i",33),e._uU(12," Change Stock"),e.qZA()()()}if(2&s){const c=m.$implicit;e.xp6(2),e.Oqu(null==c||null==c.medicine?null:c.medicine.code),e.xp6(2),e.Oqu(null==c||null==c.medicine?null:c.medicine.name),e.xp6(2),e.Oqu(null==c||null==c.medicine?null:c.medicine.category),e.xp6(2),e.Oqu(null==c?null:c.stock)}}var D=i(6236);const f=T.N.apiUrl;let b=(()=>{var s;class m{constructor(t,n,o,a,k,N,x){var d=this;this.auth=t,this.http=n,this.modalService=o,this.spinner=a,this.router=k,this.msgBox=N,this.data=x,this.id=null,this.pharmacyMedicineCode="",this.pharmacyMedicineName="",this.pharmacyMedicineStock=0,this.pharmacyName=localStorage.getItem("selected-pharmacy-name"),this.pharmacyMedicines=[],this.pharmacyMedicinesToShow=[],this.filterRecords="",this.category="ALL",this.print=(0,h.Z)(function*(){if(0===d.pharmacyMedicinesToShow.length)return void d.msgBox.showErrorMessage3("No data to print");d.documentHeader=yield d.data.getDocumentHeader();var C=[[{text:"Code",fontSize:9,fillColor:"#bdc6c7"},{text:"Name",fontSize:9,fillColor:"#bdc6c7"},{text:"Category",fontSize:9,fillColor:"#bdc6c7"},{text:"Qty",fontSize:9,fillColor:"#bdc6c7"}]];d.pharmacyMedicinesToShow.forEach(l=>{var p=[{text:l?.medicine?.code,fontSize:9,fillColor:"#ffffff"},{text:l?.medicine?.name,fontSize:9,fillColor:"#ffffff"},{text:l?.medicine?.category,fontSize:9,fillColor:"#ffffff"},{text:l?.stock.toString(),fontSize:9,fillColor:"#ffffff"}];C.push(p)});const L={header:"",footer:function(l,p){return l.toString()+" of "+p},content:[{columns:[d.documentHeader]},"  ",{text:"Pharmacy Stock Status Report",fontSize:14,bold:!0,alignment:"center"},d.data.getHorizontalLine()," ","Pharmacy Name: "+d.pharmacyName," ","Category: "+d.category,"  ",{table:{headerRows:1,widths:[80,230,80,80],body:C}}]};y.createPdf(L).print()}),window.pdfMake.vfs=D.pdfMake.vfs}ngOnInit(){var t=this;return(0,h.Z)(function*(){yield t.loadPharmacyMedicines()})()}loadPharmacyMedicines(){var t=this;return(0,h.Z)(function*(){let n={headers:(new _.WM).set("Authorization","Bearer "+t.auth.user.access_token)};t.spinner.show(),yield t.http.get(f+"/pharmacies/get_pharmacy_medicine_list?pharmacy_name="+t.pharmacyName,n).pipe((0,M.x)(()=>t.spinner.hide())).toPromise().then(o=>{console.log(o),t.pharmacyMedicines=[],t.pharmacyMedicinesToShow=[],o?.forEach(a=>{t.pharmacyMedicines.push(a),t.pharmacyMedicinesToShow.push(a)})}).catch(o=>{t.msgBox.showErrorMessage(o,""),console.log(o)})})()}filterByCategory(t){this.pharmacyMedicinesToShow=[],"ALL"===this.category?this.pharmacyMedicinesToShow=this.pharmacyMedicines:this.pharmacyMedicines.forEach(n=>{n.medicine.category===t&&this.pharmacyMedicinesToShow.push(n)})}setValues(t,n,o,a){this.id=t,this.pharmacyMedicineCode=n,this.pharmacyMedicineName=o,this.pharmacyMedicineStock=a}updateStock(){var t=this;return(0,h.Z)(function*(){let n={headers:(new _.WM).set("Authorization","Bearer "+t.auth.user.access_token)};var o={id:t.id,stock:t.pharmacyMedicineStock};t.spinner.show(),yield t.http.post(f+"/pharmacies/update_stock",o,n).pipe((0,M.x)(()=>t.spinner.hide())).toPromise().then(a=>{t.msgBox.showSuccessMessage("Updated successifully")}).catch(a=>{t.msgBox.showErrorMessage(a,""),console.log(a)}),yield t.loadPharmacyMedicines(),t.filterByCategory(t.category)})()}}return(s=m).\u0275fac=function(t){return new(t||s)(e.Y36(Z.e),e.Y36(_.eN),e.Y36(v.FF),e.Y36(P.t2),e.Y36(E.F0),e.Y36(A.l),e.Y36(U.D))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-pharmacy-medicine-stock-status"]],standalone:!0,features:[e.jDz],decls:86,vars:11,consts:[[1,"content-header"],[1,"header-title"],[1,"text-primary"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],["type","button",1,"btn","btn-success","btn-outline",3,"click"],[1,"fa","fa-print"],[1,"panel-body"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-responsive","table-striped","table-bordered"],[2,"font-style","bold"],[1,"form-control",2,"border-style","none",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["id","edit-qty-modal","tabindex","-1","role","dialog",1,"modal","fade","modal-success"],["role","document",1,"modal-dialog","modal-md"],[1,"modal-content"],[1,"modal-header"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-title"],[1,"modal-body"],["type","hidden",3,"ngModel","ngModelChange"],[1,"col-sm-8"],["type","text","readonly","",1,"form-control",3,"ngModel","ngModelChange"],["type","text",1,"form-control",2,"text-align","center",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-danger","pull-left"],["type","button","data-dismiss","modal",1,"btn","btn-success","pull-right",3,"click"],["type","button","data-toggle","modal","data-target","#edit-qty-modal",1,"btn","btn-success","btn-outline",3,"click"],[1,"glyphicon","glyphicon-pencil"]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Pharmacy - Stock Status ("),e.TgZ(4,"span",2),e._uU(5),e.qZA(),e._uU(6,")"),e.qZA()()(),e.TgZ(7,"section",3)(8,"div",4)(9,"div",5)(10,"div",6)(11,"div",7)(12,"button",8),e.NdJ("click",function(){return n.print()}),e._UZ(13,"i",9),e._uU(14," Print"),e.qZA()(),e.TgZ(15,"div",10)(16,"div",4),e._UZ(17,"div",11)(18,"div",11),e.TgZ(19,"div",11)(20,"input",12),e.NdJ("ngModelChange",function(a){return n.filterRecords=a}),e.qZA()()(),e._UZ(21,"br"),e.TgZ(22,"table",13)(23,"thead")(24,"tr",14)(25,"td"),e._uU(26,"Code"),e.qZA(),e.TgZ(27,"td"),e._uU(28,"Name"),e.qZA(),e.TgZ(29,"td")(30,"table")(31,"thead")(32,"tr")(33,"td"),e._uU(34,"Category (Select Category)"),e.qZA(),e.TgZ(35,"td")(36,"select",15),e.NdJ("ngModelChange",function(a){return n.category=a})("ngModelChange",function(a){return n.filterByCategory(a)}),e.TgZ(37,"option"),e._uU(38,"ALL"),e.qZA(),e.TgZ(39,"option"),e._uU(40,"MEDICINE"),e.qZA(),e.TgZ(41,"option"),e._uU(42,"PRODUCT"),e.qZA(),e.TgZ(43,"option"),e._uU(44,"EQUIPMENT"),e.qZA()()()()()()(),e.TgZ(45,"td"),e._uU(46,"Qty"),e.qZA(),e.TgZ(47,"td"),e._uU(48,"Action"),e.qZA()()(),e.TgZ(49,"tbody"),e.YNc(50,O,13,4,"tr",16),e.ALo(51,"searchFilter"),e.qZA()()()()()()(),e.TgZ(52,"div",17)(53,"div",18)(54,"div",19)(55,"div",20)(56,"button",21)(57,"span",22),e._uU(58,"\xd7"),e.qZA()(),e.TgZ(59,"h2",23),e._uU(60,"Update Stock"),e.qZA()(),e.TgZ(61,"div",24)(62,"div",4)(63,"input",25),e.NdJ("ngModelChange",function(a){return n.id=a}),e.qZA(),e.TgZ(64,"div",11)(65,"h4"),e._uU(66,"Code"),e.qZA()(),e.TgZ(67,"div",26)(68,"input",27),e.NdJ("ngModelChange",function(a){return n.pharmacyMedicineCode=a}),e.qZA()()(),e.TgZ(69,"div",4)(70,"div",11)(71,"h4"),e._uU(72,"Name"),e.qZA()(),e.TgZ(73,"div",26)(74,"input",27),e.NdJ("ngModelChange",function(a){return n.pharmacyMedicineName=a}),e.qZA()()(),e.TgZ(75,"div",4)(76,"div",11)(77,"h4"),e._uU(78,"Stock"),e.qZA()(),e.TgZ(79,"div",26)(80,"input",28),e.NdJ("ngModelChange",function(a){return n.pharmacyMedicineStock=a}),e.qZA()()()(),e.TgZ(81,"div",29)(82,"button",30),e._uU(83,"Close"),e.qZA(),e.TgZ(84,"button",31),e.NdJ("click",function(){return n.updateStock()}),e._uU(85,"Update"),e.qZA()()()()()),2&t&&(e.xp6(5),e.Oqu(n.pharmacyName),e.xp6(15),e.Q6J("ngModel",n.filterRecords),e.xp6(16),e.Q6J("ngModel",n.category),e.xp6(14),e.Q6J("ngForOf",e.xi3(51,8,n.pharmacyMedicinesToShow,n.filterRecords)),e.xp6(13),e.Q6J("ngModel",n.id),e.xp6(5),e.Q6J("ngModel",n.pharmacyMedicineCode),e.xp6(6),e.Q6J("ngModel",n.pharmacyMedicineName),e.xp6(6),e.Q6J("ngModel",n.pharmacyMedicineStock))},dependencies:[g.ez,g.sg,r.u5,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.On,r.UX,S.G]}),m})()}}]);