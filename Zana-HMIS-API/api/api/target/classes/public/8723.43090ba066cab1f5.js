"use strict";(self.webpackChunkzana_hmis=self.webpackChunkzana_hmis||[]).push([[8723],{8723:(O,m,o)=>{o.r(m),o.d(m,{WardTypePriceComponent:()=>W});var g=o(5861),u=o(6814),T=o(9862),_=o(95),h=o(4716),v=o(4185),C=o(553),e=o(6689),w=o(6466),I=o(1581),E=o(585),Z=o(379);function f(s,c){if(1&s){const a=e.EpF();e.TgZ(0,"span"),e._uU(1,"COVERED "),e.TgZ(2,"button",19),e.NdJ("click",function(){e.CHM(a);const n=e.oxw(2).$implicit,t=e.oxw();return e.KtG(t.changeWardTypeCoverage(t.insurancePlanId,null==n||null==n.wardTypeInsurancePlan||null==n.wardTypeInsurancePlan.wardType?null:n.wardTypeInsurancePlan.wardType.id,!1))}),e._uU(3,"Change"),e.qZA()()}}function M(s,c){if(1&s){const a=e.EpF();e.TgZ(0,"span"),e._uU(1,"NOT COVERED "),e.TgZ(2,"button",19),e.NdJ("click",function(){e.CHM(a);const n=e.oxw(2).$implicit,t=e.oxw();return e.KtG(t.changeWardTypeCoverage(t.insurancePlanId,null==n||null==n.wardTypeInsurancePlan||null==n.wardTypeInsurancePlan.wardType?null:n.wardTypeInsurancePlan.wardType.id,!0))}),e._uU(3,"Change"),e.qZA()()}}function A(s,c){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,f,4,0,"span",18),e.YNc(2,M,4,0,"span",18),e.qZA()),2&s){const a=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!0===(null==a||null==a.wardTypeInsurancePlan?null:a.wardTypeInsurancePlan.covered)),e.xp6(1),e.Q6J("ngIf",!1===(null==a||null==a.wardTypeInsurancePlan?null:a.wardTypeInsurancePlan.covered))}}function x(s,c){if(1&s){const a=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",14),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"td")(9,"input",15),e.NdJ("ngModelChange",function(n){const r=e.CHM(a).$implicit;return e.KtG(r.price=n)}),e.qZA()(),e.TgZ(10,"td")(11,"button",16),e.NdJ("click",function(){const t=e.CHM(a).$implicit,r=e.oxw();return e.KtG(r.updateWardTypePriceByInsurance(r.insurancePlanId,null==t||null==t.wardType?null:t.wardType.id,t.price))}),e._UZ(12,"i",17),e._uU(13,"Save"),e.qZA()(),e.TgZ(14,"td"),e.YNc(15,A,3,2,"div",18),e.qZA()()}if(2&s){const a=c.$implicit;e.xp6(2),e.Oqu(a.wardType.id),e.xp6(2),e.Oqu(a.wardType.name),e.xp6(2),e.Oqu(e.Dn7(7,5,a.price,"","")),e.xp6(3),e.Q6J("ngModel",a.price),e.xp6(6),e.Q6J("ngIf",null!=(null==a||null==a.wardTypeInsurancePlan?null:a.wardTypeInsurancePlan.covered))}}const y=C.N.apiUrl;let W=(()=>{var s;class c{constructor(i,n,t,r,d){this.auth=i,this.http=n,this.modalService=t,this.spinner=r,this.msgBox=d,this.insurancePlanId=null,this.insurancePlanName="",this.wardTypes=[],this.wardTypePrices=[],this.filterRecords=""}ngOnInit(){this.insurancePlanId=localStorage.getItem("insurance_plan_id"),this.insurancePlanName=localStorage.getItem("insurance_plan_name"),localStorage.removeItem("insurance_plan_id"),localStorage.removeItem("insurance_plan_name"),this.loadWardTypesByInsurance(this.insurancePlanId)}loadWardTypesByInsurance(i){var n=this;return(0,g.Z)(function*(){n.wardTypes=[];let t={headers:(new T.WM).set("Authorization","Bearer "+n.auth.user.access_token)};n.spinner.show(),yield n.http.get(y+"/insurance_plans/get_ward_type_prices?insurance_plan_id="+i,t).pipe((0,h.x)(()=>n.spinner.hide())).toPromise().then(r=>{n.wardTypePrices=r}).catch(r=>{n.msgBox.showErrorMessage(r,"Could not load plans")})})()}changeWardTypeCoverage(i,n,t){var r=this;return(0,g.Z)(function*(){let d={headers:(new T.WM).set("Authorization","Bearer "+r.auth.user.access_token)};var P={wardType:{id:n},wardTypeInsurancePlan:{insurancePlan:{id:i},covered:t}};r.spinner.show(),yield r.http.post(y+"/insurance_plans/change_ward_type_coverage",P,d).pipe((0,h.x)(()=>r.spinner.hide())).toPromise().then(l=>{r.wardTypePrices.forEach(p=>{l.wardType.id===p.wardType.id&&(p.wardTypeInsurancePlan.covered=l.wardTypeInsurancePlan.covered)})}).catch(l=>{r.msgBox.showErrorMessage(l,"Could not change coverage")})})()}updateWardTypePriceByInsurance(i,n,t){var r=this;return(0,g.Z)(function*(){let d={headers:(new T.WM).set("Authorization","Bearer "+r.auth.user.access_token)};var P={wardType:{id:n},wardTypeInsurancePlan:{insurancePlan:{id:i}},price:t};r.spinner.show(),yield r.http.post(y+"/insurance_plans/update_ward_type_price_by_insurance",P,d).pipe((0,h.x)(()=>r.spinner.hide())).toPromise().then(l=>{r.wardTypePrices.forEach(p=>{l.wardType.id===p.wardType.id&&(p.price=l.price,p.covered=l.covered)}),r.msgBox.showSuccessMessage("Price updated successifully")}).catch(l=>{r.msgBox.showErrorMessage(l,"Could not update price")})})()}}return(s=c).\u0275fac=function(i){return new(i||s)(e.Y36(w.e),e.Y36(T.eN),e.Y36(I.FF),e.Y36(E.t2),e.Y36(Z.l))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-ward-type-price"]],standalone:!0,features:[e.jDz],decls:37,vars:6,consts:[[1,"content-header"],[1,"header-title"],[1,"content"],[1,"row"],[1,"col-sm-12"],[1,"panel","panel-bd","lobidrag"],[1,"panel-heading"],[1,"text-primary"],[1,"panel-body"],[1,"col-sm-12",2,"height","100%","overflow","scroll"],[1,"col-sm-4"],["type","text","placeholder","Search...",1,"form-control","pull-right",2,"max-width","8cm",3,"ngModel","ngModelChange"],[1,"table","table-bordered","table-small"],[4,"ngFor","ngForOf"],[2,"text-align","right"],["type","text",1,"form-control",2,"text-align","center",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],[1,"glyphicon","glyphicon-floppy-disk"],[4,"ngIf"],[3,"click"]],template:function(i,n){1&i&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h1"),e._uU(3,"Ward Type Prices"),e.qZA()()(),e.TgZ(4,"section",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h4",7),e._uU(10),e.qZA()(),e.TgZ(11,"div",8)(12,"div",9)(13,"div",3),e._UZ(14,"div",10)(15,"div",10),e.TgZ(16,"div",10)(17,"input",11),e.NdJ("ngModelChange",function(r){return n.filterRecords=r}),e.qZA()()(),e._UZ(18,"br"),e.TgZ(19,"table",12)(20,"thead")(21,"tr")(22,"td"),e._uU(23,"ID"),e.qZA(),e.TgZ(24,"td"),e._uU(25,"Test"),e.qZA(),e.TgZ(26,"td"),e._uU(27,"Price"),e.qZA(),e.TgZ(28,"td"),e._uU(29,"Edit Price"),e.qZA(),e.TgZ(30,"td"),e._uU(31,"Action"),e.qZA(),e.TgZ(32,"td"),e._uU(33,"Coverage"),e.qZA()()(),e.TgZ(34,"tbody"),e.YNc(35,x,16,9,"tr",13),e.ALo(36,"searchFilter"),e.qZA()()()()()()()()),2&i&&(e.xp6(10),e.hij("Package: ",n.insurancePlanName,""),e.xp6(7),e.Q6J("ngModel",n.filterRecords),e.xp6(18),e.Q6J("ngForOf",e.xi3(36,3,n.wardTypePrices,n.filterRecords)))},dependencies:[u.ez,u.sg,u.O5,u.H9,_.u5,_.Fj,_.JJ,_.On,_.UX,v.G]}),c})()}}]);