<!-- Content Header (Page header) -->
<section class="content-header">
    <div class="header-title">
        <h1>Doctor Cracking</h1>
    </div>
</section>
<!-- Main content -->
<section class="content">
    <div class="row">
        <!-- Form controls -->
        <div class="col-sm-12">
            <div class="panel panel-bd lobidrag">
                <div class="panel-heading">
                    <div class="btn-group"> 
                        <a class="btn btn-primary" routerLink="/list-from-reception" style="margin: 1px;"> <i class="fa fa-list"></i>List From Reception</a>  
                        <a class="btn btn-primary" routerLink="/my-consultation" style="margin: 1px;"> <i class="fa fa-list"></i>My Consultations</a>  
                    </div>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-12 alert alert-primary" role="alert">
                            <h4>Name: <b>{{consultation?.patient?.firstName}} {{consultation?.patient?.middleName}} {{consultation?.patient?.lastName}}</b>, File No: <b>{{consultation?.patient?.no}}</b>, Date of birth: <b>{{consultation?.patient?.dateOfBirth | date}}</b>, {{consultation?.patient?.gender}}, {{consultation?.paymentType}} {{consultation?.insurancePlan?.name}}</h4>
                        </div>
                        <div class="col-sm-6">
                            <label>Clinical Notes</label>
                            <div class="jumbotron jumbotron-fluid">                               
                                <div class="container">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <textarea class="form-control" [(ngModel)]="cNMainComplain" placeholder="Main Complain"></textarea>
                                            <textarea class="form-control" [(ngModel)]="cNPresentIllnessHistory" placeholder="History of Present Illness"></textarea>
                                            <textarea class="form-control" [(ngModel)]="cNPastMedicalHistory" placeholder="Past Medical History"></textarea>
                                            <textarea class="form-control" [(ngModel)]="cNFamilyAndSocialHistory" placeholder="Family and Social History"></textarea>
                                            <textarea class="form-control" [(ngModel)]="cNDrugsAndAllergyHistory" placeholder="Drugs and Allergy History"></textarea>
                                            <textarea class="form-control" [(ngModel)]="cNReviewOfOtherSystems" placeholder="Review of Other Systems"></textarea>
                                            <textarea class="form-control" [(ngModel)]="cNPhysicalExamination" placeholder="Physical Examination"></textarea>
                                            <textarea class="form-control" [(ngModel)]="cNManagementPlan" placeholder="Management Plan"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <label>General Examination</label>
                            <div class="jumbotron jumbotron-fluid">                               
                                <div class="container">
                                    <div class="row">
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gEPressure" placeholder="Pressure(mmHg)"></div>
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gETemperature" placeholder="Temparature(c)"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gEPulseRate" placeholder="Pulse Rate(b/Min)"></div>
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gEWeight" placeholder="Weight(kg)"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gEHeight" placeholder="Height(cm)"></div>
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gEBodyMassIndex" placeholder="Body Mass Index(kg/m)"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gEBodySurfaceArea" placeholder="Body Surface Area(cmkg)"></div>
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gEBodyMassIndexComment" placeholder="Body Mass Index Comment"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gESaturationOxygen" placeholder="Saturation Oxygen(%)"></div>
                                        <div class="col-sm-6" style="margin-bottom: 3mm;"><input type="text" class="form-control" [(ngModel)]="gERespiratoryRate" placeholder="Respiratory Rate(cycles/Min)"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12" style="margin-bottom: 3mm;"><textarea class="form-control" [(ngModel)]="gEDescription" placeholder="Description"></textarea></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12" style="text-align: center;">
                            <button class="btn btn-primary" (click)="saveCG()">Save</button>
                            <hr>
                        </div>

                        <div class="row" style="margin-left: 1mm; margin-right: 1mm;">
                            <div class="col-sm-12" style="text-align: center;">
                                <button class="btn btn-primary pull-right" (click)="clearDiagnosis()" data-toggle="modal" data-target="#assign-diagnosis-modal">Assign Diagnosis</button>
                                <br>
                            </div>
                            
                            <div class="col-sm-6">
                                <label>Working Diagnosis</label>
                                <div class="jumbotron jumbotron-fluid">                               
                                    <div class="container">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-hover  table-striped">
                                                <thead class="success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Code</th>
                                                    <th>Name</th>
                                                    <th>Description</th>
                                                    <th>Action</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let workingDiagnosis of workingDiagnosises">
                                                        <td>{{workingDiagnosis.id}}</td>
                                                        <td>{{workingDiagnosis.diagnosisType.code}}</td>
                                                        <td>{{workingDiagnosis.diagnosisType.name}}</td>
                                                        <td>{{workingDiagnosis.description}}</td>
                                                        <td><a (click)="deleteWorkingDiagnosis(workingDiagnosis.id)"><i class="fa fa-trash"></i>Delete</a></td>
                                                    </tr>
                                                </tbody>
                                            </table>    
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <label>Final Diagnosis</label>
                                <div class="jumbotron jumbotron-fluid">                               
                                    <div class="container">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-hover  table-striped">
                                                <thead class="success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Code</th>
                                                    <th>Name</th>
                                                    <th>Description</th>
                                                    <th>Action</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let finalDiagnosis of finalDiagnosises">
                                                        <td>{{finalDiagnosis.id}}</td>
                                                        <td>{{finalDiagnosis.diagnosisType.code}}</td>
                                                        <td>{{finalDiagnosis.diagnosisType.name}}</td>
                                                        <td>{{finalDiagnosis.description}}</td>
                                                        <td><a (click)="deleteFinalDiagnosis(finalDiagnosis.id)"><i class="fa fa-trash"></i>Delete</a></td>
                                                    </tr>
                                                </tbody>
                                            </table>    
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        
                        <br>

                        <div class="row" style="margin-left: 1mm; margin-right: 1mm;">
                            <div class="col-sm-6">
                            
                                <div class="row">
                                    <div class="col-sm-12">
                                        <label>Laboratory</label>
                                        <button class="btn btn-primary pull-right" (click)="clearLabTest()" data-toggle="modal" data-target="#assign-lab-test-modal" style="margin-right: 2mm;">Assign Lab Test</button>
                                        <button class="btn btn-primary pull-right" data-toggle="modal" data-target="#lab-test-result-modal" style="margin-right: 2mm;">View Result</button>
                                    </div>
                                </div>
                                <div class="jumbotron jumbotron-fluid">                               
                                    <div class="container">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-hover  table-striped">
                                                <thead class="success">
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Lab Test</th>
                                                    <th>Price</th>
                                                    <th>Payment Status</th>
                                                    <th>Status</th>
                                                    <th>Action</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let labTest of labTests">
                                                        <td>{{labTest.id}}</td>
                                                        <td>{{labTest.labTestType.name}}</td>
                                                        <td style="text-align: right;"><span *ngIf="labTest.bill.status != 'COVERED'">{{labTest.bill.amount | currency:'':''}}</span><span *ngIf="labTest.bill.status === 'COVERED'">---</span></td>
                                                        <td>
                                                            <span *ngIf="labTest.bill.status === 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{labTest.bill.status}}</span>
                                                            <span *ngIf="labTest.bill.status != 'COVERED' && consultation?.paymentType !='INSURANCE'">{{labTest.bill.status}}</span>
                                                            <span *ngIf="labTest.bill.status != 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{labTest.bill.status}}(NOT COVERED)</span>
                                                        </td>
                                                        <td>{{labTest.status}}</td>
                                                        <td><a (click)="deleteLabTest(labTest.id)"><i class="fa fa-trash"></i>Delete</a></td>
                                                    </tr>
                                                </tbody>
                                            </table>    
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-sm-6">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <label>Radiology</label>
                                        <button class="btn btn-primary pull-right" (click)="clearRadiology()" data-toggle="modal" data-target="#assign-radiology-modal" style="margin-right: 2mm;">Assign Radiology</button>
                                        <button class="btn btn-primary pull-right" data-toggle="modal" data-target="#radiology-result-modal" style="margin-right: 2mm;">View Result</button>
                                    </div>
                                </div>
                                <div class="jumbotron jumbotron-fluid">                               
                                    <div class="container">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-hover  table-striped">
                                                <thead class="success">
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Radiology</th>
                                                    <th>Price</th>
                                                    <th>Payment Status</th>
                                                    <th>Status</th>
                                                    <th>Action</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let radiology of radiologies">
                                                        <td>{{radiology.id}}</td>
                                                        <td>{{radiology.radiologyType.name}}</td>
                                                        <td style="text-align: right;"><span *ngIf="radiology.bill.status != 'COVERED'">{{radiology.bill.amount | currency:'':''}}</span><span *ngIf="radiology.bill.status === 'COVERED'">---</span></td>
                                                        <td>
                                                            <span *ngIf="radiology.bill.status === 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{radiology.bill.status}}</span>
                                                            <span *ngIf="radiology.bill.status != 'COVERED' && consultation?.paymentType !='INSURANCE'">{{radiology.bill.status}}</span>
                                                            <span *ngIf="radiology.bill.status != 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{radiology.bill.status}}(NOT COVERED)</span>
                                                        </td>
                                                        <td>{{radiology.status}}</td>
                                                        <td><a (click)="deleteRadiology(radiology.id)"><i class="fa fa-trash"></i>Delete</a></td>
                                                    </tr>
                                                </tbody>
                                            </table>    
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        
                        <div class="col-sm-12">
                            <hr>
                            <button class="btn btn-primary pull-right" (click)="clearPrescription()" data-toggle="modal" data-target="#assign-drugs-modal">Assign Drugs</button>
                            <br>
                        </div>
                        <div class="col-sm-12">
                            <label>Medications</label>
                            <div class="jumbotron jumbotron-fluid">                               
                                <div>
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-hover  table-striped">
                                            <thead class="success">
                                            <tr>
                                                <th>ID</th>
                                                <th>Prescription</th>
                                                <th>Price</th>
                                                <th>Payment Status</th>
                                                <th>Status</th>
                                                <th>Action</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let prescription of prescriptions">
                                                    <td>{{prescription.id}}</td>
                                                    <td>{{prescription.medicine.name}}</td>
                                                    <td style="text-align: right;"><span *ngIf="prescription.bill.status != 'COVERED'">{{prescription.bill.amount | currency:'':''}}</span><span *ngIf="prescription.bill.status === 'COVERED'">---</span></td>
                                                    <td>
                                                        <span *ngIf="prescription.bill.status === 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{prescription.bill.status}}</span>
                                                        <span *ngIf="prescription.bill.status != 'COVERED' && consultation?.paymentType !='INSURANCE'">{{prescription.bill.status}}</span>
                                                        <span *ngIf="prescription.bill.status != 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{prescription.bill.status}}(NOT COVERED)</span>
                                                    </td>
                                                    <td>{{prescription.status}}</td>
                                                    <td><a (click)="deletePrescription(prescription.id)"><i class="fa fa-trash"></i>Delete</a></td>
                                                </tr>
                                            </tbody>
                                        </table>    
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <hr>
                            <button class="btn btn-primary pull-right" (click)="clearProcedure()" data-toggle="modal" data-target="#assign-procedure-modal">Assign Procedure</button>
                            <br>
                        </div>
                        <div class="col-sm-12">
                            <label>Procedure</label>
                            <div class="jumbotron jumbotron-fluid">                               
                                <div>
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-hover  table-striped">
                                            <thead class="success">
                                            <tr>
                                                <th>ID</th>
                                                <th>Radiology</th>
                                                <th>Price</th>
                                                <th>Payment Status</th>
                                                <th>Status</th>
                                                <th>Action</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let procedure of procedures">
                                                    <td>{{procedure.id}}</td>
                                                    <td>{{procedure.procedureType.name}}</td>
                                                    <td style="text-align: right;"><span *ngIf="procedure.bill.status != 'COVERED'">{{procedure.bill.amount | currency:'':''}}</span><span *ngIf="procedure.bill.status === 'COVERED'">---</span></td>
                                                    <td>
                                                        <span *ngIf="procedure.bill.status === 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{procedure.bill.status}}</span>
                                                        <span *ngIf="procedure.bill.status != 'COVERED' && consultation?.paymentType !='INSURANCE'">{{procedure.bill.status}}</span>
                                                        <span *ngIf="procedure.bill.status != 'COVERED' && consultation?.paymentType ==='INSURANCE'">{{procedure.bill.status}}(NOT COVERED)</span>
                                                    </td>
                                                    <td>{{procedure.status}}</td>
                                                    <td><a (click)="deleteProcedure(procedure.id)"><i class="fa fa-trash"></i>Delete</a></td>
                                                </tr>
                                            </tbody>
                                        </table>   
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div> 
                    
            </div>
        </div>
    </div>
     
</section> <!-- /.content -->


<!-- Modal success -->
<div class="modal fade modal-success" id="assign-diagnosis-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Assign Diagnosis</h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <h4>Select Diagnosis Type</h4>
                        <select class="form-control" [(ngModel)]="diagnosisTypeName">
                            <option></option>
                            <option *ngFor="let name of diagnosisTypeNames">{{name}}</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <h4>Description</h4>
                        <input type="text" class="form-control" [(ngModel)]="diagnosisDescription">
                    </div>
                </div>
                  
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary pull-left" *ngIf="diagnosisTypeName != ''" (click)="saveWorkingDiagnosis()" data-dismiss="modal">Working</button>
                    <button type="button" class="btn btn-success pull-right" *ngIf="diagnosisTypeName != ''" (click)="saveFinalDiagnosis()" data-dismiss="modal">Final</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>


    <!-- Modal success -->
<div class="modal fade modal-success" id="assign-lab-test-modal" tabindex="-2" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Assign Lab Test</h3>
            </div>
            <div class="modal-body">
                 <div class="row">
                     <div class="col-sm-12">
                        <h4>Select Lab Test Type</h4>
                        <select class="form-control" [(ngModel)]="labTestTypeName">
                            <option></option>
                            <option *ngFor="let name of labTestTypeNames">{{name}}</option>
                        </select>
                     </div>
                 </div>   
                    
                <div class="modal-footer">
                    <button type="button" class="btn btn-success pull-right" (click)="saveLabTest()" data-dismiss="modal">Save</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>

<div class="modal fade modal-success" id="lab-test-result-modal" tabindex="-2" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Lab Test Results</h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6" *ngFor="let labTest of labTests" style="background-color: rgb(248, 248, 248);">
                        <h4><b>{{labTest?.labTestType?.name}}</b></h4>
                        <br>
                        <span>Results</span>
                        <textarea class="form-control"  style="height: 5cm;" readonly>{{labTest.result}}</textarea>
                        <div class="row">
                            <div class="col-sm-6">
                                <small>Range: <b>{{labTest.range}}</b></small><br>
                                <small>Level: <b>{{labTest.level}}</b></small><br>
                                <small>Unit: <b>{{labTest.unit}}</b></small><br>
                            </div>
                            <div class="col-sm-6">
                                <small>Status: <b>{{labTest.status}}</b></small><br>
                                <small>Comments: level</small><br>
                                <small>Reject Comment: unit</small><br>
                           </div>
                        </div>
                    </div>
                </div>                        
                <div class="modal-footer">
                    <button type="button" class="btn btn-success pull-right" data-dismiss="modal">Close</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>

    <!-- Modal success -->
<div class="modal fade modal-success" id="assign-radiology-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Assign Radiology</h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                       <h4>Select Radiology Type</h4>
                       <select class="form-control" [(ngModel)]="radiologyTypeName">
                           <option></option>
                           <option *ngFor="let name of radiologyTypeNames">{{name}}</option>
                       </select>
                    </div>
                </div>   
                   
               <div class="modal-footer">
                   <button type="button" class="btn btn-success pull-right" (click)="saveRadiology()" data-dismiss="modal">Save</button>
               </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>

<div class="modal fade modal-success" id="radiology-result-modal" tabindex="-2" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Radiology Results</h3>
            </div>
            <div class="modal-body">
                    
                    
                    
                    
                <div class="modal-footer">
                    <button type="button" class="btn btn-success pull-right" data-dismiss="modal">Close</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>

<div class="modal fade modal-success" id="assign-procedure-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Assign Procedure</h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                       <h4>Select Procedure Type</h4>
                       <select class="form-control" [(ngModel)]="procedureTypeName">
                           <option></option>
                           <option *ngFor="let name of procedureTypeNames">{{name}}</option>
                       </select>
                    </div>
                </div>   
                   
               <div class="modal-footer">
                   <button type="button" class="btn btn-success pull-right" (click)="saveProcedure()" data-dismiss="modal">Save</button>
               </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>

    <!-- Modal success -->
<div class="modal fade modal-success" id="assign-drugs-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Assign Drugs</h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                       <h4>Select Medicine</h4>
                       <select class="form-control" [(ngModel)]="medicineName">
                           <option></option>
                           <option *ngFor="let name of medicineNames">{{name}}</option>
                       </select>
                    </div>
                </div>   
                   
               <div class="modal-footer">
                   <button type="button" class="btn btn-success pull-right" (click)="savePrescription()" data-dismiss="modal">Save</button>
               </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <!-- Modal success -->

    
    